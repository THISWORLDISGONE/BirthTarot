<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡”ç¾…ç”Ÿå‘½éˆæ•¸èˆ‡é‹å‹¢è¨ˆç®—å™¨</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        
        .tarot-card-image {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .tarot-card-image:hover {
            transform: scale(1.05);
        }

        .image-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        body {
            background-color: #f3e8ff; /* Light purple background for the whole page */
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, Fragment, useMemo, useRef } = React;

        // --- SHARED ICON COMPONENTS ---
        const Calendar = () => <span>ğŸ“…</span>;
        const Sparkles = ({ className }) => <span className={className}>âœ¨</span>;
        const Hash = ({ className }) => <span className={className}>#</span>;
        const User = ({ className }) => <span className={className}>ğŸ‘¤</span>;
        const BookOpen = () => <span>ğŸ“–</span>;
        const ChevronDown = ({ className }) => <span className={className}>â–¼</span>;
        const ChevronUp = ({ className }) => <span className={className}>â–²</span>;
        const Gift = ({ className }) => <span className={className}>ğŸ</span>;
        const Shield = ({ className }) => <span>ğŸ›¡ï¸</span>;
        const HeartIcon = ({ className }) => <span className={className}>ğŸ’–</span>;
        const UsersIcon = ({ className }) => <span className={className}>ğŸ‘¥</span>;
        const MoonIcon = ({ className }) => <span className={className}>ğŸŒ™</span>;
        const StarIcon = ({ className }) => <span className={className}>â­</span>;
        const AlertCircleIcon = ({ className }) => <span className={className}>âš ï¸</span>;
        const InfoIcon = ({ className }) => <span className={className}>â„¹ï¸</span>;
        const BrainIcon = () => <span>ğŸ§ </span>;
        const ClockIcon = () => <span>ğŸ•°ï¸</span>;
        const SunIcon = () => <span>â˜€ï¸</span>;
        const TargetIcon = () => <span>ğŸ¯</span>;

        // --- SHARED CARD DETAILS ---
        const cardDetails = {
          0: { name: 'æ„šè€…', shortMeaning: 'ç´”çœŸã€å‹‡æ°£ã€ç„¡é™å¯èƒ½ã€æ–°çš„é–‹å§‹', soulMission: 'æ‚¨çš„æ ¸å¿ƒä½¿å‘½æ˜¯è¸ä¸Šä¸€å ´å‰å¤§çš„è‹±é›„ä¹‹æ—…ï¼Œå­¸ç¿’ç„¡æ¢ä»¶ä¿¡ä»»å®‡å®™çš„å¼•å°ï¼Œå¸¶è‘—ç´”çœŸçš„å¿ƒå’Œç„¡ç•çš„å‹‡æ°£å»æ“æŠ±ç”Ÿå‘½ä¸­ç„¡é™çš„å¯èƒ½æ€§ï¼Œä¸¦æ´»åœ¨ç•¶ä¸‹ã€‚æ‚¨éœ€è¦å­¸æœƒè†è½é‚£è¶…è¶Šé‚è¼¯çš„å…§åœ¨è¡å‹•ï¼Œå°‡æ¯ä¸€æ¬¡å¤±è¶³éƒ½è¦–ç‚ºå­¸ç¿’è·³èˆçš„å¥‘æ©Ÿã€‚', personalityTrait: 'æ‚¨å±•ç¾ç‚ºå……æ»¿å¥½å¥‡å¿ƒã€æ¨‚è§€ç©æ¥µä¸”å¯Œæœ‰æ„ŸæŸ“åŠ›çš„å†’éšªå®¶ã€‚æ‚¨å‚¾å‘æ–¼æ†‘ç›´è¦ºè¡Œäº‹ï¼Œå‹‡æ–¼å˜—è©¦æ–°äº‹ç‰©ï¼Œä¸å–œæ­¡å¢¨å®ˆæˆè¦æˆ–å—åˆ°ä»»ä½•å½¢å¼çš„æŸç¸›ã€‚æ‚¨çš„å¤©è³¦åœ¨æ–¼å‰µæ–°æ€ç¶­ã€é–‹é—¢æ–°é“è·¯å’Œç‚ºå‘¨åœå¸¶ä¾†è¼•é¬†æ´»æ½‘çš„æ°›åœã€‚', challenges: 'ä¸»è¦æŒ‘æˆ°åœ¨æ–¼å°‡é£„é€¸çš„èƒ½é‡â€œè½åœ°â€ã€‚å¯èƒ½ç¼ºä¹é•·é è¦åŠƒã€å®¹æ˜“å› ä¸€æ™‚è¡å‹•è€Œå¿½ç•¥ç¾å¯¦å¾Œæœã€é›£ä»¥æ‰¿æ“”é•·æœŸçš„è²¬ä»»ã€‚æˆé•·çš„é—œéµåœ¨æ–¼å­¸ç¿’åœ¨æ“æŠ±è‡ªç”±çš„åŒæ™‚ï¼Œä¹Ÿè…³è¸å¯¦åœ°ï¼Œä¸¦ç‚ºè‡ªå·±çš„é¸æ“‡èˆ‡è¡Œå‹•å…¨ç„¶è² è²¬ã€‚' },
          1: { name: 'é­”è¡“å¸«', shortMeaning: 'å‰µé€ åŠ›ã€æ„å¿—åŠ›ã€é¡¯åŒ–ã€æºé€š', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æˆç‚ºé€£æ¥å¤©åœ°èƒ½é‡çš„æ©‹æ¨‘ï¼Œå­¸ç¿’é‹ç”¨é«˜åº¦é›†ä¸­çš„æ„å¿—åŠ›å’Œæ¸…æ™°çš„æ„åœ–ï¼Œå°‡éˆç•Œçš„éˆæ„Ÿèˆ‡å€‹äººæ½›èƒ½é¡¯åŒ–ç‚ºç‰©è³ªä¸–ç•Œçš„ç¾å¯¦ï¼Œæˆç‚ºè‡ªèº«å¯¦ç›¸çš„ç©æ¥µå‰µé€ è€…ã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºè‡ªä¿¡ã€é­…åŠ›ã€è¶³æ™ºå¤šè¬€å’Œç›®æ¨™å°å‘çš„ç‰¹è³ªï¼Œå¤©ç”Ÿå…·å‚™å°‡æƒ³æ³•ä»˜è«¸å¯¦è¸çš„é©…å‹•åŠ›ã€‚æ‚¨å–„æ–¼æºé€šèªªæœï¼Œæ“æœ‰å“è¶Šçš„è¦åŠƒèˆ‡åŸ·è¡Œèƒ½åŠ›ï¼Œèƒ½å¤ æœ‰æ•ˆåœ°é‹ç”¨æ‰‹é‚Šçš„ä»»ä½•è³‡æºé”æˆç›®çš„ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å€‹äººæ„å¿—çš„â€œé™°å½±é¢â€ã€‚å¯èƒ½éåº¦ä¾è³´å€‹äººæ„å¿—ï¼Œå°è‡´æ“æ§å‚¾å‘ã€è‡ªè² ã€ç”šè‡³ç‚ºäº†é”æˆç›®çš„è€Œä¸æ“‡æ‰‹æ®µã€‚èª²é¡Œæ˜¯å€åˆ†è‡ªä¿¡èˆ‡è‡ªå¤§ï¼Œä¸¦å­¸æœƒåœ¨å°ˆæ³¨ç›®æ¨™çš„åŒæ™‚ï¼Œå°éç¨‹ä¿æŒé–‹æ”¾èˆ‡ä¿¡ä»»ã€‚' },
          2: { name: 'å¥³ç¥­å¸', shortMeaning: 'ç›´è¦ºã€æ½›æ„è­˜ã€ç¥ç§˜æ™ºæ…§ã€éœé»˜', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æ·±å…¥æ¢ç´¢å…§åœ¨ä¸–ç•Œçš„ç¥ç§˜é ˜åŸŸï¼Œæˆç‚ºæ½›æ„è­˜æµ·æ´‹çš„å®ˆè­·è€…èˆ‡æ½›èˆªå“¡ã€‚æ‚¨è¦å­¸ç¿’è¶…è¶ŠäºŒå…ƒå°ç«‹çš„æ€ç¶­ï¼Œé€£çµæ½›æ„è­˜çš„é¾å¤§æ™ºæ…§èˆ‡å®‡å®™çš„å¥§ç§˜ï¼Œåœ¨éœé»˜ä¸­æ¥æ”¶è¶…è¶Šèªè¨€çš„å•Ÿç¤ºã€‚', personalityTrait: 'æ‚¨è¡¨ç¾ç‚ºç¥ç§˜ã€å…§æ–‚ã€æ²‰éœä¸”å…·æœ‰æ·±ä¸å¯æ¸¬çš„æ·±åº¦ã€‚æ‚¨å‚¾å‘æ–¼è§€å¯Ÿèˆ‡åæ€ï¼Œè€Œéç›´æ¥è¡Œå‹•ï¼Œå–œæ­¡ç¨è™•ä»¥é€£çµå…§åœ¨çš„èƒ½é‡ã€‚æ‚¨çš„å¤©è³¦åœ¨æ–¼æ´å¯Ÿäº‹ç‰©çš„æœ¬è³ªï¼Œèƒ½å¤ è¼•æ˜“çœ‹ç©¿è¡¨é¢çš„è™›é£¾ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½éåº¦å…§å‘ï¼Œæ²‰æµ¸åœ¨è‡ªå·±çš„å…§å¿ƒä¸–ç•Œè£¡ï¼Œèˆ‡ç¾å¯¦ç”Ÿæ´»ç”¢ç”Ÿè„«ç¯€ï¼Œæˆ–å› æƒ…æ„Ÿçš„éåº¦å£“æŠ‘è€Œé¡¯å¾—å†·æ¼ ã€é›£ä»¥è¦ªè¿‘ã€‚éœ€è¦å­¸ç¿’å°‡å…§åœ¨çš„æ™ºæ…§é©ç•¶åœ°è¡¨é”å’Œæ‡‰ç”¨æ–¼ç¾å¯¦ä¸–ç•Œï¼Œé¿å…è‡ªæˆ‘å­¤ç«‹ã€‚' },
          3: { name: 'å¥³å¸', shortMeaning: 'è±é¥’ã€æ¯æ€§ã€å‰µé€ ã€æ»‹é¤Šèˆ‡æ„Ÿå®˜äº«å—', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æˆç‚ºç”Ÿå‘½åŠ›ã€è±ç››èˆ‡ç„¡æ¢ä»¶ä¹‹æ„›çš„ç®¡é“ï¼Œå…¨ç„¶åœ°é«”ç¾ä¸¦æ•£æ’­å®‡å®™çš„å‰µé€ èƒ½é‡ã€‚æ‚¨çš„ä»»å‹™æ˜¯åœ¨åœ°çƒä¸Šå»ºç«‹ä¸€å€‹å……æ»¿æ„›ã€ç¾èˆ‡å’Œè«§çš„â€œä¼Šç”¸åœ’â€ï¼Œç„¡è«–é€™æ˜¯ä¸€å€‹å®¶ã€ä¸€å€‹ç¤¾ç¾¤ã€é‚„æ˜¯ä¸€ç¨®ç”Ÿæ´»æ…‹åº¦ã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºæº«æš–ã€é—œæ„›ã€æ…·æ…¨ä¸”å¯Œæœ‰å‰µé€ åŠ›çš„ç…§é¡§è€…ç‰¹è³ªã€‚æ‚¨ç†±æ„›ä¸€åˆ‡ç¾å¥½äº‹ç‰©ï¼Œäº«å—ç¾é£Ÿã€è—è¡“ã€éŸ³æ¨‚ç­‰æ„Ÿå®˜é«”é©—ï¼Œä¸¦å…·æœ‰å°‡ä»»ä½•å¹³å‡¡äº‹ç‰©è®Šå¾—æ›´ç¾å¥½çš„å¤©è³¦ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼è±ç››èƒ½é‡çš„å¤±è¡¡ã€‚å¯èƒ½éåº¦æ²‰æººæ–¼ç‰©è³ªäº«å—ï¼Œæˆ–åœ¨äººéš›é—œä¿‚ä¸­å› éåº¦ä¿è­·è€Œæ¼”è®Šæˆâ€œçª’æ¯çš„æ„›â€ï¼Œç¼ºä¹å¥åº·çš„å€‹äººé‚Šç•Œæ„Ÿã€‚éœ€è¦å­¸ç¿’åœ¨ä»˜å‡ºèˆ‡è‡ªæˆ‘æ»‹é¤Šä¹‹é–“æ‰¾åˆ°å®Œç¾çš„å¹³è¡¡ã€‚' },
          4: { name: 'çš‡å¸', shortMeaning: 'æ¬Šå¨ã€çµæ§‹ã€ç©©å®šã€é ˜å°èˆ‡ç§©åº', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯åœ¨ç‰©è³ªä¸–ç•Œä¸­å­¸ç¿’å»ºç«‹ç©©å›ºã€æŒä¹…ä¸”æœ‰ç›Šçš„çµæ§‹èˆ‡ç§©åºï¼Œæˆç‚ºä¸€ä½å……æ»¿æ™ºæ…§ã€è² è²¬ä»»ä¸”å…¬æ­£çš„é ˜å°è€…ã€‚æ‚¨çš„ä»»å‹™æ˜¯å‰µé€ ä¸€å€‹èƒ½è®“ä»–äººå®‰å¿ƒæˆé•·èˆ‡ç™¼å±•çš„ç³»çµ±ï¼Œæˆç‚ºç¤¾æœƒçš„ä¸­æµç ¥æŸ±ã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºæ¬Šå¨ã€å‹™å¯¦ã€æœ‰çµ„ç¹”ä¸”å…·æ±ºæ–·åŠ›çš„é ˜å°è€…ç‰¹è³ªã€‚æ‚¨é‡è¦–è¦å‰‡ã€æ•ˆç‡å’Œç›®æ¨™é”æˆï¼Œæ“æœ‰å¼·å¤§çš„åŸ·è¡ŒåŠ›èˆ‡èˆ‡ç”Ÿä¿±ä¾†çš„è²¬ä»»æ„Ÿã€‚åœ¨ä»–äººçœ¼ä¸­ï¼Œæ‚¨æ˜¯å¯é çš„ã€å€¼å¾—ä¿¡è³´çš„é å±±ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼æ¬Šå¨çš„åƒµåŒ–ã€‚å¯èƒ½éæ–¼å›ºåŸ·å·±è¦‹ã€ç¼ºä¹å½ˆæ€§æˆ–æ§åˆ¶æ…¾éå¼·ï¼Œå°è‡´å°ˆæ–·ç¨è¡Œã€‚éœ€è¦å­¸ç¿’åœ¨æ¬Šå¨èˆ‡ä»æ…ˆä¹‹é–“å–å¾—å¹³è¡¡ï¼Œåœ¨å …æŒåŸå‰‡çš„åŒæ™‚ï¼Œä¿æŒéˆæ´»çš„é©æ‡‰æ€§ã€‚' },
          5: { name: 'æ•™çš‡', shortMeaning: 'ç²¾ç¥æŒ‡å¼•ã€å‚³çµ±ã€æ•™è‚²ã€ä¿¡ä»°èˆ‡è¦ç¯„', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æˆç‚ºæ™ºæ…§çš„å‚³æ‰¿è€…èˆ‡é“å¾·çš„æŒ‡å¼•è€…ï¼Œåœ¨ç²¾ç¥ä¿¡ä»°èˆ‡ç‰©è³ªç¤¾æœƒä¹‹é–“å»ºç«‹ä¸€åº§å …å¯¦çš„æ©‹æ¨‘ã€‚æ‚¨çš„ä»»å‹™æ˜¯å°‡é«˜æ·±çš„æ™ºæ…§â€œç¿»è­¯â€æˆæ™®é€šäººèƒ½å¤ ç†è§£å’Œéµå¾ªçš„èªè¨€èˆ‡å„€å¼ã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºå‚³çµ±ã€æœ‰åŸå‰‡ã€é‡è¦–é“å¾·ä¸”å…·æœ‰æ•™å°å‚¾å‘çš„ç‰¹è³ªã€‚æ‚¨å–œæ­¡æ¢ç´¢äº‹ç‰©çš„æ·±å±¤æ„ç¾©ï¼Œä¸¦æ¨‚æ–¼å°‡æ‰€å­¸ç³»çµ±åŒ–åœ°åˆ†äº«å‡ºå»ã€‚æ‚¨é€šå¸¸æ˜¯å€¼å¾—ä¿¡è³´çš„é¡§å•ã€è€å¸«æˆ–å°å¸«ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½éæ–¼å›ºå®ˆå‚³çµ±ã€å¢¨å®ˆæˆè¦ï¼Œæˆ–è®Šå¾—æ•™æ¢ä¸»ç¾©ã€æ€æƒ³åƒµåŒ–ã€‚éœ€è¦å­¸ç¿’å€åˆ†ç›²å¾èˆ‡æ™ºæ…§å‚³æ‰¿çš„å€åˆ¥ï¼Œä¿æŒæ€æƒ³çš„é–‹æ”¾æ€§ï¼Œä¸¦ç†è§£æ‰€æœ‰æ•™æ¢çš„æœ€çµ‚ç›®çš„éƒ½æ˜¯ç‚ºäº†å¼•å°ï¼Œè€Œéæˆç‚ºæ–°çš„æ·é–ã€‚' },
          6: { name: 'æˆ€äºº', shortMeaning: 'æ„›æƒ…ã€é¸æ“‡ã€é—œä¿‚ã€åƒ¹å€¼è§€èˆ‡å’Œè«§', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æ·±åˆ»åœ°å­¸ç¿’æ„›çš„çœŸè«¦ï¼Œä¸¦æ ¹æ“šå…§å¿ƒæœ€çœŸå¯¦çš„åƒ¹å€¼è§€åšå‡ºé‡å¤§çš„ç”Ÿå‘½æŠ‰æ“‡ã€‚æ‚¨çš„çµ‚æ¥µä»»å‹™æ˜¯é”æˆå…§åœ¨çš„â€œç¥è–å©šå§»â€ï¼Œå¾è€Œèƒ½åœ¨å¤–åœ¨ä¸–ç•Œä¸­å»ºç«‹çœŸæ­£å¥åº·ã€å¹³ç­‰çš„å¤¥ä¼´é—œä¿‚ã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºè¿·äººã€å‹å–„ã€å–„æ–¼äº¤éš›ä¸”æ¥µåº¦é‡è¦–äººéš›é—œä¿‚çš„ç‰¹è³ªã€‚æ‚¨æ¸´æœ›å’Œè«§ï¼Œæ³¨é‡ç¾æ„Ÿï¼Œå¤©ç”Ÿå°±æ‡‚å¾—å¦‚ä½•å»ºç«‹é€£çµèˆ‡ä¿ƒé€²åˆä½œã€‚æ‚¨é€šå¸¸æ˜¯åœ˜éšŠä¸­å—æ­¡è¿çš„â€œé»è‘—åŠ‘â€ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼é¸æ“‡çš„å›°å¢ƒèˆ‡é—œä¿‚çš„ä¾è³´ã€‚åœ¨é¢å°é‡è¦çš„ç”Ÿå‘½é¸æ“‡æ™‚ï¼Œæ‚¨å¯èƒ½å› ç‚ºå®³æ€•åšå‡ºéŒ¯èª¤æ±ºå®šè€Œé™·å…¥é•·æ™‚é–“çš„çŒ¶è±«ä¸æ±ºã€‚ç™¼å±•ç¨ç«‹æ€§å’Œæ¸…æ™°çš„è‡ªæˆ‘èªçŸ¥æ˜¯æ‚¨æ­¤ç”Ÿçš„é‡è¦èª²é¡Œã€‚' },
          7: { name: 'æˆ°è»Š', shortMeaning: 'æ±ºå¿ƒã€å‹åˆ©ã€æŒæ§æ–¹å‘ã€æ„å¿—åŠ›èˆ‡è¡Œå‹•', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯å­¸ç¿’é§•é¦­å…§åœ¨çš„çŸ›ç›¾åŠ›é‡ï¼Œä»¥é‹¼éµèˆ¬çš„æ„å¿—åŠ›å’Œé«˜åº¦å°ˆæ³¨çš„è¡Œå‹•åŠ›ï¼Œå…‹æœå…§å¤–åœ¨çš„é‡é‡éšœç¤™ï¼Œæœå‘ä¸€å€‹æ˜ç¢ºçš„ç›®æ¨™å‹‡æ•¢å‰é€²ï¼Œä¸¦æœ€çµ‚è´å¾—å‹åˆ©ã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºæ±ºå¿ƒå …å®šã€ç›®æ¨™å°å‘ã€å……æ»¿è‡ªä¿¡ä¸”å¯Œæœ‰ç«¶çˆ­åŠ›çš„ç‰¹è³ªã€‚æ‚¨æ˜¯å¤©ç”Ÿçš„è¡Œå‹•æ´¾ï¼Œä¸€æ—¦è¨­å®šç›®æ¨™ï¼Œä¾¿æœƒå…¨åŠ›ä»¥èµ´ï¼Œä¸é”ç›®çš„èª“ä¸ç½·ä¼‘ã€‚æ‚¨å‹‡æ–¼é¢å°æŒ‘æˆ°ï¼Œäº«å—å…‹æœå›°é›£å¸¶ä¾†çš„æˆå°±æ„Ÿã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼æ„å¿—åŠ›çš„éåº¦ä½¿ç”¨èˆ‡æ–¹å‘çš„åå¤±ã€‚å¯èƒ½è®Šå¾—éåº¦å¥½é¬¥ã€ç¼ºä¹è€å¿ƒï¼Œæˆ–ç‚ºäº†è¿½æ±‚ç›®æ¨™è€Œä¸é¡§ä¸€åˆ‡ã€‚éœ€è¦å­¸ç¿’å¹³è¡¡é‡å¿ƒèˆ‡åŒæƒ…å¿ƒï¼Œä¸¦æ™‚å¸¸åæ€å‰é€²çš„æ–¹å‘æ˜¯å¦çœŸçš„ç¬¦åˆå…§å¿ƒæœ€é«˜çš„åƒ¹å€¼ã€‚' },
          8: { name: 'åŠ›é‡', shortMeaning: 'å…§åœ¨åŠ›é‡ã€å‹‡æ°£ã€è€å¿ƒã€æ…ˆæ‚²èˆ‡æ•´åˆæœ¬èƒ½', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯ç™¼ç¾ä¸¦é‹ç”¨å…§åœ¨çœŸæ­£çš„åŠ›é‡â€”â€”é‚£æºæ–¼æ„›ã€å‹‡æ°£ã€è€å¿ƒèˆ‡æ…ˆæ‚²çš„åŠ›é‡ã€‚æ‚¨éœ€è¦å­¸ç¿’å»æº«æŸ”åœ°â€œé¦´æœâ€å…§åœ¨çš„é‡ç¸ï¼ˆåŸå§‹æœ¬èƒ½ã€æ¿€æƒ…ã€ææ‡¼ï¼‰ï¼Œå°‡å…¶è½‰åŒ–ç‚ºæºæºä¸çµ•çš„ç”Ÿå‘½åŠ›ã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºæº«å’Œè€Œå …å®šã€å¯Œæœ‰è€å¿ƒã€åŒæƒ…å¿ƒä¸”å…·æœ‰å¼·å¤§å®‰æ’«äººå¿ƒçš„ç‰¹è³ªã€‚æ‚¨ä¸å–œæ­¡ç”¨å¤–åœ¨çš„å¼·å‹¢å–èƒœï¼Œè€Œæ˜¯ä»¥å…§åœ¨çš„æ¯…åŠ›ã€æ²‰è‘—èˆ‡æ…ˆæ‚²ä¾†å½±éŸ¿å’Œå¼•å°ä»–äººã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½å› éåº¦å£“æŠ‘è‡ªèº«çš„éœ€æ±‚èˆ‡æ­£å¸¸çš„æ†¤æ€’æƒ…ç·’ï¼Œä»¥ç¶­æŒè¡¨é¢çš„å’Œå¹³ã€‚éœ€è¦å­¸ç¿’å¹³è¡¡æº«æŸ”èˆ‡å …å®šï¼Œè‚¯å®šè‡ªæˆ‘åƒ¹å€¼ï¼Œä¸¦åœ¨é©ç•¶çš„æ™‚å€™å±•ç¾æœæ–·ï¼Œâ€œæº«æŸ”åœ°èªªä¸â€ã€‚' },
          9: { name: 'éš±å£«', shortMeaning: 'å…§çœã€å°‹æ±‚çœŸç†ã€æ™ºæ…§ã€æŒ‡å¼•èˆ‡ç¨è™•', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯é€šéæ·±å…¥çš„å…§åœ¨æ¢ç´¢ã€åæ€èˆ‡ç¨è™•ï¼Œé»äº®å…§åœ¨æ™ºæ…§çš„æç‡ˆï¼Œå°‹æ±‚ä¸¦ç²å¾—é—œæ–¼ç”Ÿå‘½ã€å®‡å®™èˆ‡è‡ªæˆ‘çš„æ·±åˆ»çœŸç†ã€‚æ‚¨çš„ä»»å‹™æ˜¯æˆç‚ºä»–äººç”Ÿå‘½æ—…ç¨‹ä¸­çš„æŒ‡è·¯æ˜ç‡ˆã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºå…§çœã€æ²‰éœã€æ™ºæ…§ä¸”äº«å—ç¨è™•çš„æ·±åº¦æ€è€ƒè€…ç‰¹è³ªã€‚æ‚¨æ˜¯äººç¾¤ä¸­çš„â€œè€éˆé­‚â€ï¼Œå°è†šæ·ºçš„è«‡è©±ä¸æ„Ÿèˆˆè¶£ã€‚æ‚¨çš„å¤©è³¦åœ¨æ–¼æä¾›æ·±åˆ»çš„ã€ç¶“éæ·±æ€ç†Ÿæ…®çš„æ´è¦‹èˆ‡æŒ‡å°ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½éåº¦å­¤ç«‹è‡ªæˆ‘ï¼Œèˆ‡ç¤¾æœƒå’Œç¾å¯¦ç”Ÿæ´»è„«ç¯€ï¼Œæˆ–å› éåº¦æ²‰æ€è€Œè®Šå¾—æ‚²è§€ã€çŒ¶è±«ä¸å‰ã€‚éœ€è¦å­¸ç¿’åœ¨ç¨è™•å……é›»èˆ‡èå…¥ç¤¾ç¾¤ä¹‹é–“æ‰¾åˆ°å¥åº·çš„å¹³è¡¡ï¼Œå°‡å…§åœ¨çš„æ™ºæ…§æ‡‰ç”¨æ–¼å¯¦éš›ç”Ÿæ´»ã€‚' },
          10: { name: 'å‘½é‹ä¹‹è¼ª', shortMeaning: 'å‘½é‹è½‰è®Šã€æ©Ÿæœƒã€é€±æœŸã€è½‰æ©é»èˆ‡é †æ‡‰æ½®æµ', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æ·±åˆ»ç†è§£ä¸¦å…¨ç„¶æ¥å—ç”Ÿå‘½çš„é€±æœŸæ€§ã€ç„¡å¸¸è®ŠåŒ–èˆ‡å› æœæ³•å‰‡ã€‚æ‚¨çš„éˆé­‚æ¸´æœ›é †æ‡‰å®‡å®™çš„å®å¤§ç¯€å¥ï¼Œè€Œéèˆ‡ä¹‹æŠ—è¡¡ï¼Œä¸¦åœ¨æ¯ä¸€æ¬¡è½‰è®Šä¸­æ‰¾åˆ°éˆæ€§æˆé•·çš„æ©Ÿæœƒã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºæ¨‚è§€ã€é©æ‡‰åŠ›å¼·ã€å…·æœ‰å“²å­¸æ€ç¶­ä¸”æ¨‚æ–¼æ¥å—æ”¹è®Šçš„ç‰¹è³ªã€‚æ‚¨æ“…é•·æŠ“ä½æ©Ÿæœƒï¼Œéš¨é‡è€Œå®‰ï¼Œæ˜¯é‚£ç¨®â€œç¸½åœ¨å°çš„æ™‚é–“å‡ºç¾åœ¨å°çš„åœ°é»â€çš„äººã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½åœ¨ä¸»å‹•èˆ‡è¢«å‹•ä¹‹é–“å¤±è¡¡ã€‚å¯èƒ½éåº¦ä¾è³´â€œé‹æ°£â€è€Œç¼ºä¹ä¸»å‹•å‰µé€ çš„æ„é¡˜ï¼Œæˆ–åéä¾†ï¼Œå› å®³æ€•éŒ¯éæ©Ÿæœƒè€Œè®Šå¾—ç„¦èºä¸å®‰ã€‚éœ€è¦å­¸ç¿’åœ¨é †æ‡‰æ½®æµçš„åŒæ™‚ï¼Œä¹Ÿç©©ç©©åœ°æŒå¥½è‡ªå·±çš„èˆµã€‚' },
          11: { name: 'æ­£ç¾©', shortMeaning: 'å…¬æ­£ã€å¹³è¡¡ã€çœŸç†ã€å› æœæ³•å‰‡èˆ‡è²¬ä»»', soulMission: 'æ‚¨çš„ç”Ÿå‘½ç›®æ¨™æ˜¯æ·±åˆ»ç†è§£ä¸¦æ´»å‡ºå› æœæ³•å‰‡ï¼ˆKarmaï¼‰çš„æ™ºæ…§ï¼Œç‚ºè‡ªå·±çš„æ‰€æœ‰é¸æ“‡è² èµ·å…¨éƒ¨è²¬ä»»ï¼Œä¸¦è‡´åŠ›æ–¼åœ¨ç”Ÿæ´»ä¸­å‰µé€ ä¸€å€‹æ›´å…¬æ­£ã€é€æ˜èˆ‡å’Œè«§çš„ç’°å¢ƒã€‚', personalityTrait: 'æ‚¨å±•ç¾å‡ºå¼·çƒˆçš„å…¬å¹³æ­£ç¾©æ„Ÿã€æ¸…æ™°çš„é‚è¼¯æ€ç¶­å’Œé«˜åº¦çš„èª å¯¦èˆ‡æ­£ç›´ã€‚æ‚¨æ¥µåº¦é‡è¦–äº‹å¯¦ã€è­‰æ“šèˆ‡é‚è¼¯ï¼ŒåŠ›æ±‚åœ¨ä»»ä½•æƒ…æ³ä¸‹éƒ½ä¿æŒå®¢è§€ä¸­ç«‹ï¼Œä¸¦æœŸæœ›ä»–äººä¹Ÿèƒ½å¦‚æ­¤ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½è®Šå¾—éåº¦åš´å²ã€æ‰¹åˆ¤ã€ç¼ºä¹å½ˆæ€§æˆ–ä¸è¿‘äººæƒ…ã€‚éœ€è¦å­¸ç¿’åœ¨ç†æ™ºèˆ‡æƒ…æ„Ÿã€å…¬æ­£èˆ‡æ…ˆæ‚²ä¹‹é–“å–å¾—ç²¾å¦™çš„å¹³è¡¡ï¼Œç†è§£â€œæ³•ç†ä¸å¤–ä¹äººæƒ…â€ï¼Œå­¸æœƒå¯¬æ•ã€‚' },
          12: { name: 'å€’åŠäºº', shortMeaning: 'çŠ§ç‰²ã€æ–°è¦–è§’ã€ç­‰å¾…ã€è‡£æœèˆ‡é “æ‚Ÿ', soulMission: 'æ‚¨çš„ç”Ÿå‘½ç›®æ¨™æ˜¯å­¸ç¿’â€œè‡£æœâ€çš„è—è¡“ï¼Œé€™ä¸æ˜¯æ¶ˆæ¥µçš„æ”¾æ£„ï¼Œè€Œæ˜¯ç©æ¥µåœ°å°‡å€‹äººæ„å¿—èˆ‡å®‡å®™çš„æ›´é«˜æ„å¿—æ ¡æº–ï¼Œå¾è€Œåœ¨çœ‹ä¼¼åœæ»¯çš„ç‹€æ…‹ä¸­ï¼Œç²å¾—æ›´é«˜å±¤æ¬¡çš„ç†è§£èˆ‡éˆæ€§è¦ºé†’ã€‚', personalityTrait: 'æ‚¨æ·±å…·è€å¿ƒèˆ‡èˆ‡çœ¾ä¸åŒçš„è¦–è§’ï¼Œå–„æ–¼åæ€ï¼Œä¸ç•æ‡¼å¾ä¸€å€‹å®Œå…¨ç›¸åçš„è§’åº¦å»çœ‹å¾…äººå’Œäº‹ã€‚æ‚¨çš„äººç”Ÿå“²å­¸å¾€å¾€èˆ‡ä¸»æµæ ¼æ ¼ä¸å…¥ï¼Œä½†å»è˜Šå«è‘—æ·±åˆ»çš„æ™ºæ…§ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½å°‡â€œè‡£æœâ€èª¤è§£ç‚ºâ€œç„¡ç‚ºâ€ï¼Œé™·å…¥é•·æœŸçš„æ‹–å»¶ã€è¢«å‹•ç­‰å¾…æˆ–ç™¼å±•å‡ºç„¡åŠ©çš„å—å®³è€…å¿ƒæ…‹ã€‚éœ€è¦å­¸æœƒåˆ†è¾¨ä½•æ™‚è©²æ›èµ·ï¼Œä½•æ™‚è©²æŠŠè‡ªå·±â€œæ”¾ä¸‹ä¾†â€æ¡å–è¡Œå‹•ã€‚' },
          13: { name: 'æ­»ç¥', shortMeaning: 'çµæŸèˆ‡æ–°ç”Ÿã€è½‰è®Šã€æ”¾ä¸‹ã€å¾¹åº•æ”¹è®Š', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æ·±åˆ»ç†è§£ä¸¦æ“æŠ±ç”Ÿå‘½ä¸­ç„¡å¯é¿å…çš„ã€æŒçºŒç™¼ç”Ÿçš„çµæŸèˆ‡é–‹å§‹çš„å®å¤§å¾ªç’°ã€‚æ‚¨çš„ä»»å‹™æ˜¯å»é™¤æ‰€æœ‰éæœ¬è³ªçš„æ±è¥¿ï¼Œè®“ç”Ÿå‘½çš„çœŸæˆ‘å¾—ä»¥é‡ç”Ÿã€‚', personalityTrait: 'æ‚¨æ·±å…·æ´å¯ŸåŠ›ï¼Œä¸æ‡¼æ€•æ·±åˆ»çš„æ”¹è®Šï¼Œç”šè‡³å¯èƒ½ä¸»å‹•å°‹æ±‚æˆ–ä¿ƒæˆåŠ‡çƒˆçš„è½‰è®Šã€‚æ‚¨å¤©ç”Ÿå°±èƒ½çœ‹é€äº‹ç‰©çš„æœ¬è³ªï¼Œå°æ–¼è™›å½ã€éæ™‚çš„é—œä¿‚èˆ‡çµæ§‹ï¼Œæ‚¨æœ‰è‘—å¿«åˆ€æ–¬äº‚éº»çš„å‹‡æ°£ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å°â€œçµæŸâ€çš„ææ‡¼æˆ–æ¿«ç”¨ã€‚å¯èƒ½å› ç‚ºå®³æ€•æœªçŸ¥è€Œæ­»æŠ“èˆŠäº‹ç‰©ä¸æ”¾ï¼Œæˆ–åéä¾†ï¼Œå› æ¸´æœ›æ”¹è®Šè€Œè®Šå¾—è‰ç‡é­¯è½ã€‚éœ€è¦å­¸ç¿’ä»¥å»ºè¨­æ€§çš„æ–¹å¼æ“æŠ±è½‰è®Šã€‚' },
          14: { name: 'ç¯€åˆ¶', shortMeaning: 'å¹³è¡¡ã€èª¿å’Œã€æ•´åˆã€è€å¿ƒèˆ‡ä¸­åº¸ä¹‹é“', soulMission: 'æ‚¨çš„ç”Ÿå‘½ç›®æ¨™æ˜¯å­¸æœƒåœ¨çœ‹ä¼¼å°ç«‹çš„å…©æ¥µåŠ›é‡ä¹‹é–“æ‰¾åˆ°é‚£æ¢ç¥è–çš„ä¸­é“ï¼Œä¸¦å°‡å®ƒå€‘å·§å¦™åœ°èåˆæˆä¸€å€‹æ›´é«˜éšçš„ã€å’Œè«§çš„æ•´é«”ã€‚æ‚¨çš„äººç”Ÿæ˜¯ä¸€å ´æŒçºŒçš„â€œç…‰é‡‘å¯¦é©—â€ã€‚', personalityTrait: 'æ‚¨æ˜¯ä¸€ä½å¤©ç”Ÿçš„å¤–äº¤å®¶ã€èª¿å’Œè€…èˆ‡ç…‰é‡‘è¡“å£«ã€‚æ‚¨æ“æœ‰å°‡ä¸åŒç”šè‡³è¡çªçš„å…ƒç´ å·§å¦™èåˆåœ¨ä¸€èµ·çš„éå‡¡èƒ½åŠ›ã€‚æ‚¨é€šå¸¸å¿ƒæ…‹å¹³å’Œï¼Œå¯Œæœ‰è€å¿ƒï¼Œç¸½èƒ½åœ¨è¤‡é›œæƒ…æ³ä¸­æ‰¾åˆ°å¹³è¡¡é»ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½ç‚ºäº†ç¶­æŒè¡¨é¢çš„å’Œè«§è€Œéåº¦å¦¥å”ï¼Œä»¥è‡³æ–¼å¤±å»è‡ªå·±çš„ç«‹å ´å’Œè²éŸ³ã€‚éœ€è¦å­¸ç¿’åœ¨å¿…è¦çš„æ™‚å€™ï¼Œèƒ½å¤ å …å®šåœ°ç«™åœ¨æŸä¸€æ–¹ï¼Œæ˜ç™½çœŸæ­£çš„å¹³è¡¡æ˜¯ä¸€å€‹å‹•æ…‹èª¿æ•´çš„éç¨‹ã€‚' },
          15: { name: 'æƒ¡é­”', shortMeaning: 'æ…¾æœ›ã€æŸç¸›ã€ç‰©è³ªä¸»ç¾©ã€é™°å½±é¢èˆ‡èª˜æƒ‘', soulMission: 'æ‚¨çš„éˆé­‚èª²é¡Œæ˜¯å‹‡æ•¢åœ°æ½›å…¥äººæ€§æœ€æ·±çš„å±¤é¢ï¼Œå»ç†è§£ã€é¢å°ä¸¦æ•´åˆè‡ªèº«çš„é™°å½±é¢ã€åŸå§‹æ…¾æœ›èˆ‡æ ¹æœ¬ææ‡¼ã€‚æ‚¨çš„ä»»å‹™æ˜¯æ‰¾å›è‡ªå·±è¢«å›šç¦çš„åŠ›é‡ï¼Œæˆç‚ºè‡ªå·±æ…¾æœ›çš„ä¸»äººï¼Œè€Œéå¥´éš¸ã€‚', personalityTrait: 'æ‚¨å¯èƒ½å……æ»¿äº†å¼·çƒˆçš„æ¿€æƒ…ã€å¹½é»˜æ„Ÿèˆ‡ç”Ÿå‘½æ´»åŠ›ï¼Œå°ç‰©è³ªä¸–ç•Œæœ‰è‘—æ¥µå¼·çš„æ„Ÿå—åŠ›å’Œäº«å—æ¬²ã€‚æ‚¨é€šå¸¸ç›´æ¥å¦ç‡ï¼Œä¸æ‡¼ä¸–ä¿—çœ¼å…‰ï¼Œæ•£ç™¼è‘—ä¸€ç¨®åŸå§‹çš„ã€æ¥µå…·å¸å¼•åŠ›çš„å€‹äººé­…åŠ›ã€‚', challenges: 'æ ¸å¿ƒæŒ‘æˆ°åœ¨æ–¼å®¹æ˜“é™·å…¥å„ç¨®å½¢å¼çš„â€œæˆç™®â€èˆ‡â€œæŸç¸›â€ï¼Œå¦‚ç‰©è³ªæˆç™®ã€ä¸å¥åº·çš„é—œä¿‚æˆ–è¢«é™åˆ¶æ€§çš„ä¿¡å¿µæ‰€æ§åˆ¶ã€‚çœŸæ­£çš„åŠ›é‡ä¾†è‡ªæ–¼çœ‹æ¸…é–éˆï¼Œä¸¦æ„è­˜åˆ°é‘°åŒ™ä¸€ç›´åœ¨è‡ªå·±æ‰‹ä¸­ã€‚' },
          16: { name: 'å¡”', shortMeaning: 'çªè®Šã€è¦ºé†’ã€è§£æ”¾ã€èˆŠçµæ§‹ç“¦è§£èˆ‡çœŸç›¸é¡¯éœ²', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯æˆç‚ºç¥è–æ„å¿—çš„â€œç ´å£è€…â€ï¼Œå‹‡æ•¢åœ°å»é¢å°å’Œæ¨å‹•é‚£äº›å¿…è¦çš„ã€é¡›è¦†æ€§çš„ç“¦è§£ã€‚æ‚¨è¢«å¬å–šå»æ‘§æ¯€é‚£äº›å»ºç«‹åœ¨è™›å‡ã€è‡ªå¤§æˆ–éæ™‚çµæ§‹ä¹‹ä¸Šçš„ç”Ÿæ´»æ¨¡å¼ï¼Œè¿ä¾†å¾¹åº•çš„è§£æ”¾ã€‚', personalityTrait: 'æ‚¨æ“æœ‰å¼·å¤§æ„å¿—åŠ›èˆ‡ä¸ç ´ä¸ç«‹çš„æ°£é­„ã€‚æ‚¨æ˜¯å¤©ç”Ÿçš„è®Šé©è€…ã€é©å‘½å®¶æˆ–â€œçœŸç›¸æ­éœ²è€…â€ï¼Œæ‚¨çš„å­˜åœ¨å¾€å¾€æœƒå¼•ç™¼å‘¨åœç’°å¢ƒçš„åŠ‡çƒˆè®Šå‹•èˆ‡å±æ©Ÿã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½ç¶“æ­·é »ç¹çš„ã€ä»¤äººç—›è‹¦çš„ç”Ÿæ´»å‹•ç›ªï¼Œæˆ–å› æ¥µåŠ›æŠ—æ‹’æ”¹è®Šè€Œè®“é‚£ä¸å¯é¿å…çš„å´©å¡Œè®Šå¾—æ›´åŠ æ…˜çƒˆã€‚éœ€è¦å­¸ç¿’ä¿¡ä»»ç”Ÿå‘½ä¸­çš„çªå¦‚å…¶ä¾†çš„è®Šé©ï¼Œä¸¦åœ¨â€œæ‹†é™¤â€ä¹‹å¾Œï¼Œç©æ¥µåœ°æŠ•å…¥åˆ°â€œé‡å»ºâ€ã€‚' },
          17: { name: 'æ˜Ÿæ˜Ÿ', shortMeaning: 'å¸Œæœ›ã€éˆæ„Ÿã€æ²»ç™’ã€å¹³éœèˆ‡ç²¾ç¥æŒ‡å¼•', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯åœ¨ç¶“æ­·äº†æ··äº‚æˆ–æŒ‘æˆ°ä¹‹å¾Œï¼Œé‡æ–°æ‰¾å›å…§å¿ƒçš„ç´”æ·¨èˆ‡å°å®‡å®™çš„ä¿¡ä»»ï¼Œä¸¦æˆç‚ºä»–äººç”Ÿå‘½ä¸­çš„å¸Œæœ›ä¹‹å…‰èˆ‡éˆæ„Ÿä¹‹æ³‰ã€‚æ‚¨çš„ä»»å‹™æ˜¯æé†’è‡ªå·±å’Œä»–äººï¼Œåœ¨æœ€æ·±çš„é»‘æš—ä¹‹å¾Œï¼Œå¿…æœ‰æ˜Ÿå…‰é–ƒè€€ã€‚', personalityTrait: 'æ‚¨é€šå¸¸æ¨‚è§€ã€å……æ»¿å¸Œæœ›ã€å¯Œæœ‰åŒæƒ…å¿ƒï¼Œä¸¦å°æœªä¾†æŠ±æŒè‘—ç¾å¥½çš„æ†§æ†¬ã€‚æ‚¨å°±åƒä¸€å€‹æ¸…æ¾ˆçš„ç®¡é“ï¼Œèƒ½ç‚ºå‘¨åœç„¦æ…®çš„äººå¸¶ä¾†å¹³éœã€å®‰æ…°èˆ‡å•Ÿç¤ºã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å¯èƒ½å› ç‚ºéæ–¼ç†æƒ³åŒ–è€Œèˆ‡ç¾å¯¦è„«ç¯€ï¼Œæˆ–åœ¨ä¸æ–·çµ¦äºˆä»–äººèƒ½é‡æ™‚ï¼Œå¿½ç•¥äº†è‡ªèº«çš„éœ€æ±‚ï¼Œå°è‡´èƒ½é‡è€—ç«­ã€‚éœ€è¦å­¸ç¿’åœ¨ä¿æŒå¸Œæœ›çš„åŒæ™‚ï¼Œé›™è…³å …å¯¦åœ°è¸©åœ¨å¤§åœ°ä¸Šã€‚' },
          18: { name: 'æœˆäº®', shortMeaning: 'å¹»è±¡ã€ç›´è¦ºã€æ½›æ„è­˜ã€ææ‡¼èˆ‡å¤¢å¢ƒ', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯å‹‡æ•¢åœ°è¸ä¸Šé€šå¾€æ½›æ„è­˜æ·±æµ·çš„å¤œèˆªï¼Œç©¿è¶Šå…§å¿ƒæœ€å¤è€çš„ææ‡¼èˆ‡å¹»è±¡ï¼Œå¾è€Œæ‰“æ’ˆå‡ºæ·±åˆ»çš„ç›´è¦ºæ™ºæ…§èˆ‡å‰µé€ åŠ›çš„çç ã€‚æ‚¨çš„ä»»å‹™æ˜¯å­¸æœƒä¿¡ä»»é‚£éç†æ€§çš„ã€è¶…è¶Šèªè¨€çš„å…§åœ¨æŒ‡å¼•ã€‚', personalityTrait: 'æ‚¨å€‹æ€§æ•æ„Ÿã€å¯Œæœ‰åŒæƒ…å¿ƒã€æƒ³åƒåŠ›æ¥µå…¶è±å¯Œï¼Œä¸¦å…·æœ‰å¼·çƒˆçš„ç›´è¦ºåŠ›ã€‚æ‚¨åƒä¸€å¡Šæµ·ç¶¿ï¼Œèƒ½è¼•æ˜“åœ°å¸æ”¶å‘¨åœç’°å¢ƒèˆ‡ä»–äººçš„æƒ…ç·’ã€‚æ‚¨çš„å…§å¿ƒä¸–ç•Œè±å¯Œå¤šå½©ï¼Œå……æ»¿äº†å„ç¨®å¥‡ç•°çš„æ™¯è±¡èˆ‡æ„Ÿå—ã€‚', challenges: 'æ ¸å¿ƒæŒ‘æˆ°åœ¨æ–¼å®¹æ˜“åœ¨å¹»è±¡èˆ‡ç¾å¯¦ä¹‹é–“è¿·å¤±ã€‚æ‚¨å¯èƒ½éåº¦å—åˆ°ç’°å¢ƒæˆ–ä»–äººè² é¢æƒ…ç·’çš„å½±éŸ¿ï¼Œé™·å…¥é€±æœŸæ€§çš„ç„¦æ…®ã€å›°æƒ‘æˆ–è‡ªæˆ‘æ¬ºé¨™ã€‚æ‰æ ¹ç·´ç¿’å°æ‚¨è‡³é—œé‡è¦ã€‚' },
          19: { name: 'å¤ªé™½', shortMeaning: 'å¿«æ¨‚ã€æˆåŠŸã€æ´»åŠ›ã€æ¸…æ™°èˆ‡ç”Ÿå‘½åŠ›', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯å…¨ç„¶åœ°ã€ä¸å¸¶æ­‰æ„åœ°å±•ç¾å…§åœ¨çš„å…‰æ˜ã€å–œæ‚…èˆ‡å‹ƒå‹ƒç”Ÿæ©Ÿï¼Œæˆç‚ºç´”ç²¹çš„æ„›èˆ‡çœŸç†çš„æ´»ç”Ÿç”Ÿçš„åŒ–èº«ï¼Œå¾è€Œç…§äº®è‡ªå·±å’Œå‘¨åœçš„ä¸–ç•Œã€‚æ‚¨çš„ä»»å‹™å°±æ˜¯ï¼šæˆç‚ºå…‰ï¼Œæ•£ç™¼å…‰ã€‚', personalityTrait: 'æ‚¨æ¨‚è§€é–‹æœ—ã€ç²¾åŠ›å……æ²›ã€å……æ»¿è‡ªä¿¡èˆ‡ç†±æƒ…ï¼Œæ•£ç™¼è‘—é ˜è¢–æ°£è³ªå’Œæº«æš–çš„æ„ŸæŸ“åŠ›ã€‚æ‚¨æ˜¯äººç¾¤ä¸­çš„â€œç™¼å…‰é«”â€ï¼Œæ‚¨çš„å‡ºç¾ç¸½èƒ½é©…æ•£é™°éœ¾ï¼Œå¸¶ä¾†æ­¡è²ç¬‘èªã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼å…‰èŠ’çš„éåº¦èˆ‡é™°å½±ã€‚å¯èƒ½å› ç‚ºéåº¦è‡ªä¿¡è€Œè®Šå¾—è‡ªè² ã€å‚²æ…¢ï¼Œæˆ–éåº¦è¿½æ±‚å¤–ç•Œçš„æŒè²èˆ‡èªå¯ã€‚éœ€è¦å­¸ç¿’å°‡å€‹äººçš„å…‰èŠ’èˆ‡è¬™éœç›¸çµåˆï¼Œæ˜ç™½çœŸæ­£çš„å¤ªé™½æ˜¯ç…§äº®è¬ç‰©ã€‚' },
          20: { name: 'å¯©åˆ¤', shortMeaning: 'è¦ºé†’ã€é‡ç”Ÿã€å¬å–šã€è©•ä¼°èˆ‡å¯¬æ•', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯å›æ‡‰ä¾†è‡ªéˆé­‚æ·±è™•çš„å¬å–šï¼Œç¶“æ­·ä¸€æ¬¡æ·±åˆ»çš„ã€æ±ºå®šæ€§çš„éˆæ€§è¦ºé†’èˆ‡é‡ç”Ÿã€‚é€™éœ€è¦æ‚¨å°éå¾€çš„äººç”Ÿé€²è¡Œä¸€æ¬¡å¾¹åº•ã€èª å¯¦çš„è©•ä¼°ï¼Œæ”¾ä¸‹æ‰€æœ‰èˆŠæœ‰çš„åŒ…è¢±ï¼Œæ´»å‡ºæ›´æœ‰æ„ç¾©çš„ç”Ÿå‘½ã€‚', personalityTrait: 'æ‚¨é€šå¸¸å…·æœ‰å¼·çƒˆçš„ä½¿å‘½æ„Ÿå’Œæ·±åˆ»çš„åæ€èƒ½åŠ›ã€‚æ‚¨èƒ½æ„ŸçŸ¥åˆ°è¶…è¶Šæ—¥å¸¸ç‘£ç¢ç”Ÿæ´»çš„æ›´é«˜å±¤æ¬¡çš„å¬å–šï¼Œä¸¦å°‹æ±‚äººç”Ÿçš„çµ‚æ¥µæ„ç¾©ã€‚æ‚¨æ˜¯é‚£ç¨®èƒ½åšå‡ºé‡å¤§äººç”Ÿè½‰è®Šï¼Œä¸¦æ¿€å‹µä»–äººä¹Ÿé€™éº¼åšçš„äººã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼â€œè©•åˆ¤â€çš„é™°å½±é¢ã€‚æ‚¨å¯èƒ½éæ–¼åš´å²åœ°è©•åˆ¤è‡ªå·±éå»çš„â€œç½ªéâ€ï¼Œæˆ–å°ä»–äººå¹æ¯›æ±‚ç–µï¼Œæ²‰æººæ–¼æ‚”æ¨ä¸­ç„¡æ³•è‡ªæ‹”ã€‚æ‚¨éœ€è¦å­¸ç¿’çš„é—œéµèª²é¡Œæ˜¯çœŸæ­£çš„â€œå¯¬æ•â€â€”â€”ä¸åƒ…æ˜¯åŸè«’ä»–äººï¼Œæ›´æ˜¯å¾¹åº•åœ°åŸè«’è‡ªå·±ã€‚' },
          21: { name: 'ä¸–ç•Œ', shortMeaning: 'å®Œæˆã€æˆå°±ã€æ•´åˆã€åœ“æ»¿èˆ‡å®‡å®™æ„è­˜', soulMission: 'æ‚¨çš„éˆé­‚ä½¿å‘½æ˜¯è¿½æ±‚ä¸¦é”æˆç”Ÿå‘½æ—…ç¨‹çš„åœ“æ»¿å®Œæˆèˆ‡æ·±åº¦æ•´åˆï¼Œåœ¨æ‰€æœ‰å±¤é¢éƒ½é”åˆ°ä¸€ç¨®å’Œè«§ã€è±ç››èˆ‡å°å®‡å®™ä¸€é«”æ„è­˜çš„æ·±åˆ»äº†æ‚Ÿã€‚æ‚¨æ˜¯ä¾†å‘ä¸–ç•Œå±•ç¤ºï¼Œä¸€å€‹æ•´åˆäº†æ‰€æœ‰ç¶“é©—çš„éˆé­‚æ˜¯å¦‚ä½•è‡ªç”±ã€æˆåŠŸã€å¿«æ¨‚åœ°æ´»è‘—ã€‚', personalityTrait: 'æ‚¨å…·æœ‰é–‹é—Šçš„ã€å…¨çƒæ€§ä¹ƒè‡³å®‡å®™æ€§çš„è¦–é‡ï¼Œå¼·å¤§çš„æ•´åˆèƒ½åŠ›å’Œæ·±åº¦çš„åŒ…å®¹å¿ƒã€‚æ‚¨èƒ½å¤ è¼•æ˜“åœ°ç†è§£ä¸¦æ¬£è³ç”Ÿå‘½çš„å¤šæ¨£æ€§èˆ‡ä¸åŒæ–‡åŒ–ã€è§€é»çš„åƒ¹å€¼ã€‚', challenges: 'æŒ‘æˆ°åœ¨æ–¼â€œå®Œæˆä¹‹å¾Œâ€ã€‚åœ¨é”åˆ°ä¸€å€‹é‡è¦çš„é‡Œç¨‹ç¢‘ä¹‹å¾Œï¼Œæ‚¨å¯èƒ½æ„Ÿåˆ°ä¸€ç¨®ç©ºè™›ï¼Œé›£ä»¥é–‹å•Ÿä¸€å€‹å…¨æ–°çš„ç¯‡ç« ã€‚éœ€è¦å­¸ç¿’åœ¨æ¯ä¸€å€‹â€œå®Œæˆâ€ä¹‹å¾Œï¼Œå„ªé›…åœ°è½‰èº«ï¼Œä»¥æ­¸é›¶çš„å¿ƒæ…‹è¿æ¥ä¸‹ä¸€å€‹å…¨æ–°çš„ç”Ÿå‘½å¾ªç’°ã€‚' },
        };
        
        // --- SHARED CALCULATION FUNCTIONS ---
        const sharedSumDigits = (n) => {
            if (typeof n !== 'number' && typeof n !== 'string') return 0;
            return n.toString().split('').map(Number).reduce((a, b) => a + b, 0);
        };

        const sharedReduceToSingleDigit = (n) => {
            let num = n;
            while (num > 9) {
                num = sharedSumDigits(num);
            }
            return num;
        };
        
        const sharedCalculateBirthCards = (date) => {
            if (!date) return { soulCard: null, personalityCard: null, challengeCard: null, giftCard: null, steps: [] };
            
            const digits = date.replace(/-/g, '').split('').map(Number);
            let total = digits.reduce((sum, digit) => sum + digit, 0);
            const steps = [`å‡ºç”Ÿå¹´æœˆæ—¥æ•¸å­—ç›¸åŠ : ${digits.join(' + ')} = ${total}`];
            
            while (total > 21) {
              const newDigits = total.toString().split('').map(Number);
              const newTotal = newDigits.reduce((sum, digit) => sum + digit, 0);
              steps.push(`ç¸½å’Œ > 21ï¼Œç¹¼çºŒç›¸åŠ : ${newDigits.join(' + ')} = ${newTotal}`);
              total = newTotal;
            }
            
            const soulCard = total;
            let personalityCard = null;
            let challengeCard = null;
            let giftCard = null;
            const getCardName = (id) => cardDetails[id]?.name || 'æœªçŸ¥å¡ç‰Œ';
            
            if (soulCard === 19) { // Special case for The Sun
                personalityCard = 10; // 1 + 9
                giftCard = 1; // 1 + 0
                steps.push(`éˆé­‚å¡ç‰Œç‚º 19 (${getCardName(19)})ï¼Œå½¢æˆç‰¹æ®Šå¤ªé™½ä¸‰é‡ç‰Œçµ„ã€‚`);
                steps.push(`å€‹æ€§/éç¨‹ç‰Œ: 1 + 9 = ${personalityCard} (${getCardName(personalityCard)})`);
                steps.push(`å¤©è³¦/å‹•åŠ›ç‰Œ: 1 + 0 = ${giftCard} (${getCardName(giftCard)})`);
            } else if (soulCard >= 10) { // Standard two-digit cards
                const personalityDigits = soulCard.toString().split('').map(Number);
                personalityCard = personalityDigits.reduce((sum, digit) => sum + digit, 0);
                const soulValueForCalc = soulCard === 0 ? 22 : soulCard;
                challengeCard = 22 - soulValueForCalc;
                steps.push(`éˆé­‚å¡ç‰Œç‚º ${soulCard} (${getCardName(soulCard)})ã€‚`);
                steps.push(`å€‹æ€§å¡ç‰Œ: ${soulCard.toString().split('').join(' + ')} = ${personalityCard} (${getCardName(personalityCard)})`);
                steps.push(`æŒ‘æˆ°ç‰Œ: 22 - ${soulCard} = ${challengeCard} (${getCardName(challengeCard)})`);
            } else { // Single-digit cards
                personalityCard = soulCard;
                const soulValueForCalc = soulCard === 0 ? 22 : soulCard;
                challengeCard = 22 - soulValueForCalc;
                steps.push(`éˆé­‚å¡ç‰Œç‚ºå€‹ä½æ•¸ ${soulCard} (${getCardName(soulCard)})ã€‚`);
                steps.push(`å€‹æ€§å¡ç‰Œèˆ‡å…¶ç›¸åŒ: ${personalityCard} (${getCardName(personalityCard)})ã€‚`);
                if (soulCard !== 0) { // Fool's challenge can be seen differently, but this is a common method
                  steps.push(`æŒ‘æˆ°ç‰Œ: 22 - ${soulCard} = ${challengeCard} (${getCardName(challengeCard)})`);
                } else {
                  steps.push(`æŒ‘æˆ°ç‰Œ: 0è™Ÿæ„šè€…çš„æŒ‘æˆ°æ˜¯å…¶è‡ªèº«ï¼Œåœ¨æ—…ç¨‹ä¸­å­¸ç¿’ã€‚`);
                  challengeCard = 0;
                }
            }

            if (soulCard === 0 && challengeCard !== 0) {
                 challengeCard = 0; 
            }

            return { soulCard, personalityCard, challengeCard, giftCard, steps };
        };
        
        /**
         * Returns exact date ranges for birthday-based yearly/monthly cycles
         */
        const getCycleDateRanges = (birthDate, targetDate) => {
            if (!birthDate || !targetDate) {
              return { yearly: { start: null, end: null }, monthly: { start: null, end: null } };
            }
            const [bYear, bMonth, bDay] = birthDate.split('-').map(Number);
            
            let cycleStartYear = targetDate.getFullYear();
            const birthDateInTargetYear = new Date(cycleStartYear, bMonth - 1, bDay);
            if (targetDate < birthDateInTargetYear) {
                cycleStartYear--;
            }

            const cycleStartDate = new Date(cycleStartYear, bMonth - 1, bDay);
            const cycleEndDate = new Date(cycleStartYear + 1, bMonth - 1, bDay - 1);
            
            let monthsSinceCycleStart = (targetDate.getFullYear() - cycleStartDate.getFullYear()) * 12 + (targetDate.getMonth() - cycleStartDate.getMonth());
            
            const monthlyStartDate = new Date(cycleStartDate.getFullYear(), cycleStartDate.getMonth() + monthsSinceCycleStart, bDay);
            const monthlyEndDate = new Date(monthlyStartDate.getFullYear(), monthlyStartDate.getMonth() + 1, bDay -1);

            return {
                yearly: { start: cycleStartDate, end: cycleEndDate },
                monthly: { start: monthlyStartDate, end: monthlyEndDate }
            };
        };

        /**
         * Calculates fortune cards based on the user's specific rules.
         */
        const sharedCalculateFortuneCards = (birthDate, targetDate) => {
            if (!birthDate || !targetDate) return { yearlyCard: null, monthlyCard: null, cycleInfo: null, steps: { yearly: [], monthly: [] } };
            
            const [bYear, bMonth, bDay] = birthDate.split('-').map(Number);
            const cycleInfo = getCycleDateRanges(birthDate, targetDate);
            if (!cycleInfo.yearly.start) return { yearlyCard: null, monthlyCard: null, cycleInfo: null, steps: { yearly: [], monthly: [] } };
            
            // --- Yearly Card Calculation (User's Rule) ---
            const yearlySteps = [];
            const cycleStartYear = cycleInfo.yearly.start.getFullYear();
            
            const yearlySum = sharedSumDigits(cycleStartYear) + bMonth + bDay;
            const yearlyCard = sharedReduceToSingleDigit(yearlySum);
            
            yearlySteps.push(`1. æµå¹´é€±æœŸå¾ç”Ÿæ—¥ç®—èµ·ï¼Œç•¶å‰æµå¹´å§‹æ–¼ ${cycleStartYear}å¹´${bMonth}æœˆ${bDay}æ—¥`);
            yearlySteps.push(`2. è¨ˆç®—å…¬å¼: (æµå¹´å¹´ä»½æ•¸å­—å’Œ) + (å‡ºç”Ÿæœˆ) + (å‡ºç”Ÿæ—¥)`);
            yearlySteps.push(`   => ${cycleStartYear.toString().split('').join(' + ')} + ${bMonth} + ${bDay} = ${yearlySum}`);
            if (yearlySum > 9) {
                 yearlySteps.push(`3. ç¸½å’Œç‚ºé›™ä½æ•¸ï¼Œç›¸åŠ è‡³å€‹ä½: ${yearlySum.toString().split('').join(' + ')} = ${yearlyCard}`);
            }
            yearlySteps.push(`4. æ‚¨çš„å¹´é‹ç‰Œç‚º: ${yearlyCard} (${cardDetails[yearlyCard]?.name || 'æœªçŸ¥'})`);


            // --- Monthly Card Calculation (User's Rule) ---
            const monthlySteps = [];
            const targetMonth = targetDate.getMonth() + 1;
            const sumOfBirthYear = sharedSumDigits(bYear);

            const monthlySum = sumOfBirthYear + targetMonth + bDay;
            const monthlyCard = sharedReduceToSingleDigit(monthlySum);

            monthlySteps.push(`1. è¨ˆç®—å…¬å¼: (å‡ºç”Ÿå¹´ä»½æ•¸å­—å’Œ) + (ç›®æ¨™æœˆ) + (å‡ºç”Ÿæ—¥)`);
            monthlySteps.push(`   => ${bYear.toString().split('').join(' + ')} + ${targetMonth} + ${bDay} = ${monthlySum}`);
            if (monthlySum > 9) {
                monthlySteps.push(`2. ç¸½å’Œç‚ºé›™ä½æ•¸ï¼Œç›¸åŠ è‡³å€‹ä½: ${monthlySum.toString().split('').join(' + ')} = ${monthlyCard}`);
            }
            monthlySteps.push(`3. æ‚¨çš„æœˆé‹ç‰Œç‚º: ${monthlyCard} (${cardDetails[monthlyCard]?.name || 'æœªçŸ¥'})`);

            return {
                yearlyCard: yearlyCard,
                monthlyCard: monthlyCard,
                cycleInfo: cycleInfo,
                steps: { yearly: yearlySteps, monthly: monthlySteps }
            };
        };

        // --- SHARED IMAGE PATH HELPER ---
        const cardFileNames = {
          0: '00æ„šè€….png', 1: '01é­”æœ¯å¸ˆ.png', 2: '02å¥³ç¥­ç¥€.png', 3: '03çš‡å.png', 4: '04çš‡å¸.png',
          5: '05æ•™çš‡.png', 6: '06æ‹äºº.png', 7: '07æˆ˜è½¦.png', 8: '08åŠ›é‡.png', 9: '09éšå£«.png',
          10: '10å‘½è¿ä¹‹è½®.png', 11: '11æ­£ä¹‰.png', 12: '12å€’åŠäºº.png', 13: '13æ­»ç¥.png',
          14: '14èŠ‚åˆ¶.png', 15: '15æ¶é­”.png', 16: '16é«˜å¡”.png', 17: '17æ˜Ÿæ˜Ÿ.png', 18: '18æœˆäº®.png',
          19: '19å¤ªé˜³.png', 20: '20å®¡åˆ¤.png', 21: '21ä¸–ç•Œ.png'
        };

        const sharedGetCardImagePath = (cardId) => {
          if (cardId === null || cardId === undefined) return '';
          const fileName = cardFileNames[cardId];
          if (!fileName) return '';
          return `https://raw.githubusercontent.com/KOIBENTO/testing/main/Tarot%20Cards/${fileName}`;
        };

        // --- TAROT BIRTH CARDS CALCULATOR (Mary K. Greer System with Challenge Card) ---
        const TarotBirthCardsCalculator = () => {
          const [birthDate, setBirthDate] = useState('');
          const [result, setResult] = useState(null);
          const [detailedReport, setDetailedReport] = useState(null);
          const [showProcess, setShowProcess] = useState(false);
          const [showInfo, setShowInfo] = useState(false);
          const [viewMode, setViewMode] = useState('simple');

          const TarotTheoryInfo = () => (
            <div className="mt-8 p-6 bg-white rounded-lg shadow-md space-y-6 text-gray-700 transition-all duration-500 ease-in-out">
              <h2 className="text-2xl font-bold text-purple-800 text-center flex items-center justify-center gap-2">
                <BookOpen /> å¡”ç¾…ç”Ÿå‘½éˆæ•¸ç³»çµ±æ·±åº¦è§£ç¢¼
              </h2>
              
              <section>
                <h3 className="text-xl font-semibold text-purple-700 mb-2">éˆé­‚è—åœ–èˆ‡å€‹æ€§è¡¨ç¾çš„æ·±åº¦è§£ç¢¼</h3>
                <p className="text-base leading-relaxed">
                  å¡”ç¾…ç‰Œç”Ÿå‘½éˆæ•¸ç³»çµ±æ­ç¤ºäº†æ¯å€‹äººç¨ç‰¹çš„éˆé­‚è—åœ–å’Œäººç”Ÿä½¿å‘½ï¼Œé€éå‡ºç”Ÿæ—¥æœŸè¨ˆç®—å¾—å‡ºçš„å¤§é˜¿çˆ¾å¡ç´ç‰Œï¼Œèƒ½æ·±å…¥ç†è§£å€‹äººçš„å…§åœ¨æœ¬è³ªèˆ‡å¤–åœ¨è¡¨ç¾ã€‚é€™å¥—ç³»çµ±ä¸åƒ…æ˜¯å åœå·¥å…·ï¼Œæ›´æ˜¯ä¸€ä»½è©³ç›¡çš„è‡ªæˆ‘æˆé•·åœ°åœ–ã€‚æ¯å€‹äººéƒ½æ“æœ‰ä»£è¡¨éˆé­‚æ ¸å¿ƒçš„ã€Œéˆé­‚å¡ç‰Œã€ã€å±•ç¾ä»Šç”Ÿå­¸ç¿’èª²é¡Œçš„ã€Œå€‹æ€§å¡ç‰Œã€ï¼Œä»¥åŠæŒ‡å‘å¹³è¡¡èˆ‡å®Œæ•´æ€§çš„ã€ŒæŒ‘æˆ°å¡ç‰Œã€ã€‚
                </p>
              </section>

              <section>
                 <h3 className="text-xl font-semibold text-purple-700 mb-2">ç†è«–æ¶æ§‹èˆ‡è¨ˆç®—æ–¹æ³•</h3>
                 <p className="text-base leading-relaxed mb-2">
                  æ­¤è¨ˆç®—å™¨æ¡ç”¨æ¨™æº–æ–¹æ³•è¨ˆç®—éˆé­‚èˆ‡å€‹æ€§ç‰Œï¼Œä¸¦å¼•å…¥äº†â€œäº’è£œ/æŒ‘æˆ°ç‰Œâ€ä»¥æä¾›æ›´å®Œæ•´çš„è¦–è§’ã€‚
                 </p>
                 <div className="bg-blue-50 rounded-lg p-4 text-sm text-blue-800">
                      <p className="font-semibold mb-1">è¨ˆç®—ç¯„ä¾‹ï¼š</p>
                      <ul className="list-disc list-inside space-y-1">
                        <li><b>éˆé­‚å¡ç‰Œ</b>ï¼šå°‡å‡ºç”Ÿæ—¥æœŸçš„æ¯å€‹æ•¸å­—ç›¸åŠ ï¼ˆä¾‹ï¼š1988-12-05 â†’ 1+9+8+8+1+2+0+5 = 34ï¼‰ã€‚å¦‚æœç¸½å’Œå¤§æ–¼21ï¼ŒæŒçºŒå°‡æ•¸å­—ç›¸åŠ ç›´åˆ°å°æ–¼ç­‰æ–¼21ï¼ˆ3+4 = 7ï¼‰ã€‚</li>
                        <li><b>å€‹æ€§å¡ç‰Œ</b>ï¼šå°‡éˆé­‚å¡ç‰Œçš„æ•¸å­—ç›¸åŠ å¾—åˆ°å€‹æ€§å¡ç‰Œï¼ˆä¾‹ï¼šéˆé­‚ç‰Œç‚º15ï¼Œå€‹æ€§ç‰Œç‚º 1+5=6ï¼‰ã€‚å¦‚æœéˆé­‚å¡ç‰Œå·²æ˜¯å€‹ä½æ•¸ï¼Œå‰‡å…©è€…ç›¸åŒã€‚</li>
                        <li><b>æŒ‘æˆ°å¡ç‰Œ</b>ï¼šå…¬å¼ç‚ºã€22 - éˆé­‚å¡ç‰Œã€‘ã€‚é€™ä»£è¡¨äº†ç‚ºäº†é”åˆ°å®Œæ•´æ€§ï¼Œæ‚¨éœ€è¦æ•´åˆçš„äº’è£œèƒ½é‡ã€‚ï¼ˆä¾‹ï¼šéˆé­‚ç‰Œç‚º7ï¼ŒæŒ‘æˆ°ç‰Œç‚º 22-7=15ï¼‰ã€‚</li>
                        <li><b>ç‰¹æ®Šçµ„åˆ (å¤ªé™½)</b>ï¼šç•¶éˆé­‚å¡ç‰Œæ˜¯19æ™‚ï¼Œæœƒç”¢ç”Ÿä¸‰å¼µç‰Œçš„ç‰¹æ®Šå‰µé€ å¾ªç’°ï¼š19 (å¤ªé™½), 10 (å‘½é‹ä¹‹è¼ª), 1 (é­”è¡“å¸«)ï¼Œæ­¤æ™‚ä¸è¨ˆç®—æŒ‘æˆ°ç‰Œã€‚</li>
                      </ul>
                  </div>
              </section>

              <section>
                 <h3 className="text-xl font-semibold text-purple-700 mb-2">éˆé­‚å¡ç‰Œ vs. å€‹æ€§å¡ç‰Œ vs. æŒ‘æˆ°/å¤©è³¦å¡ç‰Œ</h3>
                 <div className="grid md:grid-cols-1 gap-4">
                      <div className="bg-purple-50 p-3 rounded-lg border-l-4 border-purple-500">
                          <h4 className="font-bold text-purple-800">éˆé­‚å¡ç‰Œ (Soul Card)</h4>
                          <p className="text-sm">ä»£è¡¨å€‹äººçš„<b>éˆé­‚ç›®çš„</b>ã€<b>æ ¸å¿ƒæœ¬è³ª</b>èˆ‡è·¨è¶Šå¤šå€‹ç”Ÿä¸–çš„æ°¸æ†ç‰¹è³ªã€‚å®ƒåæ˜ éˆé­‚çš„æ ¹æœ¬ä½¿å‘½ã€èˆ‡ç”Ÿä¿±ä¾†çš„å¤©è³¦å’Œæœ€é«˜æ½›èƒ½ã€‚</p>
                      </div>
                      <div className="bg-pink-50 p-3 rounded-lg border-l-4 border-pink-500">
                          <h4 className="font-bold text-pink-800">å€‹æ€§å¡ç‰Œ (Personality Card)</h4>
                          <p className="text-sm">æè¿°å€‹äººåœ¨<b>æ­¤ç”Ÿéœ€è¦å­¸ç¿’çš„èª²é¡Œ</b>ã€å¤–åœ¨ä¸–ç•Œçš„<b>äººæ ¼è¡¨ç¾æ–¹å¼</b>ä»¥åŠéœ€è¦æŒæ¡å’Œæ•´åˆçš„äººç”ŸåŠŸèª²ã€‚é€™æ˜¯éˆé­‚ä½¿å‘½åœ¨ç¾å¯¦ç”Ÿæ´»ä¸­çš„é«”ç¾ã€‚</p>
                      </div>
                      <div className="bg-indigo-50 p-3 rounded-lg border-l-4 border-indigo-500">
                          <h4 className="font-bold text-indigo-800">äº’è£œ/æŒ‘æˆ°å¡ç‰Œ (Challenge Card)</h4>
                          <p className="text-sm">æ­¤ç‰Œç”±ã€22 - éˆé­‚ç‰Œã€‘å¾—å‡ºï¼Œä»£è¡¨ç‚ºäº†å¹³è¡¡å¤©æ€§ã€é”æˆå®Œæ•´äººæ ¼ï¼Œéœ€è¦æœ‰æ„è­˜å»å­¸ç¿’å’Œæ•´åˆçš„èƒ½é‡ã€‚å®ƒæ—¢æ˜¯ç›²é»ï¼Œä¹Ÿæ˜¯é€šå¾€æ›´é«˜æ™ºæ…§çš„æ©‹æ¨‘ã€‚<br/>
                           - <b>ä¾‹å¤–ï¼š</b>è‹¥éˆé­‚ç‰Œç‚º19 (å¤ªé™½)ï¼Œå‰‡å½¢æˆç‰¹æ®Šçš„â€œå¤©è³¦ä¸‰é‡å¥â€ï¼Œä¸é©ç”¨æ­¤è¦å‰‡ã€‚
                          </p>
                      </div>
                 </div>
              </section>

              <section>
                  <h3 className="text-xl font-semibold text-purple-700 mb-2">ç”Ÿå‘½ç‰Œå¡çµ„åˆçš„è§£è®€é‡é»</h3>
                  <div className="space-y-4">
                      <div className="p-4 bg-gray-50 rounded-lg">
                          <h4 className="font-bold text-gray-800">æƒ…æ³ä¸€ï¼šçµ±ä¸€å‹ (1å¼µä¸»ç‰Œ + 1å¼µæŒ‘æˆ°ç‰Œ)</h4>
                          <p className="text-sm mt-1">ç•¶ç”Ÿæ—¥æ•¸å­—ç¸½å’Œç‚º 1-9 æ™‚ï¼Œæ‚¨çš„ã€Œéˆé­‚ç‰Œã€èˆ‡ã€Œå€‹æ€§ç‰Œã€æ˜¯åŒä¸€å¼µç‰Œã€‚é€™ä»£è¡¨æ‚¨çš„å…§å¤–èƒ½é‡é«˜åº¦é›†ä¸­ã€‚æŒ‘æˆ°ç‰Œ(22 - éˆé­‚ç‰Œ)åœ¨æ­¤æ™‚å°¤ç‚ºé‡è¦ï¼Œå®ƒæŒ‡å‡ºäº†å¹³è¡¡é€™è‚¡å¼·å¤§ã€å–®ä¸€èƒ½é‡çš„é—œéµæ–¹å‘ã€‚</p>
                      </div>
                      <div className="p-4 bg-gray-50 rounded-lg">
                          <h4 className="font-bold text-gray-800">æƒ…æ³äºŒï¼šæ¨™æº–ä¸‰ç‰Œçµ„ (éˆé­‚+å€‹æ€§+æŒ‘æˆ°)</h4>
                          <p className="text-sm mt-1">ç•¶ç”Ÿæ—¥æ•¸å­—ç¸½å’Œç‚º 10-18ã€20 æˆ– 21 æ™‚ï¼Œæ‚¨æœƒæœ‰ä¸‰å¼µæ ¸å¿ƒç‰Œã€‚æŒ‘æˆ°ç‰Œ(22 - éˆé­‚ç‰Œ)æ­ç¤ºäº†æ‚¨çš„éˆé­‚å¤©æ€§ç‚ºäº†é¿å…èµ°å‘æ¥µç«¯ï¼Œéœ€è¦å­¸ç¿’çš„äº’è£œå“è³ªã€‚æ•´åˆé€™ä¸‰å¼µç‰Œçš„æ™ºæ…§ï¼Œæ˜¯æ‚¨æ­¤ç”Ÿæˆé•·çš„å®Œæ•´è—åœ–ã€‚</p>
                      </div>
                      <div className="p-4 bg-gray-50 rounded-lg">
                          <h4 className="font-bold text-gray-800">æƒ…æ³ä¸‰ï¼šå¤ªé™½ç‰¹æ®Šä¸‰é‡ç‰Œçµ„ (3å¼µä¸»ç‰Œ)</h4>
                          <p className="text-sm mt-1">ç•¶ç”Ÿæ—¥æ•¸å­—ç¸½å’Œç‚º 19 (å¤ªé™½) æ™‚ï¼Œé€™æ˜¯ä¸€å€‹éå¸¸ç‰¹æ®Šçš„çµ„åˆï¼Œå½¢æˆä¸€å€‹å‰µé€ å¾ªç’°ï¼š<b>19 (å¤ªé™½)</b> â†’ <b>10 (å‘½é‹ä¹‹è¼ª)</b> â†’ <b>1 (é­”è¡“å¸«)</b>ã€‚é€™ä¸‰å¼µç‰Œå…±åŒæ§‹æˆæ‚¨å¼·å¤§çš„é¡¯åŒ–æ½›èƒ½ï¼Œå…¶æœ¬èº«çš„å¾ªç’°å·²è¶³å¤ å®Œæ•´ï¼Œå› æ­¤ä¸å¦å¤–è¨ˆç®—æŒ‘æˆ°ç‰Œã€‚</p>
                      </div>
                  </div>
              </section>
            </div>
          );
          
          const generateDetailedTarotReport = (cardSet) => {
              const { soulCard, personalityCard, challengeCard, giftCard } = cardSet;
              
              let introduction = '';
              let cardsAnalysis = [];
              let dynamicsAnalysis = '';
              let developmentalFocus = '';
              
              const getCardName = (id) => cardDetails[id]?.name || 'æœªçŸ¥å¡ç‰Œ';
              const getCardChallenges = (id) => cardDetails[id]?.challenges || 'è«‹åƒé–±å¡ç‰Œè©³ç´°èªªæ˜ã€‚';

              if (giftCard !== null) { // å¤ªé™½ç‰¹æ®Šä¸‰é‡ç‰Œçµ„ (19)
                  introduction = `æ‚¨çš„ç”Ÿå‘½ç‰Œå¡çµ„åˆæ˜¯æ¥µå…¶ç½•è¦‹ä¸”å¼·å¤§çš„ã€Œå¤ªé™½ä¸‰é‡å¥ã€ï¼š${getCardName(soulCard)}(${soulCard}) â†’ ${getCardName(personalityCard)}(${personalityCard}) â†’ ${getCardName(giftCard)}(${giftCard})ã€‚é€™æ˜¯ä¸€å€‹å‹•æ…‹çš„å‰µé€ å¾ªç’°ï¼Œè±¡å¾µæ‚¨å¤©ç”Ÿæ“æœ‰å°‡å¤¢æƒ³è½‰åŒ–ç‚ºç¾å¯¦çš„éå‡¡èƒ½åŠ›ï¼Œæ˜¯å®‡å®™èƒ½é‡çš„é¡¯åŒ–é€šé“ã€‚`;
                  cardsAnalysis = [
                      { cardId: soulCard, role: 'ä¸»é¡Œç‰Œï¼šå¤ªé™½ - å…‰è¼å¯¦ç¾èˆ‡ç”Ÿå‘½å–œæ‚…', roleKey: 'soul' },
                      { cardId: personalityCard, role: 'éç¨‹ç‰Œï¼šå‘½é‹ä¹‹è¼ª - æŠŠæ¡å®‡å®™æ™‚æ©Ÿèˆ‡è³‡æºæµå‹•', roleKey: 'personality' },
                      { cardId: giftCard, role: 'å‹•åŠ›ç‰Œï¼šé­”è¡“å¸« - å€‹äººæ„å¿—èˆ‡å‰µé€ åŠ›çš„ä¸»å‹•é‹ç”¨', roleKey: 'gift' }
                  ];
                  dynamicsAnalysis = `åœ¨æ‚¨çš„å¤ªé™½ä¸‰é‡å¥ä¸­ï¼Œ${getCardName(giftCard)} (${giftCard})æ˜¯ã€Œé»ç«å™¨ã€ï¼Œä»£è¡¨æ‚¨å€‹äººæ„å¿—å’Œå‰µé€ è¡å‹•çš„æºé ­ï¼›${getCardName(personalityCard)} (${personalityCard})æ˜¯ã€Œæ”¾å¤§å™¨ã€èˆ‡ã€Œå‚¬åŒ–åŠ‘ã€ï¼Œç‚ºæ‚¨æ¥å¼•å®‡å®™çš„æ©Ÿé‡å’Œè³‡æºï¼›${getCardName(soulCard)} (${soulCard})æ˜¯ã€Œå±•ç¾å°ã€ï¼Œå°‡æ‚¨çš„å‰µé€ æˆæœä»¥æœ€å…‰è¼çš„å½¢å¼å±•ç¾çµ¦ä¸–ç•Œã€‚é€™å€‹å¾ªç’°æ˜¯ 1 â†’ 10 â†’ 19 (1+0=1 é­”è¡“å¸«çš„æ„å¿— â†’ 10 å‘½é‹ä¹‹è¼ªçš„æ©Ÿé‡ â†’ 19 å¤ªé™½çš„æˆæœ)ã€‚`;
                  developmentalFocus = `æ­¤çµ„åˆçš„æŒ‘æˆ°åœ¨æ–¼æœ‰æ„è­˜åœ°å”èª¿é€™ä¸‰è‚¡å¼·å¤§èƒ½é‡ï¼Œè®“å®ƒå€‘å½¢æˆä¸€å€‹å’Œè«§çš„å‰µé€ å¾ªç’°ï¼Œè€Œéå„è‡ªç‚ºæ”¿æˆ–éåº¦æ¶ˆè€—ã€‚é—œéµåœ¨æ–¼ï¼š\n1. ${getCardName(giftCard)}: æ¸…æ™°æ‚¨çš„æ„åœ–èˆ‡ç›®æ¨™ (${getCardChallenges(giftCard)})\n2. ${getCardName(personalityCard)}: ä¿¡ä»»å®‡å®™çš„å®‰æ’ä¸¦é †æ‡‰è®ŠåŒ– (${getCardChallenges(personalityCard)})\n3. ${getCardName(soulCard)}: æ¨‚è§€è‡ªä¿¡åœ°å±•ç¾æˆæœä¸¦åˆ†äº«å–œæ‚… (${getCardChallenges(soulCard)})ã€‚é¿å…å› èƒ½é‡éå¼·è€Œå¿½ç•¥éç¨‹ä¸­çš„ç´°ç¯€èˆ‡ä»–äººçš„æ„Ÿå—ã€‚`;
              } else if (soulCard === personalityCard) { // çµ±ä¸€å‹ (1-9)
                  introduction = `æ‚¨æ˜¯æ¥µå…¶ç‰¹æ®Šçš„ã€Œçµ±ä¸€å‹ã€äººæ ¼ - éˆé­‚ç‰Œèˆ‡å€‹æ€§ç‰Œå‡ç‚º ${soulCard} è™Ÿã€Œ${getCardName(soulCard)}ã€ã€‚é€™æ„å‘³è‘—æ‚¨çš„å…§åœ¨æœ¬è³ªèˆ‡å¤–åœ¨è¡¨ç¾é«˜åº¦çµ±ä¸€ã€‚è€Œæ‚¨çš„æŒ‘æˆ°ç‰Œã€Œ${getCardName(challengeCard)}ã€(${challengeCard})å‰‡æŒ‡å‡ºäº†å¹³è¡¡é€™è‚¡å¼·å¤§åŠ›é‡ã€èµ°å‘å®Œæ•´çš„é—œéµæ–¹å‘ã€‚`;
                  cardsAnalysis = [
                     { cardId: soulCard, role: 'æ ¸å¿ƒåŸå‹ï¼šæ‚¨çš„å­˜åœ¨æœ¬è³ªèˆ‡è¡¨é”æ–¹å¼', roleKey: 'soul' },
                     { cardId: challengeCard, role: 'æŒ‘æˆ°ç‰Œï¼šéœ€è¦æ•´åˆçš„äº’è£œèƒ½é‡èˆ‡æˆé•·é»', roleKey: 'challenge' }
                  ];
                  dynamicsAnalysis = `ä½œç‚ºçµ±ä¸€å‹ï¼Œæ‚¨çš„å¤©è³¦èˆ‡æŒ‘æˆ°éƒ½é›†ä¸­åœ¨ ${getCardName(soulCard)} çš„åŸå‹ä¸Šã€‚æ‚¨çš„æŒ‘æˆ°ç‰Œ ${getCardName(challengeCard)} æ˜¯æ‚¨é”æˆå…§åœ¨å¹³è¡¡çš„é‘°åŒ™ï¼Œå®ƒä»£è¡¨èˆ‡æ‚¨å¤©æ€§ç›¸åä½†èƒ½ä½¿å…¶å®Œæ•´çš„èƒ½é‡ã€‚`;
                  developmentalFocus = `æˆé•·é—œéµåœ¨æ–¼æ·±åº¦ç†è§£ ${getCardName(soulCard)}ï¼ˆæŒ‘æˆ°ï¼š${getCardChallenges(soulCard)}ï¼‰çš„åŒæ™‚ï¼Œæœ‰æ„è­˜åœ°å­¸ç¿’å’Œå¼•å…¥ ${getCardName(challengeCard)} çš„æ™ºæ…§ï¼ˆæŒ‘æˆ°ï¼š${getCardChallenges(challengeCard)}ï¼‰ã€‚é€™å€‹æ•´åˆéç¨‹èƒ½å¹«åŠ©æ‚¨é¿å…å¤©è³¦èµ°å‘æ¥µç«¯ï¼Œæ´»å‡ºæ›´åœ“æ»¿çš„è‡ªæˆ‘ã€‚`;
              } else { // æ¨™æº–ä¸‰ç‰Œçµ„ (éˆé­‚+å€‹æ€§+æŒ‘æˆ°)
                  introduction = `æ‚¨çš„ç”Ÿå‘½ç‰Œå¡æ§‹æˆä¸€å€‹å®Œæ•´çš„ä¸‰ç¶­å­¸ç¿’è—åœ–ï¼šéˆé­‚ç‰Œã€Œ${getCardName(soulCard)}ã€(${soulCard})å®šç¾©äº†æ‚¨çš„æ ¸å¿ƒä½¿å‘½ï¼›å€‹æ€§ç‰Œã€Œ${getCardName(personalityCard)}ã€(${personalityCard})æ˜¯æ‚¨ä»Šç”Ÿçš„ä¸»è¦èª²é¡Œï¼›è€ŒæŒ‘æˆ°ç‰Œã€Œ${getCardName(challengeCard)}ã€(${challengeCard})å‰‡æ­ç¤ºäº†ç‚ºäº†å¹³è¡¡æ‚¨çš„å¤©æ€§ï¼Œæœ€éœ€è¦å­¸ç¿’çš„äº’è£œèƒ½é‡ã€‚`;
                  cardsAnalysis = [
                      { cardId: soulCard, role: 'éˆé­‚ç‰Œï¼šæ‚¨æ°¸æ†çš„æœ¬è³ªèˆ‡æœ€é«˜ä½¿å‘½', roleKey: 'soul' },
                      { cardId: personalityCard, role: 'å€‹æ€§ç‰Œï¼šæ‚¨ä»Šç”Ÿçš„å­¸ç¿’èª²é¡Œèˆ‡å±•ç¾', roleKey: 'personality' },
                      { cardId: challengeCard, role: 'æŒ‘æˆ°ç‰Œï¼šéœ€è¦æ•´åˆçš„äº’è£œèƒ½é‡èˆ‡æˆé•·é»', roleKey: 'challenge' }
                  ];
                  dynamicsAnalysis = `æ‚¨çš„ç”Ÿå‘½è—åœ–ä¸­ï¼Œ${getCardName(personalityCard)} (${personalityCard}) æ˜¯æ‚¨åœ¨ä¸–ä¸Šå¯¦è¸ ${getCardName(soulCard)} (${soulCard}) ä½¿å‘½çš„ä¸»è¦é€”å¾‘ã€‚è€Œ ${getCardName(challengeCard)} (${challengeCard}) å‰‡åƒæ‚¨éˆé­‚çš„â€œå°è·–é»â€ï¼Œå®ƒä»£è¡¨è‘—èˆ‡æ‚¨å¤©æ€§ï¼ˆéˆé­‚ç‰Œï¼‰ç›¸åã€ä½†èƒ½ä½¿å…¶å®Œæ•´çš„èƒ½é‡ã€‚å®ƒæ˜¯æ‚¨å¹³è¡¡è‡ªæˆ‘çš„é—œéµï¼Œä¹Ÿæ˜¯é˜²æ­¢å¤©è³¦èµ°å‘æ¥µç«¯çš„æ™ºæ…§ã€‚`;
                  developmentalFocus = `æ ¸å¿ƒèª²é¡Œåœ¨æ–¼æœ‰æ„è­˜åœ°è¦ºå¯Ÿä¸¦æ•´åˆ ${getCardName(challengeCard)} æ‰€ä»£è¡¨çš„èƒ½é‡ã€‚å…¶æŒ‘æˆ°ç‚ºï¼š${getCardChallenges(challengeCard)}ã€‚\nç•¶æ‚¨çš„éˆé­‚ç‰Œ(${getCardName(soulCard)})ç‰¹è³ªéåº¦å±•ç¾æ™‚ï¼ˆæŒ‘æˆ°: ${getCardChallenges(soulCard)}ï¼‰ï¼Œè«‹è©¦è‘—å¼•å…¥æŒ‘æˆ°ç‰Œçš„æ™ºæ…§ä¾†å¹³è¡¡ã€‚\næ‚¨çš„å€‹æ€§ç‰Œ(${getCardName(personalityCard)})æ˜¯æ‚¨æ•´åˆé€™å…©ç¨®èƒ½é‡çš„èˆå°ï¼ˆæŒ‘æˆ°: ${getCardChallenges(personalityCard)}ï¼‰ã€‚å­¸æœƒåœ¨ç”Ÿæ´»ä¸­éˆæ´»é‹ç”¨é€™ä¸‰è‚¡åŠ›é‡ï¼Œæ˜¯æ‚¨æ­¤ç”Ÿåœ“æ»¿çš„é—œéµã€‚`;
              }
              return { introduction, cardsAnalysis, dynamicsAnalysis, developmentalFocus, cardSet };
          };

          const handleCalculate = () => {
            if (!birthDate) {
              alert('è«‹è¼¸å…¥å‡ºç”Ÿæ—¥æœŸ');
              return;
            }
            const cardSet = sharedCalculateBirthCards(birthDate);
            setResult(cardSet);
            const report = generateDetailedTarotReport(cardSet);
            setDetailedReport(report);
            setShowProcess(false);
            setViewMode('simple'); 
          };

          const formatDate = (date) => {
            if (!date) return '';
            const parts = date.split('-');
            return `${parts[0]}å¹´${parts[1]}æœˆ${parts[2]}æ—¥`;
          };

          const CardDisplay = ({ icon, title, cardId, bgColor, textColor, borderColor, type, description, challenges }) => {
            if (cardId === null || cardId === undefined || !cardDetails[cardId]) return null;
            const details = cardDetails[cardId];
            let displayDescription = description;
            if (type === 'soul') displayDescription = details.soulMission;
            else if (type === 'personality') displayDescription = details.personalityTrait;
            
            return (
              <div className={`${bgColor} rounded-lg p-4 shadow-sm md:shadow-md border-l-4 ${borderColor} transition-all duration-300`}>
                <div className="relative mb-3">
                  <img
                    src={sharedGetCardImagePath(cardId)}
                    alt={details.name}
                    className="w-full max-w-[150px] mx-auto rounded-lg shadow-md object-cover border-2 border-white"
                    onError={(e) => { e.target.style.display = 'none'; }}
                    loading="lazy"
                    width="150"
                    height="250"
                  />
                </div>
                
                <div className="flex items-center gap-2 mb-2">{icon}<h3 className={`font-semibold ${textColor}`}>{title}</h3></div>
                <div className={`text-2xl font-bold ${textColor} mb-1`}>{cardId} - {details.name}</div>
                <p className={`text-sm font-semibold ${textColor} mb-2`}>{details.shortMeaning}</p>
                {type !== 'challenge' && (<p className={`text-xs ${textColor} opacity-80 mb-2`}>{displayDescription}</p>)}
                {type === 'challenge' && description && (<p className={`text-xs ${textColor} opacity-80 mb-2`}>{description}</p>)}
                {challenges && (<p className={`text-xs ${textColor} opacity-70 mt-1`}><span className="font-semibold">æŒ‘æˆ°ï¼š</span>{challenges}</p>)}
              </div>
            );
          };
          
          const DetailedTarotReport = ({ reportData }) => {
            const [openSections, setOpenSections] = useState({ 'card-0': true });
            const [expandedAnalysis, setExpandedAnalysis] = useState(true);
            const toggleSection = (id) => setOpenSections(prev => ({...prev, [id]: !prev[id]}));

            if (!reportData || !reportData.cardsAnalysis) return <p>å ±å‘Šç”Ÿæˆä¸­...</p>;
            
            const { cardSet } = reportData;
             
            return (
                <div className="bg-white rounded-lg p-6 shadow-lg mt-6 animate-fade-in">
                    <h2 className="text-3xl font-bold text-purple-900 mb-3 text-center">æ‚¨çš„æ·±åº¦å¡”ç¾…ç”Ÿå‘½è—åœ–å ±å‘Š</h2>
                    <p className="text-center text-gray-700 mb-6 text-base leading-relaxed">{reportData.introduction}</p>
                    
                    <div className="space-y-6 mb-8">
                        <h3 className="text-2xl font-bold text-purple-800 text-center mb-4">æ ¸å¿ƒåŸå‹å¡ç‰Œè§£æ</h3>
                        {reportData.cardsAnalysis.map((cardAnalysis, index) => {
                            const cardData = cardDetails[cardAnalysis.cardId];
                            if (!cardData) return null; 
                            const sectionId = `card-${cardAnalysis.cardId}-${index}`;
                            const isChallengeOrGift = cardAnalysis.roleKey === 'challenge' || cardAnalysis.roleKey === 'gift';
                            
                            return (
                                <div key={index} className="border-2 border-purple-200 rounded-lg overflow-hidden shadow-md">
                                    <button onClick={() => toggleSection(sectionId)} className="w-full p-5 bg-gradient-to-r from-purple-100 to-pink-100 hover:from-purple-200 hover:to-pink-200 flex justify-between items-center transition-all duration-300">
                                        <div className="text-left">
                                            <span className="text-lg sm:text-xl font-bold text-purple-800">{cardAnalysis.role}: {cardData.name} ({cardAnalysis.cardId})</span>
                                            <div className="text-sm text-purple-600 mt-1">æ ¸å¿ƒæ„ç¾©: {cardData.shortMeaning || ''}</div>
                                        </div>
                                        <span className="text-purple-600 text-2xl">{openSections[sectionId] ? <ChevronUp /> : <ChevronDown />}</span>
                                    </button>
                                    {openSections[sectionId] && (
                                        <div className="p-6 bg-white space-y-4 animate-fade-in">
                                            <div className="p-4 bg-green-50 rounded-lg border-l-4 border-green-500">
                                                <h4 className="font-bold text-green-800 mb-2 flex items-center gap-1"><Sparkles className="w-4 h-4" /> å¤©è³¦èˆ‡éˆé­‚ä½¿å‘½ ({isChallengeOrGift ? 'æ­¤ç‰Œçš„æ•´åˆæ„ç¾©' : 'æ ¸å¿ƒå¤©è³¦'})</h4>
                                                <p className="text-sm text-gray-700 leading-relaxed">{cardData.soulMission}</p>
                                            </div>
                                            <div className="p-4 bg-orange-50 rounded-lg border-l-4 border-orange-500">
                                                <h4 className="font-bold text-orange-800 mb-2 flex items-center gap-1"><User className="w-4 h-4" /> äººæ ¼ç‰¹è³ªèˆ‡ä»Šç”Ÿè¡¨ç¾ ({isChallengeOrGift ? 'æ­¤ç‰Œçš„è¡Œç‚ºå•Ÿç¤º' : 'ä¸»è¦ç‰¹è³ª'})</h4>
                                                <p className="text-sm text-gray-700 leading-relaxed">{cardData.personalityTrait}</p>
                                            </div>
                                            <div className="p-4 bg-red-50 rounded-lg border-l-4 border-red-500">
                                                <h4 className="font-bold text-red-800 mb-2 flex items-center gap-1"><AlertCircleIcon className="w-4 h-4" /> ä¸»è¦æŒ‘æˆ°èˆ‡æˆé•·èª²é¡Œ ({isChallengeOrGift ? 'æ­¤ç‰Œçš„å¹³è¡¡èª²é¡Œ' : 'æ ¸å¿ƒæŒ‘æˆ°'})</h4>
                                                <p className="text-sm text-gray-700 leading-relaxed">{cardData.challenges}</p>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>

                     <div className="mb-8">
                        <button onClick={() => setExpandedAnalysis(!expandedAnalysis)} className="w-full p-5 bg-gradient-to-r from-blue-100 to-indigo-100 hover:from-blue-200 hover:to-indigo-200 rounded-lg shadow-md transition-all duration-300 flex items-center justify-between">
                            <h3 className="text-xl sm:text-2xl font-bold text-blue-900 flex items-center gap-2"><BrainIcon /> ç‰Œçµ„äº’å‹•å‹•åŠ›å­¸åˆ†æ</h3>
                            <span className="text-blue-600 text-2xl">{expandedAnalysis ? <ChevronUp /> : <ChevronDown />}</span>
                        </button>
                        {expandedAnalysis && (
                            <div className="mt-4 p-6 bg-blue-50 rounded-lg border-2 border-blue-200 animate-fade-in">
                                <h4 className="font-bold text-blue-800 mb-2 text-lg">å…§åœ¨èƒ½é‡æµå‹•ï¼š</h4>
                                <p className="text-blue-900 leading-relaxed text-sm whitespace-pre-line mb-4">{reportData.dynamicsAnalysis}</p>
                                <h4 className="font-bold text-red-700 mb-2 text-lg">ç™¼å±•ç„¦é»èˆ‡æŒ‘æˆ°æ•´åˆï¼š</h4>
                                <p className="text-red-800 leading-relaxed text-sm whitespace-pre-line bg-red-50 p-3 rounded">{reportData.developmentalFocus}</p>
                            </div>
                        )}
                    </div>
                    
                    <div className="text-center p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200">
                        <h4 className="text-xl font-bold text-purple-800 mb-3">ğŸ™ æ•´åˆèˆ‡å¯¦è¸</h4>
                        <p className="text-gray-700 leading-relaxed text-sm">é€™ä»½å ±å‘Šæä¾›äº†ä¸€å€‹é—œæ–¼æ‚¨ç”Ÿå‘½è—åœ–çš„æ·±åº¦è¦–è§’ã€‚è«‹è¨˜ä½ï¼Œé€™äº›ç‰Œå¡ä¸æ˜¯å°æ‚¨çš„é™åˆ¶ï¼Œè€Œæ˜¯ä¸€ä»½çè²´çš„æŒ‡å¼•ã€‚å®ƒå€‘æ­ç¤ºäº†æ‚¨çš„å¤©è³¦ã€æŒ‘æˆ°èˆ‡æœ€é«˜çš„æ½›èƒ½ã€‚é€šè¿‡ç†è§£å’Œæ•´åˆé€™äº›åŸå‹èƒ½é‡ï¼Œç‰¹åˆ¥æ˜¯è¦ºå¯Ÿä¸¦è½‰åŒ–å ±å‘Šä¸­æåŠçš„æŒ‘æˆ°èˆ‡ç™¼å±•ç„¦é»ï¼Œæ‚¨å°‡èƒ½æ›´æœ‰æ„è­˜åœ°èµ°åœ¨å±¬æ–¼è‡ªå·±çš„ç¨ç‰¹ç”Ÿå‘½é“è·¯ä¸Šï¼Œæ´»å‡ºæœ€çœŸå¯¦ã€æœ€å®Œæ•´çš„è‡ªå·±ã€‚</p>
                    </div>
                </div>
            );
          };

          return (
            <div className="max-w-3xl mx-auto p-4 sm:p-6 bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl shadow-lg md:shadow-xl font-sans">
              <div className="text-center mb-8">
                <h1 className="text-3xl font-bold text-purple-800 mb-2 flex items-center justify-center gap-2"><Sparkles className="w-8 h-8" />å¡”ç¾…ç”Ÿå‘½éˆæ•¸è¨ˆç®—å™¨</h1>
                <p className="text-gray-600">è§£ç¢¼æ‚¨çš„éˆé­‚ç‰Œã€å€‹æ€§ç‰Œèˆ‡æŒ‘æˆ°/å¤©è³¦ç‰Œ</p>
              </div>
              <div className="bg-white rounded-lg p-6 shadow-md mb-6">
                <div className="mb-6"><label className="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"><Calendar />è«‹è¼¸å…¥æ‚¨çš„å‡ºç”Ÿæ—¥æœŸ</label><input type="date" value={birthDate} onChange={(e) => setBirthDate(e.target.value)} className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"/></div>
                <button onClick={handleCalculate} className="w-full bg-purple-600 text-white py-3 rounded-md hover:bg-purple-700 transition-colors font-semibold flex items-center justify-center gap-2"><Sparkles className="w-5 h-5" /> è¨ˆç®—æˆ‘çš„ç”Ÿå‘½ç‰Œå¡</button>
              </div>
              {result && (
                <div className="space-y-6 animate-fade-in">
                  <div className="bg-white rounded-lg p-4 shadow-md">
                    <div className="flex justify-center space-x-2 sm:space-x-4">
                      <button onClick={() => setViewMode('simple')} className={`px-4 py-2 sm:px-6 sm:py-3 rounded-lg font-semibold transition-all text-sm sm:text-base ${viewMode === 'simple' ? 'bg-purple-600 text-white shadow-lg transform scale-105' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>ğŸ“Š ç°¡è¦æ¦‚è¦½</button>
                      <button onClick={() => setViewMode('detailed')} className={`px-4 py-2 sm:px-6 sm:py-3 rounded-lg font-semibold transition-all text-sm sm:text-base ${viewMode === 'detailed' ? 'bg-purple-600 text-white shadow-lg transform scale-105' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>ğŸ“š è©³ç´°åˆ†æ</button>
                    </div>
                  </div>
                  {viewMode === 'simple' ? (
                    <div className="bg-white rounded-lg p-6 shadow-md">
                      <h2 className="text-xl font-bold text-gray-800 mb-4">æ‚¨çš„å¡”ç¾…ç”Ÿå‘½éˆæ•¸çµæœ ({formatDate(birthDate)})</h2>
                      <div className="grid md:grid-cols-1 gap-6">
                        <CardDisplay icon={<Hash className="w-5 h-5 text-purple-600" />} title="éˆé­‚å¡ç‰Œ (Soul Card)" cardId={result.soulCard} bgColor="bg-purple-100" textColor="text-purple-900" borderColor="border-purple-500" type="soul" challenges={cardDetails[result.soulCard]?.challenges}/>
                        <CardDisplay icon={<User className="w-5 h-5 text-pink-600" />} title="å€‹æ€§å¡ç‰Œ (Personality Card)" cardId={result.personalityCard} bgColor="bg-pink-100" textColor="text-pink-900" borderColor="border-pink-500" type="personality" challenges={cardDetails[result.personalityCard]?.challenges}/>
                        {result.challengeCard !== null && cardDetails[result.challengeCard] && (<CardDisplay icon={<TargetIcon className="w-5 h-5 text-indigo-600" />} title="äº’è£œ/æŒ‘æˆ°ç‰Œ (Challenge Card)" cardId={result.challengeCard} bgColor="bg-indigo-100" textColor="text-indigo-900" borderColor="border-indigo-500" type="challenge" description="æ­¤ç‰Œä»£è¡¨ç‚ºäº†å¹³è¡¡å¤©æ€§ã€é”æˆå®Œæ•´äººæ ¼ï¼Œæœ€éœ€è¦å­¸ç¿’èˆ‡æ•´åˆçš„äº’è£œèƒ½é‡ã€‚" challenges={cardDetails[result.challengeCard]?.challenges}/>)}
                        {result.giftCard !== null && cardDetails[result.giftCard] && (<CardDisplay icon={<Gift className="w-5 h-5 text-yellow-600" />} title="å¤©è³¦ç‰Œ (Gift Card)" cardId={result.giftCard} bgColor="bg-yellow-100" textColor="text-yellow-900" borderColor="border-yellow-500" description="ä½œç‚ºå¤ªé™½ä¸‰é‡å¥çš„ä¸€éƒ¨åˆ†ï¼Œé€™ä»£è¡¨æ‚¨çš„æ ¸å¿ƒæ„å¿—èˆ‡å¤©è³¦æ‰èƒ½ã€‚" challenges={cardDetails[result.giftCard]?.challenges}/>)}
                      </div>
                      <button onClick={() => setShowProcess(!showProcess)} className="mt-6 text-purple-600 hover:text-purple-800 text-sm font-medium flex items-center gap-1">{showProcess ? 'éš±è—' : 'é¡¯ç¤º'}è¨ˆç®—éç¨‹<span className="text-purple-600">{showProcess ? <ChevronUp /> : <ChevronDown />}</span></button>
                      {showProcess && (<div className="mt-4 p-4 bg-gray-50 rounded-lg animate-fade-in"><h4 className="font-semibold text-gray-700 mb-2">è¨ˆç®—æ­¥é©Ÿï¼š</h4><p className="text-sm text-gray-600 mb-2">å‡ºç”Ÿæ—¥æœŸï¼š{formatDate(birthDate)}</p><div className="space-y-1">{result.steps.map((step, index) => (<p key={index} className="text-sm font-mono text-gray-700">{step}</p>))}</div></div>)}
                    </div>
                  ) : (detailedReport && <DetailedTarotReport reportData={detailedReport} />)}
                </div>
              )}
              <div className="text-center mt-8">
                <button onClick={() => setShowInfo(!showInfo)} className="inline-flex items-center gap-2 px-6 py-3 bg-white text-purple-700 rounded-full shadow-md hover:bg-purple-50 transition-transform transform hover:scale-105"><span className="font-semibold">äº†è§£æ›´å¤šé—œæ–¼å¡”ç¾…ç”Ÿå‘½éˆæ•¸</span>{showInfo ? <ChevronUp className="w-5 h-5" /> : <ChevronDown className="w-5 h-5" />}</button>
              </div>
              {showInfo && <TarotTheoryInfo />}
            </div>
          );
        };
        
        // --- TAROT COMPATIBILITY SYSTEM ---
        const TarotCompatibilitySystem = () => {
          const [person1Date, setPerson1Date] = useState('');
          const [person2Date, setPerson2Date] = useState('');
          const [person1Name, setPerson1Name] = useState('å¤¥ä¼´ A');
          const [person2Name, setPerson2Name] = useState('å¤¥ä¼´ B');
          const [result, setResult] = useState(null);
          const [showDetails, setShowDetails] = useState({ soul: false, personality: false, challenge: false, yearly: false, monthly: false });
          
          const [targetYear, setTargetYear] = useState(new Date().getFullYear());
          const [targetMonth, setTargetMonth] = useState(new Date().getMonth() + 1);
          
          const baseCompatibilityMatrix = {
             0: { 1: { score: 90, type: 'ç„¡é™æ½›èƒ½çš„å•Ÿå‹•è€…', desc: 'æ„šè€…çš„ç„¡é™æ½›èƒ½èˆ‡é­”è¡“å¸«çš„å¯¦ç¾èƒ½åŠ›ç›¸çµåˆï¼Œå‰µé€ å‡ºä¸€æ®µå……æ»¿é©šå–œèˆ‡é¡¯åŒ–å¥‡è¹Ÿçš„é—œä¿‚ã€‚é­”è¡“å¸«èƒ½å¤ æ•æ‰æ„šè€…å¤©é¦¬è¡Œç©ºçš„æƒ³æ³•ï¼Œä¸¦å°‡å…¶å…·é«”åŒ–ï¼Œè€Œæ„šè€…å‰‡èƒ½ç‚ºé­”è¡“å¸«å¸¶ä¾†å…¨æ–°çš„è¦–è§’å’Œå†’éšªçš„å‹‡æ°£ã€‚', challenges: 'æ„šè€…çš„éš¨æ€§å¯èƒ½è®“ç›®æ¨™å°å‘çš„é­”è¡“å¸«æ„Ÿåˆ°æŒ«æ•—ï¼Œè€Œé­”è¡“å¸«çš„æŒæ§æ¬²å¯èƒ½é™åˆ¶äº†æ„šè€…çš„è‡ªç”±ã€‚éœ€è¦å­¸ç¿’åœ¨è‡ªç™¼æ€§èˆ‡è¨ˆåŠƒæ€§ä¹‹é–“æ‰¾åˆ°å¹³è¡¡ï¼Œå…±åŒäº«å—æ—…ç¨‹è€Œéåƒ…åƒ…å°ˆæ³¨æ–¼çµæœã€‚' } },
             1: { 1: { score: 85, type: 'é›™é‡æ„å¿—åŠ›', desc: 'å…©å€‹1è™Ÿé­”è¡“å¸«ç›¸é‡ï¼Œä»£è¡¨è‘—æ„å¿—åŠ›ã€å‰µé€ åŠ›å’Œè¡Œå‹•åŠ›çš„å¼·å¼·çµåˆã€‚é€™æ˜¯ä¸€æ®µå……æ»¿æ´»åŠ›å’Œå‰µæ–°æ½›èƒ½çš„é—œä¿‚ï¼Œé›™æ–¹éƒ½æ“æœ‰å°‡æƒ³æ³•åŒ–ç‚ºç¾å¯¦çš„å¼·å¤§èƒ½åŠ›ï¼Œèƒ½å¤ å…±åŒç™¼èµ·ä¸¦æ¨å‹•é …ç›®ï¼Œå¿«é€Ÿå–å¾—é€²å±•ã€‚', challenges: 'ä¸»è¦çš„æŒ‘æˆ°åœ¨æ–¼ã€Œèª°ä¾†ä¸»å°ï¼Ÿã€ã€‚å…©å€‹å¼·å‹¢çš„å€‹é«”å¯èƒ½ç”¢ç”Ÿæ¬ŠåŠ›é¬¥çˆ­æˆ–ç«¶çˆ­ã€‚éœ€è¦æœ‰æ„è­˜åœ°å”èª¿ç›®æ¨™ï¼Œé¿å…è‡ªæˆ‘ä¸­å¿ƒï¼Œä¸¦å­¸æœƒè¼ªæµé ˜å°æˆ–å…±åŒåˆä½œã€‚å¦‚æœæºé€šä¸è‰¯æˆ–ç¼ºä¹å…±åŒé¡˜æ™¯ï¼Œå¼·å¤§çš„èƒ½é‡å¯èƒ½æœƒè½‰å‘å…§éƒ¨è¡çªï¼Œè€Œéå¤–éƒ¨å‰µé€ ã€‚' }, 2: { score: 75, type: 'è¡Œå‹•èˆ‡ç›´è¦º', desc: 'é­”è¡“å¸«çš„è¡Œå‹•åŠ›èˆ‡å¥³ç¥­å¸çš„ç›´è¦ºæ´å¯Ÿå½¢æˆäº’è£œã€‚é­”è¡“å¸«èƒ½å°‡å¥³ç¥­å¸çš„æ·±å±¤æ™ºæ…§åŒ–ç‚ºå¯¦éš›è¡Œå‹•ï¼Œè€Œå¥³ç¥­å¸å‰‡èƒ½ç‚ºé­”è¡“å¸«æä¾›æ–¹å‘èˆ‡æ·±åº¦ã€‚', challenges: 'é­”è¡“å¸«å¯èƒ½è¦ºå¾—å¥³ç¥­å¸éæ–¼è¢«å‹•æˆ–ç¥ç§˜ï¼Œå¥³ç¥­å¸å¯èƒ½è¦ºå¾—é­”è¡“å¸«å¤ªæ€¥èºæˆ–è¡¨é¢ã€‚éœ€è¦è€å¿ƒæºé€šï¼Œé­”è¡“å¸«å­¸ç¿’è†è½ï¼Œå¥³ç¥­å¸å­¸ç¿’è¡¨é”ã€‚' }, 3: { score: 80, type: 'å‰µé€ èˆ‡è±ç››', desc: 'é­”è¡“å¸«çš„å‰µé€ æ„å¿—èˆ‡å¥³å¸çš„è±é¥’èƒ½é‡çµåˆï¼Œèƒ½å…±åŒå‰µé€ å‡ºå¯¦è³ªä¸”ç¾å¥½çš„æˆæœã€‚é­”è¡“å¸«æä¾›æ–¹æ³•ï¼Œå¥³å¸æä¾›æ»‹é¤Šèˆ‡è³‡æºã€‚', challenges: 'é­”è¡“å¸«çš„ç›®æ¨™å°å‘å¯èƒ½èˆ‡å¥³å¸çš„äº«å—éç¨‹ç”¢ç”Ÿè¡çªã€‚éœ€å¹³è¡¡æ•ˆç‡èˆ‡äº«å—ï¼Œä¸¦ç¢ºä¿å‰µé€ çš„ç›®æ¨™æ˜¯é›™æ–¹éƒ½èªåŒçš„ã€‚' }, 4: { score: 70, type: 'æ„å¿—èˆ‡çµæ§‹', desc: 'é­”è¡“å¸«çš„å‰µæ–°èƒ½åŠ›èˆ‡çš‡å¸çš„çµ„ç¹”çµæ§‹ç›¸è¼”ç›¸æˆã€‚é­”è¡“å¸«å¸¶ä¾†æ–°é»å­ï¼Œçš‡å¸å‰‡èƒ½å°‡å…¶å¯¦ç¾ä¸¦åˆ¶åº¦åŒ–ï¼Œå»ºç«‹ç©©å›ºçš„åŸºç¤ã€‚', challenges: 'é­”è¡“å¸«å¯èƒ½è¦ºå¾—çš‡å¸éæ–¼åƒµåŒ–ï¼Œçš‡å¸å¯èƒ½è¦ºå¾—é­”è¡“å¸«ä¸åˆ‡å¯¦éš›ã€‚éœ€è¦äº’ç›¸å°Šé‡å°æ–¹çš„æ–¹æ³•ï¼Œé­”è¡“å¸«å­¸ç¿’å‹™å¯¦ï¼Œçš‡å¸å­¸ç¿’å½ˆæ€§ã€‚' }, 5: { score: 65, type: 'å‰µæ–°èˆ‡å‚³çµ±', desc: 'é­”è¡“å¸«çš„å€‹é«”å‰µé€ åŠ›èˆ‡æ•™çš‡çš„å‚³çµ±æ™ºæ…§å½¢æˆæœ‰è¶£çš„å°è©±ã€‚é­”è¡“å¸«æŒ‘æˆ°ç¾ç‹€ï¼Œæ•™çš‡æä¾›ç¶“é©—èˆ‡é“å¾·æ¡†æ¶ã€‚', challenges: 'å¯èƒ½åœ¨æ–¹æ³•è«–å’Œåƒ¹å€¼è§€ä¸Šç”¢ç”Ÿåˆ†æ­§ã€‚é­”è¡“å¸«éœ€è¦å°Šé‡æ™ºæ…§å‚³æ‰¿ï¼Œæ•™çš‡éœ€è¦å°æ–°æ–¹æ³•ä¿æŒé–‹æ”¾ï¼Œå°‹æ‰¾èåˆé»è€Œéå°ç«‹ã€‚' }, 6: {score:90,type:'å‰µé€ æ€§çš„æ„›',desc:'é­”è¡“å¸«çš„å‰µé€ åŠ›åœ¨æˆ€äººç‰Œä»£è¡¨çš„æ„›èˆ‡é—œä¿‚ä¸­èƒ½å¾—åˆ°æ¥µå¤§çš„æ»‹é¤Šèˆ‡ç™¼æ®ã€‚ä»–å€‘å…±åŒåšå‡ºé¸æ“‡ï¼Œå‰µé€ å……æ»¿æ´»åŠ›èˆ‡å’Œè«§çš„é—œä¿‚ï¼Œå½¼æ­¤æ¿€å‹µã€‚', challenges:'é­”è¡“å¸«çš„å€‹äººæ„å¿—å¯èƒ½åœ¨é—œä¿‚é¸æ“‡ä¸­éæ–¼å¼·å‹¢ï¼Œæˆ–æˆ€äººç‰Œçš„çŒ¶è±«ä¸æ±ºè®“é­”è¡“å¸«å¤±å»è€å¿ƒã€‚éœ€è¦å¦èª æºé€šå„è‡ªçš„éœ€æ±‚èˆ‡åƒ¹å€¼è§€ï¼Œç¢ºä¿é¸æ“‡æ˜¯å…±åŒçš„ã€‚'}, 7: {score:85,type:'æ„å¿—çš„æ¨é€²åŠ›',desc:'é­”è¡“å¸«çš„æ„å¿—èˆ‡æˆ°è»Šçš„æ±ºå¿ƒçµåˆï¼Œå½¢æˆä¸€è‚¡å¼·å¤§çš„å‰é€²å‹•åŠ›ã€‚ä»–å€‘èƒ½å…±åŒè¨­å®šç›®æ¨™ä¸¦å‹‡å¾€ç›´å‰ï¼Œå…‹æœéšœç¤™ï¼Œå–å¾—æˆåŠŸã€‚', challenges:'å…©è€…éƒ½éå¸¸å¼·å‹¢ï¼Œè‹¥æ–¹å‘ä¸ä¸€è‡´ï¼Œå¾ˆå®¹æ˜“ç”¢ç”Ÿè¡çªæˆ–ç«¶çˆ­ã€‚éœ€è¦æ˜ç¢ºçš„å…±åŒç›®æ¨™ï¼Œä¸¦å­¸æœƒå”èª¿æ­¥ä¼ï¼Œé¿å…ä¸€æ–¹æ‹–å®å¦ä¸€æ–¹ã€‚'}, 8: {score:80,type:'æ„å¿—èˆ‡å…§åŠ›',desc:'é­”è¡“å¸«çš„å¤–åœ¨é¡¯åŒ–èƒ½åŠ›èˆ‡åŠ›é‡ç‰Œçš„å…§åœ¨å …éŸŒç›¸çµåˆï¼Œèƒ½ä»¥ä¸€ç¨®å¹³è¡¡çš„æ–¹å¼é”æˆç›®æ¨™ã€‚é­”è¡“å¸«å¸¶ä¾†æ–¹æ³•ï¼ŒåŠ›é‡ç‰Œå¸¶ä¾†è€å¿ƒèˆ‡æ…ˆæ‚²ã€‚', challenges:'é­”è¡“å¸«çš„æ€¥åˆ‡å¯èƒ½èˆ‡åŠ›é‡ç‰Œçš„å¾ç·©ç”¢ç”Ÿæ‘©æ“¦ã€‚é­”è¡“å¸«éœ€å­¸ç¿’å…§åœ¨åŠ›é‡çš„æŸ”éŸŒï¼ŒåŠ›é‡ç‰Œéœ€å­¸ç¿’æ›´ä¸»å‹•åœ°é‹ç”¨èƒ½åŠ›ã€‚'}, 9: {score:60,type:'è¡Œå‹•èˆ‡å…§çœ',desc:'é­”è¡“å¸«çš„å¤–å‘è¡Œå‹•èˆ‡éš±å£«çš„å…§å‘åæ€å½¢æˆé®®æ˜å°æ¯”ï¼Œä½†ä¹Ÿå¯èƒ½äº’è£œã€‚éš±å£«çš„æ™ºæ…§èƒ½æŒ‡å¼•é­”è¡“å¸«çš„è¡Œå‹•ï¼Œé­”è¡“å¸«èƒ½å°‡éš±å£«çš„æ´è¦‹ä»˜è«¸å¯¦è¸ã€‚', challenges:'ç”Ÿæ´»ç¯€å¥å’Œæºé€šæ–¹å¼å·®ç•°å¤§ã€‚é­”è¡“å¸«å¯èƒ½è¦ºå¾—éš±å£«å¤ªå­¤åƒ»ï¼Œéš±å£«å¯èƒ½è¦ºå¾—é­”è¡“å¸«å¤ªå–§å›‚ã€‚éœ€è¦å°Šé‡å½¼æ­¤çš„ç©ºé–“èˆ‡éœ€æ±‚ã€‚'}, 10:{score:85,type:'å‰µé€ æ©Ÿé‡',desc:'é­”è¡“å¸«çš„é¡¯åŒ–èƒ½åŠ›èˆ‡å‘½é‹ä¹‹è¼ªçš„æ©Ÿé‡å®Œç¾çµåˆã€‚é­”è¡“å¸«èƒ½ä¸»å‹•å‰µé€ ä¸¦æŠ“ä½å‘½é‹ä¹‹è¼ªå¸¶ä¾†çš„æ©Ÿæœƒï¼Œå…±åŒé§•é¦­ç”Ÿå‘½çš„æµå‹•ã€‚', challenges:'é­”è¡“å¸«å¯èƒ½è©¦åœ–æŒæ§å‘½é‹ä¹‹è¼ªçš„ä¸å¯é æ¸¬æ€§ï¼Œè€Œå‘½é‹ä¹‹è¼ªçš„è®ŠåŒ–å¯èƒ½æ‰“äº‚é­”è¡“å¸«çš„è¨ˆåŠƒã€‚å­¸ç¿’åœ¨è®ŠåŒ–ä¸­ä¿æŒå½ˆæ€§èˆ‡ä¿¡ä»»æ˜¯é—œéµã€‚'}, 11:{score:70,type:'æ„å¿—èˆ‡å…¬æ­£',desc:'é­”è¡“å¸«çš„è¡Œå‹•åŠ›éœ€è¦æ­£ç¾©ç‰Œçš„æ¸…æ™°åˆ¤æ–·èˆ‡å¹³è¡¡ã€‚æ­£ç¾©èƒ½ç¢ºä¿é­”è¡“å¸«çš„å‰µé€ æ˜¯åŸºæ–¼å…¬å¹³å’ŒçœŸç†çš„ã€‚', challenges:'é­”è¡“å¸«çš„éˆæ´»æ€§å¯èƒ½èˆ‡æ­£ç¾©çš„åŸå‰‡æ€§ç”¢ç”Ÿè¡çªã€‚æ­£ç¾©çš„åš´è¬¹å¯èƒ½è®“é­”è¡“å¸«æ„Ÿåˆ°å—é™ã€‚éœ€è¦æ‰¾åˆ°åŸå‰‡èˆ‡å½ˆæ€§çš„å¹³è¡¡é»ã€‚'}, 12:{score:65,type:'è¡Œå‹•èˆ‡è‡£æœ',desc:'é­”è¡“å¸«çš„ä¸»å‹•å‰µé€ èˆ‡å€’åŠäººçš„è¢«å‹•è‡£æœå½¢æˆå¼·çƒˆå°æ¯”ã€‚å€’åŠäººçš„æ–°è¦–è§’å¯ä»¥å•Ÿç™¼é­”è¡“å¸«ï¼Œé­”è¡“å¸«å¯ä»¥å¹«åŠ©å€’åŠäººèµ°å‡ºåœæ»¯ã€‚', challenges:'é­”è¡“å¸«å¯èƒ½ä¸ç†è§£å€’åŠäººçš„ã€Œç„¡ç‚ºã€ï¼Œå€’åŠäººå¯èƒ½æŠ—æ‹’é­”è¡“å¸«çš„å‚¬ä¿ƒã€‚å­¸ç¿’åœ¨é©ç•¶çš„æ™‚å€™è¡Œå‹•ï¼Œåœ¨é©ç•¶çš„æ™‚å€™ç­‰å¾…èˆ‡åæ€ã€‚'}, 13:{score:75,type:'å‰µé€ èˆ‡è½‰åŒ–',desc:'é­”è¡“å¸«çš„å‰µé€ åŠ›èˆ‡æ­»ç¥çš„è½‰åŒ–åŠ›é‡çµåˆï¼Œèƒ½å¸¶ä¾†æ·±åˆ»çš„æ”¹è®Šèˆ‡æ–°ç”Ÿã€‚ä»–å€‘èƒ½å…±åŒçµæŸèˆŠæ¨¡å¼ï¼Œé–‹å‰µæ–°å±€é¢ã€‚', challenges:'é­”è¡“å¸«å¯èƒ½å®³æ€•æ­»ç¥å¸¶ä¾†çš„å¾¹åº•æ”¹è®Šï¼Œæ­»ç¥çš„ç›´æ¥å¯èƒ½è®“é­”è¡“å¸«æ„Ÿåˆ°å¤±æ§ã€‚éœ€è¦å‹‡æ°£å»é¢å°çµæŸï¼Œä¸¦ä¿¡ä»»ä¹‹å¾Œçš„æ–°ç”Ÿã€‚'}, 14:{score:80,type:'é¡¯åŒ–èˆ‡èª¿å’Œ',desc:'é­”è¡“å¸«çš„é¡¯åŒ–èƒ½åŠ›èˆ‡ç¯€åˆ¶ç‰Œçš„èª¿å’Œè—è¡“èƒ½å‰µé€ å‡ºå¹³è¡¡ä¸”æŒä¹…çš„æˆæœã€‚ä»–å€‘å–„æ–¼æ•´åˆä¸åŒå…ƒç´ ï¼Œå‰µé€ å’Œè«§ã€‚', challenges:'é­”è¡“å¸«çš„å°ˆæ³¨ç›®æ¨™å¯èƒ½èˆ‡ç¯€åˆ¶çš„å°‹æ±‚å¤šæ–¹å¹³è¡¡æœ‰æ‰€ä¸åŒã€‚éœ€è¦è€å¿ƒå”å•†ï¼Œç¢ºä¿è¡Œå‹•æ—¢æœ‰æ•ˆç‡åˆå…·åŒ…å®¹æ€§ã€‚'}, 15:{score:70,type:'æ„å¿—èˆ‡æ…¾æœ›',desc:'é­”è¡“å¸«çš„æ„å¿—åŠ›èˆ‡æƒ¡é­”ç‰Œçš„åŸå§‹æ…¾æœ›ç›¸é‡ï¼Œå¯èƒ½çˆ†ç™¼å¼·å¤§çš„å‰µé€ åŠ›ï¼Œä¹Ÿå¯èƒ½é™·å…¥æŸç¸›ã€‚é—œéµåœ¨æ–¼å¦‚ä½•å¼•å°é€™è‚¡èƒ½é‡ã€‚', challenges:'æƒ¡é­”çš„èª˜æƒ‘å¯èƒ½è®“é­”è¡“å¸«èª¤ç”¨èƒ½åŠ›ï¼Œæˆ–é›™æ–¹é™·å…¥ä¸å¥åº·çš„ä¾è³´ã€‚éœ€è¦é«˜åº¦çš„è‡ªæˆ‘è¦ºå¯Ÿï¼Œå°‡æ¿€æƒ…å°å‘æ­£é¢ï¼Œé¿å…æ²‰æººã€‚'}, 16:{score:75,type:'å‰µé€ æ€§çªç ´',desc:'é­”è¡“å¸«çš„å‰µé€ åŠ›èˆ‡å¡”çš„é¡›è¦†æ€§èƒ½é‡çµåˆï¼Œèƒ½å¸¶ä¾†é©å‘½æ€§çš„çªç ´å’ŒèˆŠæœ‰çµæ§‹çš„ç“¦è§£ï¼Œç‚ºæ–°äº‹ç‰©é¨°å‡ºç©ºé–“ã€‚', challenges:'å¡”çš„çªè®Šå¯èƒ½æ‰“äº‚é­”è¡“å¸«çš„è¨ˆåŠƒï¼Œç”šè‡³æ‘§æ¯€å…¶æˆæœã€‚é­”è¡“å¸«éœ€å­¸æœƒåœ¨æ··äº‚ä¸­ä¿æŒå½ˆæ€§ï¼Œä¸¦å°‡å±æ©Ÿè¦–ç‚ºé‡å»ºçš„æ©Ÿæœƒã€‚'}, 17:{score:85,type:'é¡¯åŒ–å¸Œæœ›',desc:'é­”è¡“å¸«çš„å¯¦ç¾èƒ½åŠ›èˆ‡æ˜Ÿæ˜Ÿçš„å¸Œæœ›éˆæ„Ÿç›¸çµåˆï¼Œèƒ½å°‡ç¾å¥½çš„é¡˜æ™¯åŒ–ç‚ºç¾å¯¦ï¼Œç‚ºè‡ªå·±å’Œä»–äººå¸¶ä¾†å…‰æ˜ã€‚', challenges:'æ˜Ÿæ˜Ÿçš„ç†æƒ³ä¸»ç¾©å¯èƒ½è®“é­”è¡“å¸«çš„å¯¦éš›æ“ä½œé‡åˆ°å›°é›£ã€‚éœ€è¦å¹³è¡¡å¤¢æƒ³èˆ‡ç¾å¯¦ï¼Œå°‡å¸Œæœ›è½å¯¦æ–¼å…·é«”è¡Œå‹•ã€‚'}, 18:{score:70,type:'æ„è­˜èˆ‡æ½›æ„è­˜',desc:'é­”è¡“å¸«çš„æ¸…æ™°æ„è­˜èˆ‡æœˆäº®çš„æ¨¡ç³Šæ½›æ„è­˜ç›¸é‡ï¼Œæ˜¯ä¸€å ´æ¢ç´¢å…§åœ¨è¿·éœ§çš„æ—…ç¨‹ã€‚æœˆäº®çš„ç›´è¦ºèƒ½è±å¯Œé­”è¡“å¸«çš„å‰µé€ ï¼Œé­”è¡“å¸«çš„ç†æ€§æœ‰åŠ©æ–¼é‡æ¸…å¹»è±¡ã€‚', challenges:'æœˆäº®çš„å¹»è±¡å’Œææ‡¼å¯èƒ½å¹²æ“¾é­”è¡“å¸«çš„å°ˆæ³¨åŠ›ã€‚é­”è¡“å¸«çš„é‚è¼¯å¯èƒ½é›£ä»¥ç†è§£æœˆäº®çš„éç†æ€§ã€‚éœ€è¦ä¿¡ä»»ç›´è¦ºï¼ŒåŒæ™‚ä¿æŒåˆ†è¾¨èƒ½åŠ›ã€‚'}, 19:{score:90,type:'å…‰è¼å‰µé€ ',desc:'é­”è¡“å¸«çš„å‰µé€ åŠ›åœ¨å¤ªé™½çš„å…‰æ˜ç…§è€€ä¸‹å¾—ä»¥å……åˆ†å±•ç¾ã€‚ä»–å€‘èƒ½å…±åŒå‰µé€ å……æ»¿å–œæ‚…ã€æˆåŠŸå’Œæ´»åŠ›çš„æˆæœï¼Œæ•£ç™¼æ­£èƒ½é‡ã€‚', challenges:'å…©è€…éƒ½å¯èƒ½æ¯”è¼ƒè‡ªæˆ‘ä¸­å¿ƒã€‚é­”è¡“å¸«éœ€è¦ç¢ºä¿å…¶å‰µé€ æœå‹™æ–¼å¤ªé™½çš„æ•´é«”ç¦ç¥‰ï¼Œå¤ªé™½çš„å¼·å…‰ä¸è¦ç¼å‚·é­”è¡“å¸«çš„å€‹åˆ¥æ€§ã€‚'}, 20:{score:80,type:'æ„å¿—çš„è¦ºé†’',desc:'é­”è¡“å¸«çš„é¡¯åŒ–èƒ½åŠ›èˆ‡å¯©åˆ¤çš„è¦ºé†’å¬å–šçµåˆï¼Œèƒ½å…±åŒéŸ¿æ‡‰ç”Ÿå‘½çš„æ›´é«˜ç›®çš„ï¼Œå¯¦ç¾æ·±åˆ»çš„è½‰åŒ–å’Œäººç”Ÿç›®æ¨™çš„é‡æ–°å®šç¾©ã€‚', challenges:'å¯©åˆ¤çš„è‡ªæˆ‘è©•ä¼°å¯èƒ½è®“é­”è¡“å¸«å°éå»çš„å‰µé€ ç”¢ç”Ÿæ‡·ç–‘ã€‚é­”è¡“å¸«éœ€è¦å°‡å…¶èƒ½åŠ›å°å‘æ–°çš„ã€æ›´æœ‰æ„ç¾©çš„æ–¹å‘ï¼Œè€ŒéåŸ·è‘—èˆŠæœ‰ã€‚'}, 21:{score:85,type:'å®Œæˆçš„å‰µé€ ',desc:'é­”è¡“å¸«çš„å‰µé€ åŠ›èˆ‡ä¸–ç•Œçš„åœ“æ»¿é”æˆç›¸è¼”ç›¸æˆã€‚ä»–å€‘èƒ½å°‡ç†å¿µå®Œç¾åœ°å¯¦ç¾ï¼Œé«”é©—åˆ°æˆå°±æ„Ÿå’Œå®‡å®™çš„åˆä¸€ã€‚', challenges:'ä¸–ç•Œç‰Œçš„å®Œæˆæ„Ÿå¯èƒ½è®“é­”è¡“å¸«æ„Ÿåˆ°ä¸‹ä¸€æ­¥ç„¡äº‹å¯åšã€‚éœ€è¦ç†è§£å®Œæˆä¹Ÿæ˜¯æ–°å¾ªç’°çš„é–‹å§‹ï¼Œé­”è¡“å¸«çš„å‰µé€ åŠ›æ°¸ç„¡æ­¢å¢ƒã€‚'}},
             2: { 2: { score: 85, type: 'æ·±å±¤éˆé­‚é€£çµ', desc: 'å…©ä½å¥³ç¥­å¸ç›¸é‡ï¼Œä»£è¡¨ç›´è¦ºã€æ½›æ„è­˜æ™ºæ…§èˆ‡å…§åœ¨ä¸–ç•Œçš„æ·±åº¦å…±é³´ã€‚é€™æ˜¯ä¸€æ®µå……æ»¿ç¥ç§˜æ„Ÿã€ç›¸äº’ç†è§£ä¸”ç„¡éœ€éå¤šè¨€èªçš„é€£çµã€‚å¥¹å€‘èƒ½å…±åŒæ¢ç´¢éˆæ€§å¥§ç§˜ï¼Œåˆ†äº«æ·±é‚ƒçš„æ´è¦‹ã€‚', challenges: 'é—œä¿‚å¯èƒ½éæ–¼å…§å‘ã€è¢«å‹•ï¼Œç¼ºä¹åœ¨ç¾å¯¦ä¸–ç•Œçš„å…·é«”è¡Œå‹•ã€‚é›™æ–¹éƒ½å¯èƒ½å£“æŠ‘æƒ…æ„Ÿï¼Œä¸é¡˜ç›´æ¥æºé€šã€‚éœ€è¦é¼“å‹µå½¼æ­¤å°‡å…§åœ¨æ™ºæ…§è¡¨é”å‡ºä¾†ï¼Œä¸¦ç©æ¥µåƒèˆ‡å¤–éƒ¨ä¸–ç•Œï¼Œé¿å…é™·å…¥å­¤ç«‹æˆ–éåº¦æ²‰æ€ã€‚' }, 3: { score: 80, type: 'ç›´è¦ºæ»‹é¤Šå‰µé€ ', desc: 'å¥³ç¥­å¸çš„ç›´è¦ºæ™ºæ…§èˆ‡å¥³å¸çš„è±ç››å‰µé€ åŠ›å½¢æˆå¼·å¤§çš„é™°æ€§åŠ›é‡çµåˆã€‚å¥³ç¥­å¸æä¾›éˆæ„Ÿèˆ‡æ–¹å‘ï¼Œå¥³å¸å‰‡å°‡å…¶å¯¦ç¾ä¸¦æ»‹é¤Šï¼Œå…±åŒå‰µé€ å……æ»¿æ„›èˆ‡ç¾çš„æˆæœã€‚', challenges: 'å¥³ç¥­å¸çš„éœé»˜å¯èƒ½èˆ‡å¥³å¸çš„ç†±æƒ…å¤–æ”¾ç”¢ç”Ÿæ­¥èª¿ä¸ä¸€ã€‚å¥³å¸å¯èƒ½è¦ºå¾—å¥³ç¥­å¸ä¸å¤ æŠ•å…¥ç‰©è³ªå±¤é¢ï¼Œå¥³ç¥­å¸å¯èƒ½è¦ºå¾—å¥³å¸ä¸å¤ æ·±åˆ»ã€‚éœ€æ¬£è³å½¼æ­¤çš„è²¢ç»ï¼Œæ‰¾åˆ°å…§å¤–å¹³è¡¡ã€‚' }, }
          };

          const fullCompatibilityMatrix = useMemo(() => {
                const matrix = JSON.parse(JSON.stringify(baseCompatibilityMatrix));
                for (let i = 0; i <= 21; i++) {
                    if (!matrix[i]) matrix[i] = {};
                    for (let j = i; j <= 21; j++) {
                        if (!matrix[j]) matrix[j] = {};
                        if (!matrix[i][j] && !matrix[j][i]) {
                             const card1 = cardDetails[i];
                             const card2 = cardDetails[j];
                             if (!card1 || !card2) continue;
            
                             if (i === j) {
                                matrix[i][j] = {
                                  score: 80,
                                  type: `åŒé »å…±æŒ¯ (${card1.name})`,
                                  desc: `å…©å€‹ ${card1.name} ç›¸é‡ï¼Œé—œæ–¼ã€Œ${card1.shortMeaning}ã€çš„èƒ½é‡æœƒè¢«é›™å€æ”¾å¤§ã€‚é€™å¸¶ä¾†æ·±åˆ»çš„ç†è§£èˆ‡å…±é³´ï¼Œèƒ½è¿…é€Ÿå»ºç«‹é€£çµï¼Œä½†ä¹Ÿå¯èƒ½è®“é›™æ–¹å…±åŒçš„ç›²é»è¢«å¿½è¦–ã€‚`,
                                  challenges: `ä¸»è¦æŒ‘æˆ°åœ¨æ–¼éœ€è¦æœ‰æ„è­˜åœ°è¦ºå¯Ÿä¸¦å¹³è¡¡ ${card1.name} èƒ½é‡çš„æ¥µç«¯è¡¨ç¾ã€‚ä¾‹å¦‚ï¼Œé›™æ–¹éƒ½å¯èƒ½é™·å…¥ã€${card1.challenges}ã€çš„å›°å¢ƒä¸­ï¼Œç¼ºä¹å¦ä¸€ç¨®è¦–è§’ä¾†æ‰“ç ´åƒµå±€ã€‚`
                                };
                             } else {
                                matrix[i][j] = {
                                  score: 70,
                                  type: `äº’è£œå­¸ç¿’ (${card1.name} & ${card2.name})`,
                                  desc: `${card1.name} æ‰€ä»£è¡¨çš„ã€Œ${card1.shortMeaning.split('ã€')[0]}ã€èƒ½é‡ï¼Œèˆ‡ ${card2.name} çš„ã€Œ${card2.shortMeaning.split('ã€')[0]}ã€ä¸»é¡Œç›¸é‡ï¼Œå‰µé€ äº†å¯¶è²´çš„å­¸ç¿’èˆ‡æˆé•·æ©Ÿæœƒã€‚ä¸€æ–¹çš„å„ªé»å¯ä»¥å½Œè£œå¦ä¸€æ–¹çš„ä¸è¶³ã€‚`,
                                  challenges: `é›™æ–¹éœ€è¦ç†è§£ä¸¦å°Šé‡å½¼æ­¤æœ¬è³ªä¸Šçš„å·®ç•°ã€‚${card1.name}çš„æ½›åœ¨æŒ‘æˆ° (${card1.challenges.split('ã€‚')[0]}) å¯èƒ½èˆ‡ ${card2.name} çš„æŒ‘æˆ° (${card2.challenges.split('ã€‚')[0]}) ç›¸äº’ä½œç”¨ï¼Œéœ€è¦è€å¿ƒåœ°æºé€šå’Œç£¨åˆã€‚`
                                };
                             }
                        }
                    }
                }
                return matrix;
          }, []);

          const getCardName = (id) => cardDetails[id]?.name || 'æœªçŸ¥å¡ç‰Œ';

          const getCompatibility = (card1, card2) => {
            if (card1 === null || card2 === null) return { score: 0, type: 'è³‡è¨Šä¸è¶³', desc: 'ç„¡æ³•è¨ˆç®—ï¼Œå› ç‚ºç¼ºå°‘ä¸€æ–¹æˆ–é›™æ–¹çš„ç‰Œå¡è³‡è¨Šã€‚', challenges: '' };
            
            let c1 = card1, c2 = card2;
            if (c1 > c2) [c1, c2] = [c2, c1];

            if (fullCompatibilityMatrix[c1] && fullCompatibilityMatrix[c1][c2]) {
              return fullCompatibilityMatrix[c1][c2];
            }
            if (fullCompatibilityMatrix[c2] && fullCompatibilityMatrix[c2][c1]) {
                return fullCompatibilityMatrix[c2][c1];
            }
            
            return { score: 50, type: 'ä¸­æ€§é—œä¿‚', desc: 'é€™æ˜¯ä¸€æ®µå……æ»¿æœªçŸ¥èˆ‡æ¢ç´¢ç©ºé–“çš„é—œä¿‚ã€‚', challenges: 'ç¼ºä¹å¤©ç„¶çš„å¼·çƒˆå…±é³´æˆ–æ˜é¡¯çš„äº’è£œæ€§ï¼Œéœ€è¦æ›´å¤šæœ‰æ„è­˜çš„æºé€šä¾†å»ºç«‹æ·±å±¤é€£çµã€‚' };
          };

          const getOverallCompatibility = (soulComp, personalityComp, challengeComp) => {
            if (!soulComp || !personalityComp || !challengeComp) return { avgScore: 0, level: 'ç„¡æ³•è©•ä¼°', advice: 'æ•¸æ“šä¸è¶³ï¼Œç„¡æ³•ç”Ÿæˆç¶œåˆå»ºè­°ã€‚'};
            const avgScore = (soulComp.score * 0.4) + (personalityComp.score * 0.4) + (challengeComp.score * 0.2);
            let level, advice;
            if (avgScore >= 85) { level = 'ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ éˆé­‚é«˜åº¦å…±é³´'; advice = 'ä½ å€‘åœ¨å¤šå€‹å±¤é¢æœ‰è‘—æ·±åˆ»çš„éˆé­‚é€£çµå’Œé«˜åº¦å¥‘åˆï¼Œå½¼æ­¤èƒ½å¤ æ·±åº¦ç†è§£ã€æ”¯æŒèˆ‡å•Ÿç™¼ã€‚é€™æ˜¯ä¸€æ®µå…·æœ‰å·¨å¤§å…±åŒé€²åŒ–æ½›åŠ›çš„é—œä¿‚ï¼Œå…±åŒæ¢ç´¢ç”Ÿå‘½çš„å¥§ç§˜ã€‚'; }
            else if (avgScore >= 75) { level = 'ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ é«˜åº¦å¿ƒéˆå¥‘åˆ'; advice = 'ä½ å€‘åœ¨æ ¸å¿ƒåƒ¹å€¼èˆ‡ç”Ÿå‘½ç›®æ¨™ä¸Šæœ‰è‰¯å¥½çš„å…±é³´ï¼Œå€‹æ€§ä¸Šä¹Ÿèƒ½ç›¸äº’æ¬£è³ã€‚é€éå¦èª æºé€šèˆ‡å…±åŒå­¸ç¿’ï¼Œå¯ä»¥é”åˆ°æ›´æ·±çš„è¦ªå¯†èˆ‡ç†è§£ï¼Œæ˜¯ä¸€æ®µèƒ½å¸¶ä¾†å–œæ‚…èˆ‡æˆé•·çš„é—œä¿‚ã€‚'; }
            else if (avgScore >= 65) { level = 'ğŸŒŸğŸŒŸğŸŒŸ äº’è£œæˆé•·å¤¥ä¼´'; advice = 'ä½ å€‘çš„å·®ç•°å¯ä»¥æˆç‚ºå½¼æ­¤æˆé•·çš„å‚¬åŒ–åŠ‘å’Œå­¸ç¿’çš„é¡å­ã€‚é—œä¿‚ä¸­å¯èƒ½å­˜åœ¨ä¸€äº›æŒ‘æˆ°ï¼Œä½†åªè¦ä¿æŒé–‹æ”¾ã€å°Šé‡èˆ‡ç†è§£ï¼Œå°±èƒ½å°‡å·®ç•°è½‰åŒ–ç‚ºäº’è£œçš„å„ªå‹¢ï¼Œå…±åŒé€²æ­¥ã€‚'; }
            else if (avgScore >= 55) { level = 'ğŸŒŸğŸŒŸ å­¸ç¿’å‹æŒ‘æˆ°é—œä¿‚'; advice = 'é€™æ®µé—œä¿‚ä¸­ï¼ŒæŒ‘æˆ°èˆ‡æ©Ÿé‡ä¸¦å­˜ã€‚ä½ å€‘çš„ç›¸é‡æ˜¯ç‚ºäº†å­¸ç¿’é‡è¦çš„äººç”Ÿèª²é¡Œï¼Œå¯èƒ½éœ€è¦æ›´å¤šçš„åŠªåŠ›ã€è€å¿ƒå’Œæœ‰æ„è­˜çš„æºé€šä¾†åŒ–è§£æ‘©æ“¦ã€‚è‹¥èƒ½å…±åŒå…‹æœï¼Œå°‡å¸¶ä¾†æ·±åˆ»çš„å€‹äººæˆé•·ã€‚'; }
            else { level = 'ğŸŒŸ æ·±å±¤èª²é¡Œæ¢ç´¢'; advice = 'ä½ å€‘çš„é€£çµè§¸åŠäº†è¼ƒæ·±çš„ç”Ÿå‘½èª²é¡Œæˆ–éå¾€æ¨¡å¼ã€‚é—œä¿‚å¯èƒ½æ„Ÿè¦ºè¤‡é›œï¼Œéœ€è¦æ¥µå¤§çš„è€å¿ƒã€æ…ˆæ‚²å’Œè‡ªæˆ‘åæ€ã€‚é€™æ˜¯ä¸€æ®µæ½›åŠ›å·¨å¤§çš„éˆé­‚åŠŸèª²ï¼Œé‡é»åœ¨æ–¼è‡ªæˆ‘è¦ºå¯Ÿèˆ‡è½‰åŒ–ï¼Œè€Œéåƒ…åƒ…æ˜¯é—œä¿‚çš„å’Œè«§ã€‚'; }
            return { avgScore: Math.round(avgScore), level, advice };
          };

          const handleAnalyze = () => {
            if (!person1Date || !person2Date) { alert('è«‹å¡«å¯«å…©ä½å¤¥ä¼´çš„å‡ºç”Ÿæ—¥æœŸ'); return; }
            if (!person1Name || !person2Name) { alert('è«‹å¡«å¯«å…©ä½å¤¥ä¼´çš„å§“å/æš±ç¨±'); return; }
            
            const person1Cards = sharedCalculateBirthCards(person1Date);
            const person2Cards = sharedCalculateBirthCards(person2Date);
            
            const targetDate = new Date(targetYear, targetMonth - 1, 1);
            const person1FortuneCards = sharedCalculateFortuneCards(person1Date, targetDate);
            const person2FortuneCards = sharedCalculateFortuneCards(person2Date, targetDate);
            
            const soulCompatibility = getCompatibility(person1Cards.soulCard, person2Cards.soulCard);
            const personalityCompatibility = getCompatibility(person1Cards.personalityCard, person2Cards.personalityCard);
            const challengeCompatibility = getCompatibility(person1Cards.challengeCard, person2Cards.challengeCard); 
            const overall = getOverallCompatibility(soulCompatibility, personalityCompatibility, challengeCompatibility);

            const yearlyCompatibility = getCompatibility(person1FortuneCards.yearlyCard, person2FortuneCards.yearlyCard);
            const monthlyCompatibility = getCompatibility(person1FortuneCards.monthlyCard, person2FortuneCards.monthlyCard);

            setResult({ 
                person1: { name: person1Name, ...person1Cards, fortuneCards: person1FortuneCards }, 
                person2: { name: person2Name, ...person2Cards, fortuneCards: person2FortuneCards }, 
                compatibility: { soul: soulCompatibility, personality: personalityCompatibility, challenge: challengeCompatibility, yearly: yearlyCompatibility, monthly: monthlyCompatibility, overall },
                timeframe: { year: targetYear, month: targetMonth }
            });
            setShowDetails({ soul: false, personality: false, challenge: false, yearly: false, monthly: false });
          };

          const getScoreColor = (score) => { if (score >= 85) return 'text-green-600'; if (score >= 75) return 'text-blue-600'; if (score >= 65) return 'text-yellow-600'; if (score >=55) return 'text-orange-600'; return 'text-red-600'; };
          const getScoreBg = (score) => { if (score >= 85) return 'bg-green-100'; if (score >= 75) return 'bg-blue-100'; if (score >= 65) return 'bg-yellow-100'; if (score >=55) return 'bg-orange-100'; return 'bg-red-100'; };
          
          const CompatibilityItem = ({ itemKey, title, icon, cards, compatibilityInfo, infoText, isOpen, onToggle }) => (
            <div className="bg-white rounded-lg p-4 sm:p-6 shadow-md">
              <div className="flex flex-col sm:flex-row items-start sm:items-center justify-between cursor-pointer" onClick={onToggle}>
                <h3 className="font-semibold text-gray-800 flex items-center gap-2 mb-2 sm:mb-0 text-base sm:text-lg">{icon} {title}</h3>
                <div className="flex items-center gap-2 sm:gap-4 w-full sm:w-auto justify-end">
                    <span className={`text-xl sm:text-2xl font-bold ${getScoreColor(compatibilityInfo.score)}`}>{compatibilityInfo.score}%</span>
                    <span className={`px-2 py-1 sm:px-3 rounded-full text-xs sm:text-sm font-medium whitespace-nowrap ${getScoreBg(compatibilityInfo.score)} ${getScoreColor(compatibilityInfo.score)}`}>{compatibilityInfo.type}</span>
                    <span className="text-purple-600 text-xl">{isOpen ? <ChevronUp /> : <ChevronDown />}</span>
                </div>
              </div>
              {isOpen && (<div className="mt-4 pt-4 border-t animate-fade-in text-sm">
                  <div className="mb-3 p-3 bg-gray-50 rounded-md">
                    <p className="font-semibold text-gray-700">äº’å‹•ç‰Œçµ„ï¼š</p>
                    <div className="flex justify-center gap-4 my-3">
                      <div className="text-center">
                        <img src={sharedGetCardImagePath(cards[0])} alt={getCardName(cards[0])} className="w-16 h-24 object-cover rounded-md shadow-md border-2 border-white mx-auto" loading="lazy" width="64" height="96" />
                        <p className="text-xs mt-1">{getCardName(cards[0])}</p>
                      </div>
                      <HeartIcon className="text-red-500 text-2xl self-center" />
                      <div className="text-center">
                        <img src={sharedGetCardImagePath(cards[1])} alt={getCardName(cards[1])} className="w-16 h-24 object-cover rounded-md shadow-md border-2 border-white mx-auto" loading="lazy" width="64" height="96" />
                        <p className="text-xs mt-1">{getCardName(cards[1])}</p>
                      </div>
                    </div>
                    <p className="text-gray-600"> {getCardName(cards[0])} ({cards[0]}) <HeartIcon className="inline text-red-500 mx-1" /> {getCardName(cards[1])} ({cards[1]})</p>
                  </div>
                  <h5 className="font-semibold text-gray-700 mb-1">èƒ½é‡äº’å‹•æè¿°ï¼š</h5><p className="text-gray-600 mb-3 leading-relaxed">{compatibilityInfo.desc}</p>
                  <h5 className="font-semibold text-red-700 mb-1 flex items-center gap-1"><AlertCircleIcon className="w-4 h-4" /> æ½›åœ¨æŒ‘æˆ°èˆ‡æˆé•·é»ï¼š</h5><p className="text-red-600 bg-red-50 p-3 rounded-md mb-3 leading-relaxed">{compatibilityInfo.challenges || "å…±åŒæ¢ç´¢èˆ‡ç†è§£æ˜¯é—œéµã€‚"}</p>
                  {infoText && (<div className="mt-3 p-3 bg-indigo-50 rounded-lg border-l-4 border-indigo-400"><p className="text-sm text-indigo-700 flex items-start"><InfoIcon className="w-4 h-4 inline mr-2 mt-0.5 flex-shrink-0" /><span>{infoText}</span></p></div>)}
              </div>)}
            </div>
          );


          return (
            <div className="max-w-4xl mx-auto p-4 sm:p-6 bg-gradient-to-br from-purple-100 via-pink-100 to-indigo-100 rounded-xl shadow-xl font-sans">
              <div className="text-center mb-8"><h1 className="text-3xl font-bold text-purple-800 mb-2 flex items-center justify-center gap-2"><HeartIcon className="w-8 h-8" />å¡”ç¾…ç‰Œé›™äººå…¼å®¹æ€§æ·±åº¦åˆ†æ</h1><p className="text-gray-600">ä¾æ“šå¡”ç¾…åŸå‹äº’å‹•ï¼Œæ·±å…¥åˆ†æå…©äººçš„éˆé­‚å¥‘åˆåº¦ã€å€‹æ€§ç›¸å®¹æ€§èˆ‡å…±åŒæˆé•·æ½›åŠ›</p></div>
              
              <div className="bg-white rounded-lg p-6 shadow-md mb-6">
                <div className="grid md:grid-cols-2 gap-4 md:gap-x-6 md:gap-y-8">
                      <div className="space-y-3 md:space-y-4">
                          <h3 className="font-semibold text-gray-800 flex items-center gap-2"><UsersIcon className="w-5 h-5" /> ç¬¬ä¸€ä½å¤¥ä¼´</h3>
                          <input type="text" placeholder="å§“å/æš±ç¨±" value={person1Name} onChange={(e) => setPerson1Name(e.target.value)} className="w-full px-3 py-1.5 text-sm rounded-md border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent md:px-4 md:py-2"/>
                          <input type="date" value={person1Date} onChange={(e) => setPerson1Date(e.target.value)} className="w-full px-3 py-1.5 text-sm rounded-md border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent md:px-4 md:py-2"/>
                      </div>
                      <div className="space-y-3 md:space-y-4">
                          <h3 className="font-semibold text-gray-800 flex items-center gap-2"><UsersIcon className="w-5 h-5" /> ç¬¬äºŒä½å¤¥ä¼´</h3>
                          <input type="text" placeholder="å§“å/æš±ç¨±" value={person2Name} onChange={(e) => setPerson2Name(e.target.value)} className="w-full px-3 py-1.5 text-sm rounded-md border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent md:px-4 md:py-2"/>
                          <input type="date" value={person2Date} onChange={(e) => setPerson2Date(e.target.value)} className="w-full px-3 py-1.5 text-sm rounded-md border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent md:px-4 md:py-2"/>
                      </div>
                      <div className="md:col-span-2 border-t pt-4 md:pt-6">
                          <h3 className="font-semibold text-gray-800 mb-3 flex items-center gap-2"><ClockIcon/> é¸æ“‡åˆ†ææ™‚é»</h3>
                          <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                              <div>
                                  <label className="block text-sm font-medium text-gray-700 mb-0.5 sm:mb-1">å¹´ä»½</label>
                                  <input type="number" value={targetYear} onChange={(e) => setTargetYear(parseInt(e.target.value, 10) || new Date().getFullYear())} className="w-full px-3 py-1.5 text-sm rounded-md border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent md:px-4 md:py-2"/>
                              </div>
                              <div>
                                  <label className="block text-sm font-medium text-gray-700 mb-0.5 sm:mb-1">æœˆä»½</label>
                                  <select value={targetMonth} onChange={(e) => setTargetMonth(parseInt(e.target.value, 10))} className="w-full px-3 py-1.5 text-sm rounded-md border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent md:px-4 md:py-2 bg-white">
                                      {[...Array(12).keys()].map(i => <option key={i+1} value={i+1}>{i+1}æœˆ</option>)}
                                  </select>
                              </div>
                          </div>
                      </div>
                  </div>
                  <button onClick={handleAnalyze} className="w-full mt-4 py-2 text-sm bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-md hover:from-purple-700 hover:to-pink-700 transition-colors font-semibold md:mt-6 md:py-3"><Sparkles className="inline-block w-4 h-4 mr-1" /> åˆ†æå…¼å®¹æ€§ <Sparkles className="inline-block w-4 h-4 ml-1" /></button>
              </div>
              
              {result && (
                <div className="mt-8 space-y-6 animate-fade-in">
                  <div className="grid md:grid-cols-2 gap-6">
                    <div className="bg-white rounded-lg p-6 shadow-md">
                      <h3 className="font-semibold text-gray-800 mb-4">{result.person1.name}çš„ç”Ÿå‘½èˆ‡é‹å‹¢ç‰Œçµ„</h3>
                      <div className="space-y-2 text-sm">
                        <p><span className="font-medium text-purple-700">éˆé­‚ç‰Œï¼š</span>{result.person1.soulCard} - {getCardName(result.person1.soulCard)}</p>
                        <p><span className="font-medium text-pink-700">å€‹æ€§ç‰Œï¼š</span>{result.person1.personalityCard} - {getCardName(result.person1.personalityCard)}</p>
                        <p><span className="font-medium text-indigo-700">äº’è£œ/æŒ‘æˆ°ç‰Œ (22-Soul)ï¼š</span>{result.person1.challengeCard} - {getCardName(result.person1.challengeCard)}</p>
                        <hr className="my-2"/>
                        <p><span className="font-medium text-yellow-700">å¹´é‹ç‰Œ ({result.timeframe.year})ï¼š</span>{result.person1.fortuneCards.yearlyCard} - {getCardName(result.person1.fortuneCards.yearlyCard)}</p>
                        <p><span className="font-medium text-blue-700">æœˆé‹ç‰Œ ({result.timeframe.month}æœˆ)ï¼š</span>{result.person1.fortuneCards.monthlyCard} - {getCardName(result.person1.fortuneCards.monthlyCard)}</p>
                      </div>
                    </div>
                    <div className="bg-white rounded-lg p-6 shadow-md">
                      <h3 className="font-semibold text-gray-800 mb-4">{result.person2.name}çš„ç”Ÿå‘½èˆ‡é‹å‹¢ç‰Œçµ„</h3>
                      <div className="space-y-2 text-sm">
                        <p><span className="font-medium text-purple-700">éˆé­‚ç‰Œï¼š</span>{result.person2.soulCard} - {getCardName(result.person2.soulCard)}</p>
                        <p><span className="font-medium text-pink-700">å€‹æ€§ç‰Œï¼š</span>{result.person2.personalityCard} - {getCardName(result.person2.personalityCard)}</p>
                        <p><span className="font-medium text-indigo-700">äº’è£œ/æŒ‘æˆ°ç‰Œ (22-Soul)ï¼š</span>{result.person2.challengeCard} - {getCardName(result.person2.challengeCard)}</p>
                        <hr className="my-2"/>
                        <p><span className="font-medium text-yellow-700">å¹´é‹ç‰Œ ({result.timeframe.year})ï¼š</span>{result.person2.fortuneCards.yearlyCard} - {getCardName(result.person2.fortuneCards.yearlyCard)}</p>
                        <p><span className="font-medium text-blue-700">æœˆé‹ç‰Œ ({result.timeframe.month}æœˆ)ï¼š</span>{result.person2.fortuneCards.monthlyCard} - {getCardName(result.person2.fortuneCards.monthlyCard)}</p>
                      </div>
                    </div>
                  </div>
                  
                  <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-6 text-center shadow-lg">
                    <h3 className="text-xl sm:text-2xl font-bold text-purple-800 mb-2">ç¸½é«”å…¼å®¹æ€§è©•ç´š (åŸºæ–¼å¤©ç”Ÿç‰Œçµ„)</h3>
                    <div className="text-xl sm:text-2xl font-semibold text-purple-700 mb-3">{result.compatibility.overall.level}</div>
                    <div className={`text-3xl sm:text-4xl font-bold ${getScoreColor(result.compatibility.overall.avgScore)} mb-4`}>{result.compatibility.overall.avgScore}%</div>
                    <p className="text-sm sm:text-base text-gray-700 max-w-2xl mx-auto leading-relaxed">{result.compatibility.overall.advice}</p>
                  </div>
                  
                   <div className="bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg p-6 shadow-lg mt-6">
                        <h3 className="text-xl sm:text-2xl font-bold text-blue-800 mb-2 text-center">
                            å¤©ç”Ÿç‰Œçµ„äº’å‹•åˆ†æ
                        </h3>
                         <p className="text-center text-sm text-gray-600 max-w-2xl mx-auto">é€™éƒ¨åˆ†åˆ†ææ‚¨å€‘å¤©ç”Ÿçš„æ ¸å¿ƒèƒ½é‡å¦‚ä½•äº’å‹•ï¼Œæ­ç¤ºé—œä¿‚çš„é•·æœŸæ½›åŠ›èˆ‡èª²é¡Œã€‚</p>
                   </div>
                   <div className="space-y-4">
                        {[
                          { key: 'soul', title: 'éˆé­‚å±¤é¢å…¼å®¹æ€§ (æ ¸å¿ƒæœ¬è³ª)', icon: <Sparkles className="text-purple-600" />, cards: [result.person1.soulCard, result.person2.soulCard], info:"éˆé­‚ç‰Œä»£è¡¨æœ€æ·±å±¤çš„è‡ªæˆ‘ï¼Œæ­¤è™•çš„å…¼å®¹æ€§æ­ç¤ºäº†ä½ å€‘åœ¨ç”Ÿå‘½ç›®çš„èˆ‡æ ¸å¿ƒåƒ¹å€¼ä¸Šçš„æ½›åœ¨é€£çµæˆ–å·®ç•°ã€‚"},
                          { key: 'personality', title: 'å€‹æ€§å±¤é¢å…¼å®¹æ€§ (æ—¥å¸¸äº’å‹•)', icon: <UsersIcon className="text-pink-600" />, cards: [result.person1.personalityCard, result.person2.personalityCard], info:"å€‹æ€§ç‰Œåæ˜ äº†å¤–åœ¨è¡Œç‚ºæ¨¡å¼èˆ‡å­¸ç¿’èª²é¡Œã€‚æ­¤å…¼å®¹æ€§é—œä¹ä½ å€‘åœ¨æ—¥å¸¸ç›¸è™•ã€æºé€šé¢¨æ ¼åŠç”Ÿæ´»æ–¹å¼ä¸Šçš„å’Œè«§åº¦ã€‚"},
                          { key: 'challenge', title: 'äº’è£œ/æŒ‘æˆ°æ•´åˆæ½›åŠ› (æˆé•·èª²é¡Œ)', icon: <TargetIcon className="text-indigo-600" />, cards: [result.person1.challengeCard, result.person2.challengeCard], info: "æ­¤ç‰Œç”±ã€22-éˆé­‚ç‰Œã€‘è¨ˆç®—ï¼Œä»£è¡¨éˆé­‚ç‚ºé”å®Œæ•´è€Œéœ€æ•´åˆçš„äº’è£œèƒ½é‡ã€‚å®ƒæ­ç¤ºäº†å½¼æ­¤å¯èƒ½è§¸ç™¼çš„æ·±å±¤èª²é¡ŒåŠå…±åŒæˆé•·çš„æ½›åŠ›ï¼Œæ˜¯é—œä¿‚ä¸­æ·±åˆ»å­¸ç¿’çš„é ˜åŸŸã€‚" }
                        ].map(item => (
                            <CompatibilityItem key={item.key} {...item} itemKey={item.key} compatibilityInfo={result.compatibility[item.key]} infoText={item.info} isOpen={showDetails[item.key]} onToggle={() => setShowDetails(prev => ({...prev, [item.key]: !prev[item.key]}))} />
                        ))}
                   </div>


                  <div className="bg-gradient-to-r from-indigo-100 to-blue-100 rounded-lg p-6 shadow-lg mt-8">
                    <h3 className="text-xl sm:text-2xl font-bold text-indigo-800 mb-2 text-center flex items-center justify-center gap-2">
                        <ClockIcon /> ç•¶å‰æ™‚é‹äº’å‹•åˆ†æ ({result.timeframe.year}å¹´{result.timeframe.month}æœˆ)
                    </h3>
                    <p className="text-center text-sm text-gray-600 max-w-2xl mx-auto">æ­¤éƒ¨åˆ†åˆ†ææ‚¨å€‘åœ¨æ‰€é¸æ™‚é–“é€±æœŸä¸‹çš„èƒ½é‡äº’å‹•ï¼Œæä¾›é †å‹¢è€Œç‚ºçš„æŒ‡å¼•ã€‚é€™å±¬æ–¼çŸ­æœŸã€å‹•æ…‹çš„èƒ½é‡æµï¼Œæœƒå½±éŸ¿å¤©ç”Ÿç‰Œçµ„çš„å±•ç¾æ–¹å¼ã€‚</p>
                  </div>
                   <div className="space-y-4">
                        {[
                          { key: 'yearly', title: `å¹´åº¦èƒ½é‡å…±æŒ¯ (${result.timeframe.year}å¹´)`, icon: <SunIcon className="text-yellow-600" />, cards: [result.person1.fortuneCards.yearlyCard, result.person2.fortuneCards.yearlyCard], info: `å¹´é‹ç‰Œæ­ç¤ºäº†å…©äººåœ¨ ${result.timeframe.year} å¹´å…±åŒé¢å°çš„å®è§€ä¸»é¡Œã€å­¸ç¿’èª²é¡Œèˆ‡ç™¼å±•æ©Ÿé‡ã€‚é€™åæ˜ äº†ä½ å€‘åœ¨é€™ä¸€æ•´å¹´ä¸­çš„èƒ½é‡åŸºèª¿æ˜¯å’Œè«§å…±æŒ¯é‚„æ˜¯éœ€è¦ç£¨åˆã€‚`},
                          { key: 'monthly', title: `æœˆåº¦ä¸»é¡Œäº’å‹• (${result.timeframe.month}æœˆ)`, icon: <MoonIcon className="text-blue-600" />, cards: [result.person1.fortuneCards.monthlyCard, result.person2.fortuneCards.monthlyCard], info: `æœˆé‹ç‰Œå‰‡èšç„¦æ–¼ ${result.timeframe.month} æœˆçš„å…·é«”èƒ½é‡æµå‹•ã€‚å®ƒé¡¯ç¤ºäº†åœ¨å¹´åº¦å¤§ä¸»é¡Œä¸‹ï¼Œæœ¬æœˆæ‚¨å€‘çš„äº’å‹•æ¨¡å¼ã€æƒ…ç·’ç„¦é»ä»¥åŠå¯èƒ½é‡åˆ°çš„çŸ­æœŸäº‹ä»¶æˆ–æŒ‘æˆ°ã€‚` }
                        ].map(item => (
                            <CompatibilityItem key={item.key} {...item} itemKey={item.key} compatibilityInfo={result.compatibility[item.key]} infoText={item.info} isOpen={showDetails[item.key]} onToggle={() => setShowDetails(prev => ({...prev, [item.key]: !prev[item.key]}))} />
                        ))}
                   </div>


                  <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6 shadow-lg"><h3 className="font-semibold text-gray-800 mb-4 flex items-center gap-2 text-xl"><BookOpen /> é—œä¿‚ç™¼å±•æ·±åº¦å»ºè­°</h3><div className="space-y-4 text-sm text-gray-700 leading-relaxed"><p>â€¢ <strong>æ·±åŒ–éˆé­‚é€£çµ ({result.compatibility.soul.score}%):</strong> å®šæœŸé€²è¡Œæ·±åº¦å°è©±ï¼Œåˆ†äº«å…§å¿ƒçš„å¤¢æƒ³ã€ææ‡¼èˆ‡éˆæ€§é«”æ‚Ÿã€‚æ¢ç´¢ä½ å€‘éˆé­‚ç‰Œ ({getCardName(result.person1.soulCard)} & {getCardName(result.person2.soulCard)}) ä¹‹é–“çš„å…±é³´èˆ‡èª²é¡Œ ({result.compatibility.soul.challenges})ã€‚å…±åŒåƒèˆ‡èƒ½æ»‹é¤Šéˆé­‚çš„æ´»å‹•ã€‚</p><p>â€¢ <strong>ä¿ƒé€²å€‹æ€§äº’å‹• ({result.compatibility.personality.score}%):</strong> æ¬£è³ä¸¦å­¸ç¿’å½¼æ­¤å€‹æ€§ç‰Œ ({getCardName(result.person1.personalityCard)} & {getCardName(result.person2.personalityCard)}) çš„å„ªé»ï¼Œå°Šé‡å·®ç•°ã€‚å°‡å€‹æ€§ä¸Šçš„æŒ‘æˆ° ({result.compatibility.personality.challenges}) è¦–ç‚ºå­¸ç¿’å’Œå…±åŒæˆé•·çš„æ©Ÿæœƒï¼Œç·´ç¿’æœ‰æ•ˆçš„æºé€šæŠ€å·§ã€‚</p><p>â€¢ <strong>æ•´åˆæŒ‘æˆ°èª²é¡Œ ({result.compatibility.challenge.score}%):</strong> ç•¶è¡çªæˆ–ä¸é©å‡ºç¾æ™‚ï¼Œè§€å¯Ÿæ˜¯å¦è§¸ç™¼äº†å½¼æ­¤äº’è£œ/æŒ‘æˆ°ç‰Œ ({getCardName(result.person1.challengeCard)} & {getCardName(result.person2.challengeCard)}) æ‰€ä»£è¡¨çš„é¢å‘ã€‚é€™äº›äº’å‹• ({result.compatibility.challenge.challenges}) æä¾›äº†å…±åŒç™‚ç™’å’Œæ•´åˆäº’è£œèƒ½é‡çš„å¯¶è²´æ©Ÿæœƒã€‚å‹‡æ•¢é¢å°ï¼Œèª å¯¦åˆ†äº«ã€‚</p><p>â€¢ <strong>æŠŠæ¡ç•¶å‰æ™‚é‹:</strong> é—œæ³¨æ‚¨å€‘åœ¨ {result.timeframe.year} å¹´çš„å¹´é‹ç‰Œ ({getCardName(result.person1.fortuneCards.yearlyCard)} & {getCardName(result.person2.fortuneCards.yearlyCard)}) äº’å‹•ï¼Œä»¥åŠ {result.timeframe.month} æœˆæœˆé‹ç‰Œ ({getCardName(result.person1.fortuneCards.monthlyCard)} & {getCardName(result.person2.fortuneCards.monthlyCard)}) çš„äº’å‹•ã€‚é€™èƒ½å¹«åŠ©æ‚¨å€‘é †æ‡‰ç•¶å‰çš„èƒ½é‡æµï¼Œå…±åŒæ‡‰å°æ©Ÿé‡èˆ‡æŒ‘æˆ°ã€‚</p><p>â€¢ <strong>å…±åŒå‰µé€ èˆ‡æˆé•·:</strong> è¨­å®šå…±åŒçš„éˆæ€§æˆ–å€‹äººæˆé•·ç›®æ¨™ã€‚åˆ©ç”¨ä½ å€‘ç‰Œçµ„çš„ç¶œåˆåŠ›é‡èˆ‡æ™ºæ…§ï¼Œç›¸äº’æ”¯æŒï¼Œå…±åŒé€²åŒ–ã€‚è¨˜ä½ï¼Œä»»ä½•æŒ‘æˆ°éƒ½æ˜¯é—œä¿‚æ·±åŒ–èˆ‡å€‹äººæˆç†Ÿçš„å¢Šè…³çŸ³ã€‚æŒçºŒçš„æ„›ã€å°Šé‡ã€ç†è§£èˆ‡æºé€šæ˜¯é—œä¿‚é•·ä¹…ç¾æ»¿çš„é—œéµã€‚</p><p className="mt-4 pt-4 border-t border-purple-200 text-xs text-gray-500"><InfoIcon className="inline w-3 h-3 mr-1" />å…è²¬è²æ˜ï¼šæ­¤åˆ†æåƒ…ä¾›å€‹äººæ¢ç´¢èˆ‡å¨›æ¨‚åƒè€ƒï¼Œä¸èƒ½æ›¿ä»£å°ˆæ¥­çš„å¿ƒç†è«®è©¢æˆ–é—œä¿‚è¼”å°ã€‚è«‹ä»¥é–‹æ”¾å’Œè¦ºå¯Ÿçš„æ…‹åº¦ä¾†å°å¾…çµæœã€‚</p></div></div>
                </div>
              )}
            </div>
          );
        };
        
        // --- FORTUNE CARD CALCULATOR ---
        const FortuneCardCalculator = () => {
          const [birthDate, setBirthDate] = useState('');
          const [targetYear, setTargetYear] = useState(new Date().getFullYear());
          const [targetMonth, setTargetMonth] = useState(new Date().getMonth() + 1);
          const [result, setResult] = useState(null);
          const [showProcess, setShowProcess] = useState(false);
          const [showInfo, setShowInfo] = useState(false);

          const formatChineseDate = (dateObj) => {
            if (!dateObj || isNaN(dateObj.getTime())) return '';
            const year = dateObj.getFullYear();
            const month = dateObj.getMonth() + 1;
            const day = dateObj.getDate();
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
          };

          const handleCalculate = () => {
            if (!birthDate) {
              alert('è«‹è¼¸å…¥æ‚¨çš„å‡ºç”Ÿæ—¥æœŸ');
              return;
            }

            const targetDate = new Date(targetYear, targetMonth - 1, 1);
            const { yearlyCard, monthlyCard, cycleInfo, steps } = sharedCalculateFortuneCards(birthDate, targetDate);
            
            setResult({
              yearlyCard,
              monthlyCard,
              cycleInfo,
              steps: steps
            });
            setShowProcess(false);
          };

          const FortuneCardInfo = () => (
             <div className="mt-8 p-6 bg-white rounded-lg shadow-md space-y-6 text-gray-700 transition-all duration-500 ease-in-out">
                <h2 className="text-2xl font-bold text-purple-800 text-center flex items-center justify-center gap-2"><BookOpen /> å¹´é‹å¡å’Œæœˆé‹å¡çš„åŸºç¤åŸç†èˆ‡å…·é«”è¨ˆç®—æ–¹æ³•</h2>
                <section>
                    <h3 className="text-xl font-semibold text-purple-700 mb-2">åŸºç¤åŸç†</h3>
                    <div className="pl-4 border-l-4 border-purple-300">
                        <p><strong>æ ¸å¿ƒæ¦‚å¿µ:</strong> æ­¤è¨ˆç®—å™¨æ¡ç”¨æ‚¨æŒ‡å®šçš„å€‹äººåŒ–è¨ˆç®—è¦å‰‡ã€‚æµå¹´ï¼ˆå¹´é‹ï¼‰é€±æœŸå¾æ‚¨ç•¶å¹´ç”Ÿæ—¥é–‹å§‹ï¼Œåˆ°æ¬¡å¹´ç”Ÿæ—¥çµæŸã€‚æµæœˆï¼ˆæœˆé‹ï¼‰å‰‡æ ¹æ“šæ‚¨çš„å‡ºç”Ÿå¹´ä»½å’Œç›®æ¨™æœˆä»½è¨ˆç®—ã€‚</p>
                        <p><strong>æ•¸å­¸åŸºç¤:</strong> ä¸»è¦é‹ç”¨æ•¸å­—æ ¹ï¼ˆDigit Sumï¼‰åŸç†ï¼Œå°‡æ—¥æœŸæ•¸å­—ç›¸åŠ ï¼Œä¸¦å°‡çµæœåŒ–ç°¡ç‚ºä¸€å€‹å€‹ä½æ•¸ï¼ˆ1-9ï¼‰ï¼Œå°æ‡‰åˆ°å¡”ç¾…ç‰Œçš„å‰10å¼µç‰Œï¼ˆ0-9ï¼‰ã€‚</p>
                    </div>
                </section>
                <section>
                    <h3 className="text-xl font-semibold text-purple-700 mb-2">å¹´é‹å¡è¨ˆç®—æ–¹æ³• (æ‚¨çš„è¦å‰‡)</h3>
                    <div className="bg-blue-50 rounded-lg p-4 text-sm text-blue-800 space-y-2">
                        <p><strong>ç¬¬ä¸€æ­¥ï¼šç¢ºå®šæµå¹´èµ·å§‹å¹´ä»½</strong><br/><span>ä»¥æ‚¨çš„ç”Ÿæ—¥ç‚ºç•Œï¼Œç¢ºå®šç•¶å‰æµå¹´é€±æœŸçš„èµ·å§‹å¹´ä»½ã€‚ä¾‹å¦‚ï¼Œè‹¥æ‚¨ç”Ÿæ—¥æ˜¯8æœˆ5æ—¥ï¼Œåœ¨2024å¹´6æœˆæŸ¥è©¢æ™‚ï¼Œæµå¹´èµ·å§‹å¹´æ˜¯2023å¹´ï¼›åœ¨2024å¹´9æœˆæŸ¥è©¢æ™‚ï¼Œæµå¹´èµ·å§‹å¹´æ˜¯2024å¹´ã€‚</span></p>
                        <p><strong>ç¬¬äºŒæ­¥ï¼šè¨ˆç®—ç¸½å’Œ</strong><br/><code>å¹´é‹æ•¸å€¼ = (æµå¹´èµ·å§‹å¹´ä»½çš„å„æ•¸å­—ä¹‹å’Œ) + (æ‚¨çš„å‡ºç”Ÿæœˆä»½) + (æ‚¨çš„å‡ºç”Ÿæ—¥æœŸ)</code></p>
                        <p><strong>ç¬¬ä¸‰æ­¥ï¼šåŒ–ç°¡è‡³å€‹ä½æ•¸</strong><br/><span>è‹¥ç¸½å’Œç‚ºå…©ä½æ•¸ï¼Œå‰‡å°‡å…¶å„ä½æ•¸å­—ç›¸åŠ ï¼Œç›´åˆ°å¾—åˆ°ä¸€å€‹å€‹ä½æ•¸ã€‚æ­¤å³ç‚ºæ‚¨çš„å¹´é‹ç‰Œè™Ÿã€‚</span></p>
                        <p><strong>ç¯„ä¾‹ (æŒ‰æ‚¨æä¾›):</strong> ç”Ÿæ—¥2000/8/5ï¼Œè¨ˆç®—2024-2025å¹´é‹ã€‚æµå¹´èµ·å§‹å¹´ç‚º2024ã€‚<br/><code>(2+0+2+4) + 8 + 5 = 8 + 8 + 5 = 21</code> â†’ <code>2+1 = 3</code>ã€‚å¹´é‹ç‰Œç‚º 3è™Ÿ çš‡åã€‚</p>
                    </div>
                </section>
                <section>
                    <h3 className="text-xl font-semibold text-purple-700 mb-2">æœˆé‹å¡è¨ˆç®—æ–¹æ³• (æ‚¨çš„è¦å‰‡)</h3>
                    <div className="bg-green-50 rounded-lg p-4 text-sm text-green-800 space-y-2">
                        <p><strong>ç¬¬ä¸€æ­¥ï¼šè¨ˆç®—ç¸½å’Œ</strong><br/><code>æœˆé‹æ•¸å€¼ = (æ‚¨çš„å‡ºç”Ÿå¹´ä»½çš„å„æ•¸å­—ä¹‹å’Œ) + (æ‚¨æŸ¥è©¢çš„ç›®æ¨™æœˆä»½) + (æ‚¨çš„å‡ºç”Ÿæ—¥æœŸ)</code></p>
                        <p><strong>ç¬¬äºŒæ­¥ï¼šåŒ–ç°¡è‡³å€‹ä½æ•¸</strong><br/><span>è‹¥ç¸½å’Œç‚ºå…©ä½æ•¸ï¼Œå‰‡å°‡å…¶å„ä½æ•¸å­—ç›¸åŠ ï¼Œç›´åˆ°å¾—åˆ°ä¸€å€‹å€‹ä½æ•¸ã€‚æ­¤å³ç‚ºæ‚¨çš„æœˆé‹ç‰Œè™Ÿã€‚</span></p>
                        <p><strong>ç¯„ä¾‹ (æŒ‰æ‚¨æä¾›):</strong> ç”Ÿæ—¥2000/8/5ï¼Œè¨ˆç®—7æœˆæœˆé‹ã€‚<br/><code>(2+0+0+0) + 7 + 5 = 2 + 7 + 5 = 14</code> â†’ <code>1+4 = 5</code>ã€‚7æœˆæœˆé‹ç‰Œç‚º 5è™Ÿ æ•™çš‡ã€‚</p>
                    </div>
                </section>
             </div>
          );

          const FortuneCardDisplay = ({ icon, title, cardId, bgColor, textColor, borderColor }) => {
            if (cardId === null || cardId === undefined || !cardDetails[cardId]) return null;
            const details = cardDetails[cardId];
            return (
              <div className={`${bgColor} rounded-lg p-4 shadow-md border-l-4 ${borderColor}`}>
                <div className="mb-3 flex justify-center">
                  <img
                    src={sharedGetCardImagePath(cardId)}
                    alt={details.name}
                    className="w-full max-w-[120px] rounded-lg shadow-md object-cover border-2 border-white"
                    loading="lazy"
                    width="120"
                    height="200"
                  />
                </div>
                
                <div className="flex items-center gap-2 mb-2">
                  {icon}
                  <h3 className={`font-semibold ${textColor}`}>{title}</h3>
                </div>
                <div className={`text-3xl font-bold ${textColor} mb-1`}>
                  {cardId} - {details.name}
                </div>
                <p className={`text-md font-semibold ${textColor} mb-2`}>{details.shortMeaning}</p>
              </div>
            );
          };

          return (
            <div className="max-w-3xl mx-auto p-4 sm:p-6 bg-gradient-to-br from-indigo-100 to-blue-100 rounded-xl shadow-lg md:shadow-xl font-sans">
              <div className="text-center mb-8">
                <h1 className="text-3xl font-bold text-indigo-800 mb-2 flex items-center justify-center gap-2">
                  <ClockIcon /> æµå¹´/æµæœˆé‹å‹¢è¨ˆç®—å™¨
                </h1>
                <p className="text-gray-600">çµåˆæ‚¨çš„å‡ºç”Ÿæ—¥æœŸèˆ‡ç‰¹å®šæ™‚é–“ï¼Œæ­ç¤ºå¹´åº¦èˆ‡æœˆåº¦èƒ½é‡ä¸»é¡Œ</p>
              </div>

              <div className="bg-white rounded-lg p-6 shadow-md mb-6 space-y-4">
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"><Calendar />æ‚¨çš„å‡ºç”Ÿæ—¥æœŸ</label>
                        <input type="date" value={birthDate} onChange={(e) => setBirthDate(e.target.value)} className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500"/>
                    </div>
                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"><TargetIcon />ç›®æ¨™å¹´ä»½</label>
                        <input type="number" value={targetYear} onChange={(e) => setTargetYear(parseInt(e.target.value, 10) || new Date().getFullYear())} className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500"/>
                    </div>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"><MoonIcon />ç›®æ¨™æœˆä»½</label>
                  <select value={targetMonth} onChange={(e) => setTargetMonth(parseInt(e.target.value, 10))} className="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 bg-white">
                    {[...Array(12).keys()].map(i => <option key={i+1} value={i+1}>{i+1}æœˆ</option>)}
                  </select>
                </div>
                <button onClick={handleCalculate} className="w-full bg-indigo-600 text-white py-3 rounded-md hover:bg-indigo-700 transition-colors font-semibold flex items-center justify-center gap-2">
                  <Sparkles className="w-5 h-5" /> è¨ˆç®—æˆ‘çš„é‹å‹¢ç‰Œå¡
                </button>
              </div>

              {result && (
                <div className="space-y-6 animate-fade-in">
                  <div className="bg-white rounded-lg p-6 shadow-md">
                    <h2 className="text-xl font-bold text-gray-800 mb-4">
                      æ‚¨åœ¨ {targetYear} å¹´ {targetMonth} æœˆçš„é‹å‹¢ç‰Œå¡
                    </h2>
                    <div className="grid grid-cols-1 gap-6">
                       <FortuneCardDisplay 
                          icon={<SunIcon className="text-yellow-600" />} 
                          title={`${targetYear} å¹´é‹å¡`}
                          cardId={result.yearlyCard}
                          bgColor="bg-yellow-100"
                          textColor="text-yellow-900"
                          borderColor="border-yellow-500"
                        />
                       <FortuneCardDisplay 
                          icon={<MoonIcon className="text-blue-600" />} 
                          title={`${targetMonth} æœˆé‹å¡`}
                          cardId={result.monthlyCard}
                          bgColor="bg-blue-100"
                          textColor="text-blue-900"
                          borderColor="border-blue-500"
                        />
                    </div>
                     <div className="mt-6 p-4 bg-gray-50 rounded-lg text-sm">
                        <h4 className="font-semibold text-gray-700 mb-2">é‹å‹¢è§£è®€æç¤ºï¼š</h4>
                        <div className="text-gray-600 space-y-2">
                            <p>
                                <strong>æµå¹´é€±æœŸï¼š</strong>
                                {formatChineseDate(result.cycleInfo.yearly.start)} - {formatChineseDate(result.cycleInfo.yearly.end)}
                                <br/>
                                <strong className="text-yellow-800">{cardDetails[result.yearlyCard].name}</strong> è¨­å®šäº†æ­¤æœŸé–“çš„æ•´é«”åŸºèª¿èˆ‡å­¸ç¿’ä¸»é¡Œ
                            </p>
                            <p>
                                <strong>æµæœˆé€±æœŸï¼š</strong>
                                {formatChineseDate(result.cycleInfo.monthly.start)} - {formatChineseDate(result.cycleInfo.monthly.end)}
                                <br/>
                                <strong className="text-blue-800">{cardDetails[result.monthlyCard].name}</strong> æ­ç¤ºäº†æ­¤æœŸé–“éœ€è¦é—œæ³¨çš„å…·é«”èƒ½é‡
                            </p>
                            <p className="pt-2">
                                è«‹æ€è€ƒï¼š<strong>{cardDetails[result.yearlyCard].shortMeaning.split('ã€')[0]}</strong> çš„å¹´åº¦ä¸»é¡Œï¼Œ
                                åœ¨æ­¤æœˆæ˜¯å¦‚ä½•é€é <strong>{cardDetails[result.monthlyCard].shortMeaning.split('ã€')[0]}</strong> çš„å½¢å¼é¡¯ç¾ï¼Ÿ
                            </p>
                        </div>
                     </div>
                  </div>
                  
                  <button onClick={() => setShowProcess(!showProcess)} className="text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center gap-1">
                    {showProcess ? 'éš±è—' : 'é¡¯ç¤º'}è¨ˆç®—éç¨‹ <span className="text-indigo-600">{showProcess ? <ChevronUp /> : <ChevronDown />}</span>
                  </button>

                  {showProcess && (
                    <div className="mt-2 p-4 bg-white rounded-lg shadow-md animate-fade-in space-y-4">
                      <div>
                        <h4 className="font-semibold text-gray-700 mb-2 border-b pb-1">å¹´é‹å¡è¨ˆç®—æ­¥é©Ÿï¼š</h4>
                        <div className="space-y-1 font-mono text-xs sm:text-sm text-gray-600">
                          {result.steps.yearly.map((step, index) => <p key={index}>{step}</p>)}
                        </div>
                      </div>
                       <div>
                        <h4 className="font-semibold text-gray-700 mb-2 border-b pb-1">æœˆé‹å¡è¨ˆç®—æ­¥é©Ÿï¼š</h4>
                        <div className="space-y-1 font-mono text-xs sm:text-sm text-gray-600">
                          {result.steps.monthly.map((step, index) => <p key={index}>{step}</p>)}
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              )}
              
              <div className="text-center mt-8">
                <button onClick={() => setShowInfo(!showInfo)} className="inline-flex items-center gap-2 px-6 py-3 bg-white text-indigo-700 rounded-full shadow-md hover:bg-indigo-50 transition-transform transform hover:scale-105">
                  <span className="font-semibold">äº†è§£é‹å‹¢å¡è¨ˆç®—åŸç†</span>
                  {showInfo ? <ChevronUp className="w-5 h-5" /> : <ChevronDown className="w-5 h-5" />}
                </button>
              </div>
              {showInfo && <FortuneCardInfo />}
            </div>
          );
        };


        // --- COMPREHENSIVE TAROT SESSION COMPONENT ---
        const ComprehensiveTarotSession = () => {
          const [birthDate, setBirthDate] = useState('');
          const [results, setResults] = useState(null);

          const zodiacSigns = {
            aries: { name: 'ç‰¡ç¾Šåº§', dates: '3/21-4/19', element: 'ç«', traits: 'å‹‡æ•¢ã€è¡å‹•ã€é ˜å°åŠ›ã€æ´»åŠ›ã€ç©æ¥µä¸»å‹•', challenges: 'æ€¥èºã€è‡ªæˆ‘ä¸­å¿ƒã€ç¼ºä¹è€å¿ƒã€å®¹æ˜“è¡å‹•', keywords: ['é–‹å‰µ', 'å†’éšª', 'ç¨ç«‹', 'ç›´æ¥', 'ç†±æƒ…'], lifeTheme: 'æˆ‘æ˜¯ - é–‹å‰µèˆ‡é ˜å°çš„èƒ½é‡' },
            taurus: { name: 'é‡‘ç‰›åº§', dates: '4/20-5/20', element: 'åœŸ', traits: 'ç©©å®šã€å¯¦éš›ã€å …æŒã€äº«å—ã€å¯é ', challenges: 'å›ºåŸ·ã€ç‰©è³ªä¸»ç¾©ã€æŠ—æ‹’æ”¹è®Šã€éåº¦ä¿å®ˆ', keywords: ['ç©©å®š', 'æŒä¹…', 'äº«å—', 'å¯¦ç”¨', 'å …éŸŒ'], lifeTheme: 'æˆ‘æ“æœ‰ - å»ºç«‹èˆ‡ä¿æŒçš„èƒ½é‡' },
            gemini: { name: 'é›™å­åº§', dates: '5/21-6/21', element: 'é¢¨', traits: 'è°æ˜ã€å¥½å¥‡ã€æºé€šã€å¤šæ‰ã€é©æ‡‰åŠ›å¼·', challenges: 'å–„è®Šã€è¡¨é¢ã€ç¼ºä¹æ·±åº¦ã€åˆ†å¿ƒ', keywords: ['æºé€š', 'å­¸ç¿’', 'å¤šæ¨£', 'éˆæ´»', 'å¥½å¥‡'], lifeTheme: 'æˆ‘æ€è€ƒ - äº¤æµèˆ‡å­¸ç¿’çš„èƒ½é‡' },
            cancer: { name: 'å·¨èŸ¹åº§', dates: '6/22-7/22', element: 'æ°´', traits: 'é—œæ„›ã€ç›´è¦ºã€å®¶åº­ã€ä¿è­·ã€åŒç†å¿ƒ', challenges: 'æƒ…ç·’åŒ–ã€éåº¦æ•æ„Ÿã€ä¾è³´ã€é˜²è¡›æ€§å¼·', keywords: ['é—œæ‡·', 'ä¿è­·', 'ç›´è¦º', 'å®¶åº­', 'æƒ…æ„Ÿ'], lifeTheme: 'æˆ‘æ„Ÿå— - æ»‹é¤Šèˆ‡ä¿è­·çš„èƒ½é‡' },
            leo: { name: 'ç…å­åº§', dates: '7/23-8/22', element: 'ç«', traits: 'è‡ªä¿¡ã€æ…·æ…¨ã€å‰µé€ ã€è¡¨æ¼”ã€é ˜å°é­…åŠ›', challenges: 'è‡ªè² ã€éœ€è¦é—œæ³¨ã€æˆ²åŠ‡åŒ–ã€é©•å‚²', keywords: ['å‰µé€ ', 'è¡¨æ¼”', 'é ˜å°', 'å…‰æ˜', 'æ…·æ…¨'], lifeTheme: 'æˆ‘å‰µé€  - å±•ç¾èˆ‡é ˜å°çš„èƒ½é‡' },
            virgo: { name: 'è™•å¥³åº§', dates: '8/23-9/22', element: 'åœŸ', traits: 'å®Œç¾ã€åˆ†æã€æœå‹™ã€å¯¦ç”¨ã€ç´°ç·»', challenges: 'æŒ‘å‰”ã€ç„¦æ…®ã€éåº¦å®Œç¾ä¸»ç¾©ã€éåº¦åˆ†æ', keywords: ['åˆ†æ', 'æœå‹™', 'å®Œç¾', 'å¯¦ç”¨', 'ç²¾ç¢º'], lifeTheme: 'æˆ‘åˆ†æ - å®Œå–„èˆ‡æœå‹™çš„èƒ½é‡' },
            libra: { name: 'å¤©ç§¤åº§', dates: '9/23-10/23', element: 'é¢¨', traits: 'å’Œè«§ã€ç¾æ„Ÿã€å…¬æ­£ã€å¤¥ä¼´ã€å¹³è¡¡', challenges: 'çŒ¶è±«ä¸æ±ºã€è¿´é¿è¡çªã€ä¾è³´ä»–äººã€è¡¨é¢å’Œè«§', keywords: ['å¹³è¡¡', 'å’Œè«§', 'ç¾æ„Ÿ', 'åˆä½œ', 'å…¬æ­£'], lifeTheme: 'æˆ‘å¹³è¡¡ - å’Œè«§èˆ‡åˆä½œçš„èƒ½é‡' },
            scorpio: { name: 'å¤©è åº§', dates: '10/24-11/22', element: 'æ°´', traits: 'æ·±åˆ»ã€ç†±æƒ…ã€è½‰åŒ–ã€ç¥ç§˜ã€æ´å¯ŸåŠ›', challenges: 'ä½”æœ‰ã€å ±å¾©ã€æ¥µç«¯ã€æ§åˆ¶ã€ç§˜å¯†', keywords: ['æ·±åº¦', 'è½‰åŒ–', 'åŠ›é‡', 'ç¥ç§˜', 'å†ç”Ÿ'], lifeTheme: 'æˆ‘è½‰åŒ– - æ·±åº¦èˆ‡é‡ç”Ÿçš„èƒ½é‡' },
            sagittarius: { name: 'å°„æ‰‹åº§', dates: '11/23-12/21', element: 'ç«', traits: 'å†’éšªã€å“²å­¸ã€è‡ªç”±ã€æ¨‚è§€ã€æ™ºæ…§', challenges: 'ä¸è² è²¬ä»»ã€èª‡å¤§ã€ç¼ºä¹æ‰¿è«¾ã€éåº¦ç†æƒ³', keywords: ['æ¢ç´¢', 'å“²å­¸', 'è‡ªç”±', 'æ“´å±•', 'æ™ºæ…§'], lifeTheme: 'æˆ‘æ¢ç´¢ - æ“´å±•èˆ‡æ™ºæ…§çš„èƒ½é‡' },
            capricorn: { name: 'æ‘©ç¾¯åº§', dates: '12/22-1/19', element: 'åœŸ', traits: 'é‡å¿ƒã€ç´€å¾‹ã€è²¬ä»»ã€æˆåŠŸã€å¯¦éš›', challenges: 'åš´è‚…ã€æ‚²è§€ã€å·¥ä½œç‹‚ã€éåº¦æ§åˆ¶', keywords: ['ç›®æ¨™', 'è²¬ä»»', 'æˆå°±', 'çµæ§‹', 'æ¬Šå¨'], lifeTheme: 'æˆ‘é”æˆ - å»ºæ§‹èˆ‡æˆå°±çš„èƒ½é‡' },
            aquarius: { name: 'æ°´ç“¶åº§', dates: '1/20-2/18', element: 'é¢¨', traits: 'å‰µæ–°ã€ç¨ç«‹ã€äººé“ã€æœªä¾†ã€å‹èª¼', challenges: 'ç–é›¢ã€å›é€†ã€ä¸åˆ‡å¯¦éš›ã€å›ºåŸ·å·±è¦‹', keywords: ['å‰µæ–°', 'ç¨ç«‹', 'å‹èª¼', 'äººé“', 'æœªä¾†'], lifeTheme: 'æˆ‘çŸ¥é“ - å‰µæ–°èˆ‡äººé“çš„èƒ½é‡' },
            pisces: { name: 'é›™é­šåº§', dates: '2/19-3/20', element: 'æ°´', traits: 'åŒæƒ…ã€æƒ³åƒã€éˆæ€§ã€è—è¡“ã€ç›´è¦º', challenges: 'é€ƒé¿ã€çŠ§ç‰²ã€ç¼ºä¹ç•Œé™ã€éåº¦æ•æ„Ÿ', keywords: ['éˆæ€§', 'åŒæƒ…', 'è—è¡“', 'å¤¢æƒ³', 'çŠ§ç‰²'], lifeTheme: 'æˆ‘ç›¸ä¿¡ - éˆæ€§èˆ‡åŒæƒ…çš„èƒ½é‡' }
          };

          const getZodiacSign = (date) => {
            if (!date) return null;
            const [year, month, day] = date.split('-').map(Number);
            const dateStr = `${month.toString().padStart(2, '0')}${day.toString().padStart(2, '0')}`;
            
            if (dateStr >= '0321' && dateStr <= '0419') return 'aries';
            if (dateStr >= '0420' && dateStr <= '0520') return 'taurus';
            if (dateStr >= '0521' && dateStr <= '0621') return 'gemini';
            if (dateStr >= '0622' && dateStr <= '0722') return 'cancer';
            if (dateStr >= '0723' && dateStr <= '0822') return 'leo';
            if (dateStr >= '0823' && dateStr <= '0922') return 'virgo';
            if (dateStr >= '0923' && dateStr <= '1023') return 'libra';
            if (dateStr >= '1024' && dateStr <= '1122') return 'scorpio';
            if (dateStr >= '1123' && dateStr <= '1221') return 'sagittarius';
            if (dateStr >= '1222' || dateStr <= '0119') return 'capricorn';
            if (dateStr >= '0120' && dateStr <= '0218') return 'aquarius';
            if (dateStr >= '0219' && dateStr <= '0320') return 'pisces';
            return null;
          };

          const analyzeZodiacTarotConnection = (zodiacSign, tarotCards) => {
            if (!zodiacSign || !tarotCards) return null;
            
            const zodiac = zodiacSigns[zodiacSign];
            const { soulCard, personalityCard, challengeCard, giftCard } = tarotCards;
            
            const zodiacTarotCorrelations = {
              aries: { primary: [4, 7], secondary: [1, 19], supportive: [8, 16], challenging: [2, 12], element: 'ç«', modality: 'é–‹å‰µ', theme: 'è¡Œå‹•åŠ›èˆ‡é ˜å°' },
              taurus: { primary: [3, 5], secondary: [21, 6], supportive: [9, 14], challenging: [16, 1], element: 'åœŸ', modality: 'å›ºå®š', theme: 'ç©©å®šèˆ‡è±ç››' },
              gemini: { primary: [6, 1], secondary: [0, 17], supportive: [5, 11], challenging: [9, 4], element: 'é¢¨', modality: 'è®Šå‹•', theme: 'æºé€šèˆ‡é€£çµ' },
              cancer: { primary: [2, 18], secondary: [7, 3], supportive: [6, 14], challenging: [4, 15], element: 'æ°´', modality: 'é–‹å‰µ', theme: 'æƒ…æ„Ÿèˆ‡ä¿è­·' },
              leo: { primary: [8, 19], secondary: [11, 1], supportive: [3, 21], challenging: [2, 12], element: 'ç«', modality: 'å›ºå®š', theme: 'å‰µé€ åŠ›èˆ‡è‡ªä¿¡' },
              virgo: { primary: [9, 1], secondary: [14, 5], supportive: [11, 20], challenging: [0, 18], element: 'åœŸ', modality: 'è®Šå‹•', theme: 'æœå‹™èˆ‡åˆ†æ' },
              libra: { primary: [11, 6], secondary: [2, 3], supportive: [17, 19], challenging: [7, 4], element: 'é¢¨', modality: 'é–‹å‰µ', theme: 'å¹³è¡¡èˆ‡é—œä¿‚' },
              scorpio: { primary: [13, 15], secondary: [2, 8], supportive: [18, 20], challenging: [3, 19], element: 'æ°´', modality: 'å›ºå®š', theme: 'è½‰åŒ–èˆ‡æ·±åº¦' },
              sagittarius: { primary: [14, 10], secondary: [5, 9], supportive: [0, 19], challenging: [1, 18], element: 'ç«', modality: 'è®Šå‹•', theme: 'æ¢ç´¢èˆ‡æ™ºæ…§' },
              capricorn: { primary: [15, 4], secondary: [21, 9], supportive: [5, 11], challenging: [7, 18], element: 'åœŸ', modality: 'é–‹å‰µ', theme: 'æˆå°±èˆ‡è²¬ä»»' },
              aquarius: { primary: [17, 0], secondary: [16, 11], supportive: [1, 6], challenging: [19, 4], element: 'é¢¨', modality: 'å›ºå®š', theme: 'å‰µæ–°èˆ‡äººé“' },
              pisces: { primary: [18, 12], secondary: [2, 17], supportive: [14, 13], challenging: [1, 9], element: 'æ°´', modality: 'è®Šå‹•', theme: 'éˆæ€§èˆ‡æ…ˆæ‚²' }
            };

            const correlation = zodiacTarotCorrelations[zodiacSign] || {};
            const analyzeCardInDimension = (cardId, dimension) => {
              if (cardId === null || !correlation[dimension]) return false;
              return correlation[dimension].includes(cardId);
            };
            const calculateHarmonyScore = (cardId) => {
              if (cardId === null) return 0;
              let score = 0;
              if (analyzeCardInDimension(cardId, 'primary')) score += 3;
              if (analyzeCardInDimension(cardId, 'secondary')) score += 2;
              if (analyzeCardInDimension(cardId, 'supportive')) score += 1;
              if (analyzeCardInDimension(cardId, 'challenging')) score -= 2;
              return score;
            };

            let totalHarmonyScore = 0;
            const allCards = [soulCard, personalityCard, challengeCard, giftCard].filter(c => c !== null);
            allCards.forEach(card => {
              totalHarmonyScore += calculateHarmonyScore(card);
            });

            const harmonyPercentage = Math.min(100, Math.max(0, 50 + (totalHarmonyScore * 5)));
            const overallHarmony = harmonyPercentage >= 70;

            const generateDimensionAnalysis = (cardId, cardName, role) => {
              if (cardId === null || !cardName) return '';
              const primary = analyzeCardInDimension(cardId, 'primary');
              const secondary = analyzeCardInDimension(cardId, 'secondary');
              const supportive = analyzeCardInDimension(cardId, 'supportive');
              const challenging = analyzeCardInDimension(cardId, 'challenging');
              
              if (primary) return `æ‚¨çš„${role} ${cardId}è™Ÿã€${cardName}ã€‘ å¼·çƒˆå…±æŒ¯æ–¼${zodiac.name}çš„æ ¸å¿ƒã€Œ${correlation.theme}ã€ç‰¹è³ªï¼Œæ˜¯æ‚¨å¤©è³¦çš„é‡è¦å±•ç¾ã€‚`;
              if (secondary) return `æ‚¨çš„${role} ${cardId}è™Ÿã€${cardName}ã€‘ èˆ‡${zodiac.name}çš„èƒ½é‡ç·Šå¯†ç›¸é—œï¼Œè¼”åŠ©äº†æ‚¨çš„ã€Œ${correlation.theme}ã€ä¸»é¡Œã€‚`;
              if (supportive) return `æ‚¨çš„${role} ${cardId}è™Ÿã€${cardName}ã€‘ ç‚º${zodiac.name}æä¾›äº†æ”¯æŒæ€§çš„èƒ½é‡ï¼Œå¹«åŠ©æ‚¨æ›´å¥½åœ°ç™¼æ®æ½›èƒ½ã€‚`;
              if (challenging) return `æ‚¨çš„${role} ${cardId}è™Ÿã€${cardName}ã€‘ ç‚º${zodiac.name}å¸¶ä¾†äº†éœ€è¦æ•´åˆçš„æŒ‘æˆ°èª²é¡Œï¼Œæ˜¯æ‚¨æˆé•·çš„é—œéµã€‚`;
              return `æ‚¨çš„${role} ${cardId}è™Ÿã€${cardName}ã€‘ èˆ‡${zodiac.name}å‘ˆç¾äº’è£œå°æ¯”ï¼Œé€™å‰µé€ äº†è±å¯Œçš„å€‹äººç™¼å±•å±¤æ¬¡ã€‚`;
            };

            const soulDimensionText = generateDimensionAnalysis(soulCard, cardDetails[soulCard]?.name, 'éˆé­‚ç‰Œ');
            const personalityDimensionText = generateDimensionAnalysis(personalityCard, cardDetails[personalityCard]?.name, 'å€‹æ€§ç‰Œ');
            const challengeDimensionText = generateDimensionAnalysis(challengeCard, cardDetails[challengeCard]?.name, 'æŒ‘æˆ°ç‰Œ');
            const giftDimensionText = generateDimensionAnalysis(giftCard, cardDetails[giftCard]?.name, 'å¤©è³¦ç‰Œ');
            const allAnalyses = [soulDimensionText, personalityDimensionText, challengeDimensionText, giftDimensionText].filter(Boolean).join('\n');

            return {
              zodiac, overallHarmony, harmonyPercentage,
              detailedAnalysis: `ğŸŒŸ **æ•´é«”å’Œè«§åº¦**: ${harmonyPercentage}% - ${overallHarmony ? 'é«˜åº¦å’Œè«§å…±æŒ¯' : 'å‹•æ…‹å¹³è¡¡ç™¼å±•'}\n\nğŸº **æ˜Ÿåº§åŸå‹**: ${zodiac.name} (${correlation.element}è±¡ Ã— ${correlation.modality}åº§)\n   æ ¸å¿ƒä¸»é¡Œ: ${correlation.theme} | ${zodiac.lifeTheme}\n\nğŸ”® **å¤šç¶­åº¦å…±é³´åˆ†æ**:\n${allAnalyses}`,
              suggestions: `ğŸ¯ **æ•´åˆç­–ç•¥**:\n\nğŸŒŸ **ç™¼æ®æ˜Ÿåº§å„ªå‹¢**: æ·±å…¥ç™¼å±•${zodiac.name}çš„æ ¸å¿ƒç‰¹è³ªï¼ˆ${zodiac.traits.split('ã€').slice(0,3).join('ã€')}ï¼‰ï¼Œå°‡å…¶ä½œç‚ºæ‚¨è¡Œå‹•çš„åŸºçŸ³ã€‚\n\nğŸƒ **æ•´åˆå¡”ç¾…æ™ºæ…§**: ç•¶é‡åˆ°${zodiac.name}çš„æŒ‘æˆ°ï¼ˆå¦‚${zodiac.challenges.split('ã€')[0]}ï¼‰æ™‚ï¼Œè«‹åƒè€ƒæ‚¨éˆé­‚ç‰Œã€${cardDetails[soulCard]?.name}ã€‘çš„æŒ‡å¼•ä¾†ç©©å®šå…§æ ¸ã€‚åŒæ™‚æ€è€ƒæ‚¨çš„æŒ‘æˆ°ç‰Œã€${challengeCard !== null ? cardDetails[challengeCard]?.name : 'N/A'}ã€‘èƒ½å¸¶ä¾†ä½•ç¨®å¹³è¡¡è¦–è§’ã€‚\n\nğŸ”„ **å‹•æ…‹å¹³è¡¡ç·´ç¿’**: ${overallHarmony ? `æ‚¨çš„æ˜Ÿåº§èˆ‡å¡”ç¾…ç‰Œçµ„é«˜åº¦å”èª¿ã€‚ç‚ºäº†å…¨é¢ç™¼å±•ï¼Œè«‹æœ‰æ„è­˜åœ°æ¢ç´¢å¡”ç¾…ç‰Œä¸­èˆ‡æ‚¨æ˜Ÿåº§è¼ƒä¸ç›¸é—œçš„èƒ½é‡ï¼Œä¾‹å¦‚è‹¥æ‚¨ç«è±¡é‡ï¼Œå¯å¤šç·´ç¿’æ°´è±¡çš„è€å¿ƒèˆ‡åŒç†ã€‚` : `æ“æŠ±æ˜Ÿåº§èˆ‡å¡”ç¾…ç‰Œçµ„ä¹‹é–“çš„â€œå‰µæ„å¼µåŠ›â€ã€‚å®ƒå€‘çš„å·®ç•°æ˜¯æ‚¨å…§åœ¨â€œç…‰é‡‘è¡“â€çš„åŸæ–™ï¼Œèƒ½åœ¨å°æ¯”ä¸­æ¿€ç™¼å‰µæ–°çš„åŠ›é‡å’Œæ›´å®Œæ•´çš„è‡ªæˆ‘èªçŸ¥ã€‚`}`
            };
          };

          const handleAnalyze = () => {
            if (!birthDate) {
              alert('è«‹è¼¸å…¥å‡ºç”Ÿæ—¥æœŸ');
              return;
            }
            
            const tarotCards = sharedCalculateBirthCards(birthDate);
            const zodiacSign = getZodiacSign(birthDate);
            const zodiacAnalysis = analyzeZodiacTarotConnection(zodiacSign, tarotCards);
            
            setResults({
              birthDate,
              tarotCards,
              zodiacSign,
              zodiacAnalysis
            });
          };

          const CardDisplay = ({ icon, title, cardId, bgColor, textColor, borderColor, description }) => {
            if (cardId === null || cardId === undefined || !cardDetails[cardId]) return null;
            const details = cardDetails[cardId];
            
            return (
              <div className={`${bgColor} rounded-lg p-4 shadow-md border-l-4 ${borderColor} transition-all duration-300 flex flex-col justify-between h-full`}>
                <div>
                    <div className="flex items-center gap-2 mb-2">{icon}<h3 className={`font-semibold ${textColor}`}>{title}</h3></div>
                    <div className={`text-xl font-bold ${textColor} mb-1`}>{cardId} - {details.name}</div>
                    <p className={`text-sm font-semibold ${textColor} mb-2`}>{details.shortMeaning}</p>
                    {description && <p className={`text-xs ${textColor} opacity-80`}>{description}</p>}
                </div>
                 <div className="mt-3">
                  <img src={sharedGetCardImagePath(cardId)} alt={details.name} className="w-full max-w-[100px] mx-auto rounded-lg shadow-md object-cover border-2 border-white" onError={(e) => e.target.style.display = 'none'} loading="lazy" width="100" height="167" />
                </div>
              </div>
            );
          };

          return (
            <div className="max-w-4xl mx-auto p-4 sm:p-6 bg-gradient-to-br from-purple-100 to-indigo-100 rounded-xl shadow-xl font-sans">
              <div className="text-center mb-8">
                <h1 className="text-3xl font-bold text-purple-800 mb-2 flex items-center justify-center gap-2">
                  <Sparkles className="w-8 h-8" />å¡”ç¾…ç”Ÿå‘½è—åœ– Ã— å¤ªé™½æ˜Ÿåº§æ•´åˆè§£æ
                </h1>
                <p className="text-gray-600">æ·±åº¦çµåˆå¡”ç¾…ç”Ÿå‘½éˆæ•¸èˆ‡å¤ªé™½æ˜Ÿåº§ç‰¹è³ªçš„å€‹äººå‘½ç†åˆ†æ</p>
              </div>

              <div className="bg-white rounded-lg p-6 shadow-md mb-6">
                <div className="max-w-md mx-auto">
                  <label className="block text-sm font-medium text-gray-700 mb-2 text-center"><Calendar /> è«‹è¼¸å…¥æ‚¨çš„å‡ºç”Ÿæ—¥æœŸ</label>
                  <input type="date" value={birthDate} onChange={(e) => setBirthDate(e.target.value)} className="w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 text-center text-lg" />
                  <button onClick={handleAnalyze} className="w-full mt-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-3 rounded-md hover:from-purple-700 hover:to-indigo-700 transition-colors font-semibold flex items-center justify-center gap-2"><Sparkles className="w-5 h-5" /> é–‹å§‹æ·±åº¦è§£æ</button>
                </div>
              </div>

              {results && (
                <div className="space-y-6 animate-fade-in">
                  <div className="grid md:grid-cols-2 gap-6">
                    <div className="bg-white rounded-lg p-6 shadow-md">
                      <h3 className="text-xl font-bold text-orange-800 mb-4 flex items-center gap-2">â™ˆ æ‚¨çš„å¤ªé™½æ˜Ÿåº§</h3>
                      {results.zodiacSign && zodiacSigns[results.zodiacSign] && (
                        <div className="space-y-3">
                          <div className="text-center p-4 bg-orange-50 rounded-lg">
                            <h4 className="text-2xl font-bold text-orange-700 mb-1">{zodiacSigns[results.zodiacSign].name}</h4>
                            <p className="text-sm text-gray-600">{zodiacSigns[results.zodiacSign].dates}</p>
                            <p className="text-lg font-semibold text-orange-600 mt-2">{zodiacSigns[results.zodiacSign].lifeTheme}</p>
                          </div>
                          <div className="grid grid-cols-1 gap-2 text-sm">
                            <p><strong>å…ƒç´ :</strong> <span className="text-orange-600">{zodiacSigns[results.zodiacSign].element}</span></p>
                            <p><strong>é—œéµå­—:</strong> <span className="text-blue-600">{zodiacSigns[results.zodiacSign].keywords.join('ã€')}</span></p>
                            <p><strong>å„ªå‹¢ç‰¹è³ª:</strong> {zodiacSigns[results.zodiacSign].traits}</p>
                            <p><strong>æˆé•·èª²é¡Œ:</strong> <span className="text-red-600">{zodiacSigns[results.zodiacSign].challenges}</span></p>
                          </div>
                        </div>
                      )}
                    </div>
                    <div className="bg-white rounded-lg p-6 shadow-md">
                      <h3 className="text-xl font-bold text-purple-800 mb-4 flex items-center gap-2">ğŸŒŸ æ‚¨çš„å¡”ç¾…ç”Ÿå‘½ç‰Œçµ„</h3>
                      <div className="grid grid-cols-1 gap-3 h-full">
                        <div className="grid grid-cols-2 gap-3">
                           <CardDisplay icon={<Hash className="w-4 h-4 text-purple-600" />} title="éˆé­‚ç‰Œ" cardId={results.tarotCards.soulCard} bgColor="bg-purple-50" textColor="text-purple-900" borderColor="border-purple-500" description="æ ¸å¿ƒæœ¬è³ª" />
                           <CardDisplay icon={<User className="w-4 h-4 text-pink-600" />} title="å€‹æ€§ç‰Œ" cardId={results.tarotCards.personalityCard} bgColor="bg-pink-50" textColor="text-pink-900" borderColor="border-pink-500" description="å¤–åœ¨èª²é¡Œ" />
                        </div>
                        <div className="grid grid-cols-2 gap-3">
                            {results.tarotCards.challengeCard !== null && (
                              <CardDisplay icon={<TargetIcon className="w-4 h-4 text-indigo-600" />} title="æŒ‘æˆ°ç‰Œ" cardId={results.tarotCards.challengeCard} bgColor="bg-indigo-50" textColor="text-indigo-900" borderColor="border-indigo-500" description="æ•´åˆæ½›èƒ½" />
                            )}
                            {results.tarotCards.giftCard !== null && (
                              <CardDisplay icon={<Gift className="w-4 h-4 text-yellow-600" />} title="å¤©è³¦ç‰Œ" cardId={results.tarotCards.giftCard} bgColor="bg-yellow-50" textColor="text-yellow-900" borderColor="border-yellow-500" description="å‰µé€ å‹•åŠ›" />
                            )}
                        </div>
                      </div>
                    </div>
                  </div>
                  {results.zodiacAnalysis && (
                    <div className="bg-white rounded-lg p-6 shadow-md">
                      <h3 className="text-2xl font-bold text-indigo-800 mb-4 flex items-center gap-2">ğŸ”„ å¤ªé™½æ˜Ÿåº§ Ã— å¡”ç¾…ç”Ÿå‘½ç‰Œ æ•´åˆè§£æ</h3>
                      <div className="mb-6 p-4 rounded-lg border-l-4" style={{backgroundColor: results.zodiacAnalysis.overallHarmony ? '#f0fdf4' : '#fffbeb', borderColor: results.zodiacAnalysis.overallHarmony ? '#4ade80' : '#facc15'}}>
                          <div className={`text-xl font-bold mb-2 ${results.zodiacAnalysis.overallHarmony ? 'text-green-700' : 'text-amber-700'}`}>
                              {results.zodiacAnalysis.overallHarmony ? `é«˜åº¦å’Œè«§å…±æŒ¯ (${results.zodiacAnalysis.harmonyPercentage}%)` : `å‹•æ…‹å¹³è¡¡ç™¼å±• (${results.zodiacAnalysis.harmonyPercentage}%)`}
                          </div>
                          <div className="prose prose-sm max-w-none text-gray-800 whitespace-pre-line">{results.zodiacAnalysis.detailedAnalysis}</div>
                      </div>
                      <div className="p-4 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                          <h4 className="font-bold text-blue-800 mb-3">ğŸ¯ å€‹äººæˆé•·æ•´åˆå»ºè­°</h4>
                          <div className="text-sm text-blue-900 whitespace-pre-line leading-relaxed">{results.zodiacAnalysis.suggestions}</div>
                      </div>
                    </div>
                  )}
                  <div className="text-center p-6 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg border border-purple-200">
                    <h4 className="text-lg font-bold text-purple-800 mb-3">ğŸ™ è§£æèªªæ˜</h4>
                    <p className="text-gray-700 leading-relaxed text-sm">æ­¤è§£æçµåˆäº†æ‚¨çš„å¤ªé™½æ˜Ÿåº§èˆ‡å¡”ç¾…ç”Ÿå‘½éˆæ•¸ï¼Œæä¾›ä¸€å€‹å…¨æ–¹ä½çš„å€‹äººç‰¹è³ªåˆ†æã€‚å¤ªé™½æ˜Ÿåº§åæ˜ æ‚¨çš„å¤–åœ¨è¡¨é”èˆ‡æ ¸å¿ƒå‹•æ©Ÿï¼Œå¡”ç¾…ç”Ÿå‘½ç‰Œå‰‡æ­ç¤ºæ‚¨çš„éˆé­‚ä½¿å‘½èˆ‡å…§åœ¨èª²é¡Œã€‚é€šéç†è§£å…©è€…çš„é—œä¿‚ï¼Œæ‚¨å¯ä»¥æ›´å¥½åœ°æ•´åˆä¸åŒé¢å‘çš„è‡ªæˆ‘ï¼Œæ´»å‡ºæ›´å®Œæ•´ã€æ›´çœŸå¯¦çš„äººç”Ÿã€‚</p>
                  </div>
                </div>
              )}
            </div>
          );
        };

        // --- MAIN APP COMPONENT ---
        const App = () => {
          const [activeCalculator, setActiveCalculator] = useState('fortune'); // Default to fortune calculator as requested

          const navButtonBaseClass = "px-3 py-2 sm:px-6 sm:py-3 rounded-lg font-semibold transition-all text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-offset-2";
          const activeNavButtonClass = "bg-purple-600 text-white shadow-lg transform scale-105 focus:ring-purple-500";
          const inactiveNavButtonClass = "bg-white text-purple-700 hover:bg-purple-100 focus:ring-purple-400";
          
          return (
            <div className="container mx-auto p-2 sm:p-4 min-h-screen">
              <nav className="text-center mb-6 sm:mb-10 p-2 sm:p-4 bg-purple-200 rounded-lg shadow-md">
                <div className="flex flex-col sm:flex-row justify-center items-center space-y-2 sm:space-y-0 sm:space-x-2 md:space-x-4">
                    <button 
                        onClick={() => setActiveCalculator('comprehensive')}
                        className={`${navButtonBaseClass} ${activeCalculator === 'comprehensive' ? activeNavButtonClass : inactiveNavButtonClass}`}
                    >
                        <Sparkles className="inline-block w-4 h-4 sm:w-5 sm:h-5 mr-2" /> ç¶œåˆå‘½ç†è§£æ
                    </button>
                    <button 
                        onClick={() => setActiveCalculator('birth')}
                        className={`${navButtonBaseClass} ${activeCalculator === 'birth' ? activeNavButtonClass : inactiveNavButtonClass}`}
                    >
                        <User className="inline-block w-4 h-4 sm:w-5 sm:h-5 mr-2" /> å€‹é«”ç”Ÿå‘½è—åœ–
                    </button>
                    <button 
                        onClick={() => setActiveCalculator('compatibility')}
                        className={`${navButtonBaseClass} ${activeCalculator === 'compatibility' ? activeNavButtonClass : inactiveNavButtonClass}`}
                    >
                        <HeartIcon className="inline-block w-4 h-4 sm:w-5 sm:h-5 mr-2" /> é›™äººåˆç›¤è§£æ
                    </button>
                    <button 
                        onClick={() => setActiveCalculator('fortune')}
                        className={`${navButtonBaseClass} ${activeCalculator === 'fortune' ? activeNavButtonClass : inactiveNavButtonClass}`}
                    >
                        <ClockIcon className="inline-block w-4 h-4 sm:w-5 sm:h-5 mr-2" /> æµå¹´é‹å‹¢åˆ†æ
                    </button>
                </div>
              </nav>

              <div className="animate-fade-in">
                  {activeCalculator === 'comprehensive' && <ComprehensiveTarotSession />}
                  {activeCalculator === 'birth' && <TarotBirthCardsCalculator />}
                  {activeCalculator === 'compatibility' && <TarotCompatibilitySystem />}
                  {activeCalculator === 'fortune' && <FortuneCardCalculator />}
              </div>
              
              <footer className="text-center text-gray-500 mt-12 pb-6 text-xs sm:text-sm">
                å¡”ç¾…éˆæ•¸å•Ÿè¿ªå·¥å…· Â© {new Date().getFullYear()} æ¢ç´¢è‡ªæˆ‘ï¼Œæ·±åŒ–é€£çµï¼Œæ´æ‚‰é‹å‹¢ã€‚
              </footer>
            </div>
          );
        };
        
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);

    </script>
    <script>
        // Global error handler to catch any uncaught errors
        window.addEventListener('error', (event) => {
            console.error('Global error caught:', event.error);
            const errorContainer = document.getElementById('root');
            if(errorContainer) {
                errorContainer.innerHTML = `<div style="padding: 2rem; text-align: center; background-color: #fdd; border: 1px solid #f00; border-radius: 8px; margin: 2rem;">
                    <h2 style="color: #c00; font-size: 1.5rem;">æ‡‰ç”¨ç¨‹å¼ç™¼ç”ŸéŒ¯èª¤</h2>
                    <p style="margin-top: 1rem;">å¾ˆæŠ±æ­‰ï¼Œç¨‹å¼å‡ºç¾äº†ä¸€äº›å•é¡Œï¼Œè«‹å˜—è©¦åˆ·æ–°é é¢ã€‚</p>
                    <p style="margin-top: 0.5rem; font-family: monospace; font-size: 0.8rem; color: #555;">éŒ¯èª¤è¨Šæ¯: ${event.error.message}</p>
                </div>`;
            }
        });
    </script>
</body>
</html>
